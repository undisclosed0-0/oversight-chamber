<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <link href="https://fonts.googleapis.com/css2?Unica One:wght@700&display=swap" rel="stylesheet">

  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Prestige Triumph — Oversight Chambers (Hybrid, Restored)</title>

 <!-- Outer prestige shell (light aura) -->
 <style>
/* === Root palette and shared tokens === */
:root {
  --gold: #d4b86a;
  --ivory: #f2f0e9;
  --slate: #2f3036;
  --iron: #222;

  /* Verify aura (dark blue → gray) */
  --verify-bg-start: #2c2f48;
  --verify-bg-end: #4a4d5f;
  --verify-border: #3a3d55;

  /* Outer shell */
  --shell-bg-start: #f5f7fa;
  --shell-bg-end: #e6ecf0;
  --shell-card: rgba(255,255,255,0.95);
}

/* === Outer prestige shell (light aura) === */
body {
  font-family: 'Segoe UI', system-ui, sans-serif;
  background: radial-gradient(circle at top center, var(--shell-bg-start) 0%, var(--shell-bg-end) 100%);
  color: #333; margin: 0; padding: 20px;
}

.container {
  max-width: 900px; margin: auto;
  background: var(--shell-card);
  padding: 30px; border-radius: 15px;
  box-shadow: 0 0 20px rgba(75,63,114,0.2);
  backdrop-filter: blur(6px);
}

.crest-header {
  width: 100px; height: 100px; margin: 0 auto 20px;
  background-image: url('https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh7Xr0yArKKpo2gvFLpUcm9fMR5CgbrkBYTEChDOnIM59NhDxBVFHChMPQQzeVXKnIsS7FOxP4witstDDBjLciMAM1Tq0g_bM86dXGYMLHYms0KiFJniK_gJS0PjbxhgAE1DhdLHvwpD_Id-B2mtbW7SqgWDX72S05uifuP-Ag_XQQMqJGBBNvzV88OjYc/s1600/An%20abstract%20Masterad.png');
  background-size: cover; background-position: center; border-radius: 50%;
  box-shadow: 0 0 20px rgba(194,167,109,0.6);
}

h1, h2, h3 {
  color: #4b3f72; text-align: center;
  text-shadow: 1px 1px 3px rgba(0,0,0,0.12);
  margin: 0 0 14px 0;
}

/* === Verification plaque === */
.verification-plaque {
  margin-top: 25px; padding: 20px;
  border: 2px solid var(--gold); border-radius: 12px;
  background: linear-gradient(to bottom, #fdfcfb, #f3e8e2);
  box-shadow: 0 0 15px rgba(194,167,109,0.4);
  text-align: center; display: none;
}
.verification-plaque textarea {
  width: 100%; height: 120px; margin-top: 10px; padding: 8px;
  border-radius: 8px; border: 1px solid var(--gold);
  font-family: 'Courier New', monospace; font-size: 0.95em; resize: none;
  background: #fffdf8;
}
.verification-plaque button {
  margin-top: 12px; padding: 10px 20px;
  background: linear-gradient(to right, #4b3f72, #6a5acd);
  color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1em;
  box-shadow: 0 4px 12px rgba(75,63,114,0.3);
}
.verification-plaque button:hover {
  background: linear-gradient(to right, #6a5acd, #4b3f72);
}

/* === Floating crest shortcut === */
.floating-crest {
  position: fixed; width: 60px; height: 60px; bottom: 60px; right: -156px;
  background-image: url('https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh7Xr0yArKKpo2gvFLpUcm9fMR5CgbrkBYTEChDOnIM59NhDxBVFHChMPQQzeVXKnIsS7FOxP4witstDDBjLciMAM1Tq0g_bM86dXGYMLHYms0KiFJniK_gJS0PjbxhgAE1DhdLHvwpD_Id-B2mtbW7SqgWDX72S05uifuP-Ag_XQQMqJGBBNvzV88OjYc/s1600/An%20abstract%20Masterad.png');
  background-size: cover; background-position: center; border-radius: 50%;
  box-shadow: 0 0 20px rgba(194,167,109,0.6); cursor: pointer; z-index: 101; opacity: 0.95;
}
@media (max-width: 860px) { .floating-crest { pointer-events: none; opacity: 0.7; } }

/* === Tap shimmer + zones === */
.tap-zone { position: fixed; width: 64px; height: 64px; top: 0; z-index: 999; }
#tapTopLeft { left: 0; }
#tapTopRight { right: 0; }
.tap-shimmer {
  position: fixed; inset: 0; pointer-events: none; z-index: 998;
  background:
    radial-gradient(120px 120px at 32px 32px, rgba(255,215,0,0.25), transparent 70%),
    radial-gradient(120px 120px at calc(100% - 32px) 32px, rgba(106,90,205,0.22), transparent 70%);
  opacity: 0; transition: opacity 260ms ease;
}
.tap-shimmer.active { opacity: 1; }

/* === Inner ritual styling (panels) === */
.panel-shell {
  background: linear-gradient(180deg, #2a2b2f 0%, #3a3b42 100%);
  border: 3px solid #444; border-radius: 12px;
  box-shadow: inset 0 0 25px rgba(0,0,0,0.8), 0 0 20px rgba(255,215,0,0.18);
  padding: 20px; margin-top: 20px; color: var(--gold);
  font-family: 'Orbitron','Courier New', monospace;
}
.panel-shell h2, .panel-shell h3 {
  color: var(--gold); text-transform: uppercase;
  text-shadow: 0 0 8px rgba(255,215,0,0.6);
}

/* === Color panel (rune grid) === */
#colorPanel { max-width: 880px; margin: 48px auto; padding: 28px; border: 1px solid rgba(212,184,106,0.25); color: var(--ivory); }
#colorPanel .rune-grid {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 0;
  background: #1c1c1c; border: 8px solid #2a2a2a;
}
#colorPanel .rune-btn {
  display: grid; place-items: center; min-height: 100px;
  border: 6px solid #3a3a3a; background: #2a2b2f;
  font-family: "Cinzel", serif; font-weight: 700; cursor: pointer;
  box-shadow: inset 0 2px 6px rgba(255,255,255,0.05), inset 0 -4px 8px rgba(0,0,0,0.9), 0 0 12px rgba(0,0,0,0.6);
  transition: all 200ms ease;
}
#colorPanel .rune-btn .sigil {
  font-size: 1.6rem; color: rgba(212,184,106,0.9);
  text-shadow: 0 0 6px rgba(212,184,106,0.6), 0 0 14px rgba(242,240,233,0.35);
}
#colorPanel .rune-btn small { margin-top: 6px; font-size: 1rem; color: #aaa; text-shadow: 0 0 3px rgba(0,0,0,0.6); }

/* Active color glows */
#colorPanel .rune-btn.red.active         { background: radial-gradient(circle at 50% 30%, rgba(160,40,40,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.blue.active        { background: radial-gradient(circle at 50% 30%, rgba(40,100,180,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.green.active       { background: radial-gradient(circle at 50% 30%, rgba(60,150,90,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.mustard.active     { background: radial-gradient(circle at 50% 30%, rgba(190,160,60,0.72), #2a2b2f 70%); }
#colorPanel .rune-btn.violet.active      { background: radial-gradient(circle at 50% 30%, rgba(130,80,180,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.cyan.active        { background: radial-gradient(circle at 50% 30%, rgba(60,170,190,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.deepred.active     { background: radial-gradient(circle at 50% 30%, rgba(160,50,50,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.emerald.active     { background: radial-gradient(circle at 50% 30%, rgba(50,170,110,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.deepviolet.active  { background: radial-gradient(circle at 50% 30%, rgba(110,60,160,0.75), #2a2b2f 70%); }

#colorPanel .rune-btn.active .sigil,
#colorPanel .rune-btn.active small {
  color: var(--ivory);
  text-shadow: 0 0 6px rgba(255,220,120,0.6), 0 0 14px rgba(255,255,180,0.4);
}

/* Indicators + readout */
#colorPanel .indicator-lines { display: flex; justify-content: center; gap: 12px; margin-top: 8px; }
#colorPanel .indicator-lines span {
  width: 28px; height: 4px; border-radius: 2px; background: rgba(90, 60, 30, 0.4);
  box-shadow: inset 0 0 4px rgba(0,0,0,0.6); transition: all 200ms ease;
}
#colorPanel .indicator-lines span.active {
  background: rgba(255,140,60,0.9);
  box-shadow: 0 0 6px rgba(255,140,60,0.65), 0 0 12px rgba(255,200,120,0.45), 0 0 20px rgba(255,160,80,0.35);
}
#sequenceReadout {
  font-family: "Share Tech Mono", monospace; font-size: 1.2rem; color: #9fe8ff;
  background: rgba(20, 30, 40, 0.85); border: 2px inset rgba(120,180,200,0.4);
  padding: 6px 12px; margin-top: 12px; text-align: center; letter-spacing: 0.1em;
  text-shadow: 0 0 6px rgba(0,255,255,0.4), 0 0 12px rgba(0,180,255,0.25);
  overflow: hidden; white-space: nowrap;
}

/* Ritual controls: VERIFY + CLEAR (unified aura) */
.ritual-controls { display: flex; gap: 16px; justify-content: center; margin-top: 24px; }

/* === Unified ceremonial button aura (dark blue–gray) === */
.runez-btn {
  margin-top: 22px; width: 100%; padding: 13px 16px;
  background: linear-gradient(145deg, var(--verify-bg-start), var(--verify-bg-end));
  color: var(--ivory);
  border: 2px solid var(--verify-border);
  border-radius: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em;
  box-shadow: 0 0 14px rgba(90,100,140,0.6), inset 0 0 8px rgba(255,255,255,0.1);
  cursor: pointer; transition: transform 0.14s ease, box-shadow 0.25s ease;
}
.runez-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 20px rgba(90,100,140,0.8), inset 0 0 12px rgba(255,255,255,0.2);
}

/* Optional palette variants (if you need dynamic verify aura) */
.runez-btn.rune-red    { background: radial-gradient(circle,#b04444,#d46a6a); border-color:#b04444; }
.runez-btn.rune-violet { background: radial-gradient(circle,#6a3fa8,#8a6ad4); border-color:#6a3fa8; }
.runez-btn.rune-gold   { background: radial-gradient(circle,#c2a76d,#f2e6a9); border-color:#c2a76d; }

   
/* === Admin Chamber — Grey Prestige Hybrid === */
#adminForm {
  max-width: 640px; margin: 40px auto; padding: 32px;
  background: linear-gradient(180deg, #2a2b2f 0%, #3a3b42 100%);
  border-radius: 16px; border: 1px solid rgba(212, 184, 106, 0.25);
  box-shadow: 0 0 20px rgba(212, 184, 106, 0.12), inset 0 0 14px rgba(60, 65, 75, 0.6), 0 10px 24px rgba(0, 0, 0, 0.55);
  color: var(--ivory); position: relative; overflow: hidden;
}
#adminForm h2 {
  font-size: 1.5rem; text-align: center; margin-bottom: 28px; color: var(--ivory);
  letter-spacing: 0.05em; text-shadow: 0 0 8px rgba(212, 184, 106, 0.25);
  position: relative; padding-top: 70px;
}
#adminForm h2::before {
  content: ""; position: absolute; top: 0; left: 50%; width: 56px; height: 56px; transform: translateX(-50%);
  background: radial-gradient(circle at center, rgba(212,184,106,0.9), rgba(242,240,233,0.85), rgba(95,192,181,0.7));
  border-radius: 50%; box-shadow: 0 0 12px rgba(212, 184, 106, 0.5), 0 0 20px rgba(95, 192, 181, 0.35);
}
#adminForm h2::after {
  content: ""; position: absolute; top: 12px; left: 50%; width: 28px; height: 28px; transform: translateX(-50%) rotate(45deg);
  background: linear-gradient(135deg, rgba(242,240,233,0.95), rgba(212,184,106,0.85));
  box-shadow: 0 0 8px rgba(212, 184, 106, 0.4), inset 0 0 6px rgba(95, 192, 181, 0.25);
}

/* Admin labels and fields */
#adminForm label { display: block; margin: 14px 0 6px; font-weight: 600; color: var(--gold); }
#adminForm input, #adminForm select {
  width: 100%; padding: 12px 14px; background: var(--slate); color: var(--ivory);
  border: 1px solid rgba(90, 106, 122, 0.45); border-radius: 10px;
  box-shadow: inset 0 0 8px rgba(50, 55, 65, 0.6), 0 1px 6px rgba(0, 0, 0, 0.35);
  transition: border-color 0.2s ease, box-shadow 0.2s ease, transform 0.12s ease;
}
#adminForm input:focus, #adminForm select:focus {
  outline: none; border-color: var(--gold);
  box-shadow: inset 0 0 10px rgba(212, 184, 106, 0.25), 0 0 10px rgba(212, 184, 106, 0.25);
  transform: translateY(-1px);
}
#adminForm #verifyStatus { margin-top: 14px; font-size: 0.95rem; text-align: center; color: #b0b2bb; }

/* === Public (“prestige”) form — consolidated === */
.prestige-form {
  width: 100%; max-width: 600px; margin: 40px auto; padding: 32px;
  background: #fff; border-radius: 12px; box-shadow: 0 6px 18px rgba(0,0,0,0.12);
  font-family: "Segoe UI", sans-serif; color: #333;
}
.prestige-form h1 { font-size: 1.4em; margin-bottom: 20px; text-align: center; color: #4b3f72; }
.prestige-form label { display: block; margin-top: 14px; margin-bottom: 6px; font-weight: 600; color: #4b3f72; }
.prestige-form input[type="text"], .prestige-form input[type="tel"], .prestige-form select {
  width: 100%; padding: 12px 14px; border: 1px solid #b8aee0; border-radius: 6px; font-size: 1em; background: #fafafa; color: #4b3f72;
  transition: border 0.2s ease, box-shadow 0.2s ease;
}
.prestige-form input:focus, .prestige-form select:focus { border-color: #6a5acd; box-shadow: 0 0 6px rgba(106,90,205,0.3); outline: none; }
/* Generator button in public form (use unified aura for parity) */
.prestige-form #genNameBtn { width: 70%; max-width: 320px; }
.prestige-form #genNameBtn,
.prestige-form button[type="submit"] {
  margin-top: 12px; padding: 12px 16px; border-radius: 10px; border: 2px solid var(--verify-border);
  background: linear-gradient(145deg, var(--verify-bg-start), var(--verify-bg-end));
  color: var(--ivory); font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em;
  box-shadow: 0 0 14px rgba(90,100,140,0.6), inset 0 0 8px rgba(255,255,255,0.1);
  cursor: pointer; transition: transform 0.14s ease, box-shadow 0.25s ease;
  width: 100%;
}
.prestige-form button[type="submit"]:hover,
.prestige-form #genNameBtn:hover {
  transform: translateY(-2px); box-shadow: 0 0 20px rgba(90,100,140,0.8), inset 0 0 12px rgba(255,255,255,0.2);
}

/* === Mystery Box chamber === */
#mysteryBoxChamber .mystery-title {
  font-size: 1.6rem; text-align: center; letter-spacing: 0.06em; color: #f6e27a;
  text-shadow: 0 0 12px rgba(255, 200, 80, 0.35); margin-bottom: 20px;
}
#mysteryBoxChamber .mystery-crest { font-size: 2em; margin-bottom: 16px; text-shadow: 0 0 12px rgba(255,215,0,0.8); }

/* === Oversight entry panel === */
#oversightPanel { max-width: 480px; margin: 0 auto; padding: 20px; }
@media (max-width: 860px) { #oversightPanel { width: 90%; margin: 0 auto; } }

/* === Super Code panel inputs === */
#superCodePanel input[type="text"],
#superCodePanel input[type="password"] {
  width: 60%; max-width: 280px; margin: 10px auto; display: block;
  padding: 10px; border-radius: 6px; border: 2px solid #333; background: #111; color: var(--gold); font-weight: bold; box-shadow: inset 0 0 6px rgba(0,0,0,0.7);
}
/* Center panel buttons */
#mysteryBoxPanel button, #finalBranchPanel button, #puzzleBoxPanel button, #superCodePanel button {
  display: block; margin: 20px auto; text-align: center;
}

/* === Rune feedback overlays for panel grid === */
.rune-btn.glow { box-shadow: 0 0 18px rgba(255,215,0,0.9); }
.rune-btn.after-correct { outline: 2px solid rgba(106,255,106,0.5); box-shadow: 0 0 12px rgba(106,255,106,0.6); }
.rune-btn.after-wrong   { outline: 2px solid rgba(255,74,74,0.5); box-shadow: 0 0 12px rgba(255,74,74,0.6); }
.rune-btn.after-correct, .rune-btn.after-wrong { z-index: 1; }


    /* Cube (Labyrinth) */
   .cube-container {
  width: 340px;
  height: 340px;
  perspective: 1100px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: center;
}

   .cube {
  width: 100%;
  height: 100%;
  position: relative;
  transform-style: preserve-3d;
  transform: translateZ(-120px) rotateX(-15deg) rotateY(20deg);
  transition: transform 0.15s ease-out;
}

    .cube-face {
      position: absolute; width: 340px; height: 340px;
      background: radial-gradient(120px 120px at 50% 40%, rgba(25,25,25,0.95), rgba(12,12,12,0.95));
      border: 2px solid #555; box-shadow: inset 0 0 40px rgba(0,255,180,0.08);
      display: flex; flex-direction: column; justify-content: center; align-items: center; font-size: 14px; color: #fff;
    }
    .cube-face .rune { display: none; margin-top: 10px; font-size: 22px; color: #00f5b5; text-shadow: 0 0 8px rgba(0,245,181,0.65); }
    .front  { transform: rotateY(0deg)   translateZ(170px); }
    .back   { transform: rotateY(180deg) translateZ(170px); }
    .right  { transform: rotateY(90deg)  translateZ(170px); }
    .left   { transform: rotateY(-90deg) translateZ(170px); }
    .top    { transform: rotateX(90deg)  translateZ(170px); }
    .bottom { transform: rotateX(-90deg) translateZ(170px); }
    #unlockMessage { display: none; margin-top: 10px; font-size: 18px; color: #00f5b5; letter-spacing: 0.3px; text-align: center; }

   /* Lights Out */
/* Lights Out */
/* Lights Out — final override */
/* Lights Out */
#lightsGrid {
  display: grid;
  grid-template-columns: repeat(3, 60px);
  gap: 6px;
}

#lightsGrid .light-cell {
  width: 60px;
  height: 60px;
  background: #000;              /* solid black OFF state */
  border: 1px solid #333;
  border-radius: 8px;
  cursor: pointer;
  box-shadow: inset 0 0 6px rgba(0,0,0,0.7);
  transition: background 140ms ease, box-shadow 140ms ease;
  -webkit-appearance: none;
  appearance: none;
}

#lightsGrid .light-cell.on {
  background: #ffd700;           /* glowing gold ON state */
  box-shadow: 0 0 14px rgba(255,215,0,0.7),
              inset 0 0 6px rgba(0,0,0,0.4);
}

    /* Labyrinth Path */
    #labyrinthGrid { display: grid; grid-template-columns: repeat(5,48px); gap: 6px; }
    #labyrinthGrid .cell { width: 48px; height: 48px; background: #161616; border: 1px solid #3a3a3a; border-radius: 6px; cursor: pointer; transition: background 140ms ease, box-shadow 140ms ease; }
    #labyrinthGrid .cell.on { background: #00b8f5; box-shadow: 0 0 14px rgba(0,184,245,0.55); }

    /* Memory */
    #memoryButtons { margin-top: 8px; display: flex; gap: 10px; }
    .mem { width: 64px; height: 64px; border-radius: 10px; font-size: 22px; background: #212121; border: 1px solid #4b4b4b; transition: filter 150ms ease, box-shadow 150ms ease; }
    .mem.flash { filter: brightness(1.6); box-shadow: 0 0 14px rgba(255,255,255,0.4); }

    /* Math */
    #mathGrid { display: flex; gap: 10px; }
    .num { min-width: 54px; height: 54px; border-radius: 8px; background: #212121; border: 1px solid #4b4b4b; font-weight: 600; font-size: 18px; transition: transform 140ms ease, box-shadow 140ms ease, background 140ms ease; }
    .num.sel { transform: translateY(-2px); background: #333; box-shadow: 0 0 12px rgba(255,255,255,0.2); }

    /* Final clearance mini-cube (visual) */
    .glowing-cube {
      width: 120px; height: 120px; margin: 16px auto;
      background: linear-gradient(145deg, #6a0dad, #ffd700);
      border-radius: 12px;
      box-shadow: 0 0 20px rgba(106,13,173,0.8), 0 0 40px rgba(255,215,0,0.6);
      animation: cubeGlow 3s infinite alternate;
    }
    @keyframes cubeGlow {
      0%   { transform: rotateY(0deg) rotateX(0deg); box-shadow: 0 0 20px rgba(106,13,173,0.8); }
      50%  { transform: rotateY(180deg) rotateX(20deg); box-shadow: 0 0 40px rgba(255,215,0,0.8); }
      100% { transform: rotateY(360deg) rotateX(0deg); box-shadow: 0 0 20px rgba(106,13,173,0.8); }
    }

    /* Small screen polish */
    @media (max-width: 480px) {
      body { padding: 10px; }
      .container { padding: 20px; }
      h1 { font-size: 1.4em; }
      .crest-header { width: 80px; height: 80px; }
    }
/* Void shell for Puzzle Box */
#imgVoidPuzzle {
  width: 100%;
  max-width: 340px;
  aspect-ratio: 1 / 1;
  margin: 0 auto;
  padding: 16px;
  background: radial-gradient(600px 400px at 50% 50%, rgba(0,0,0,0.85), #0d0d0d);
  border-radius: 16px;
  box-shadow:
    inset 0 0 60px rgba(0,0,0,0.9),
    0 0 40px rgba(255,215,0,0.1);
  display: flex;
  align-items: center;
  justify-content: center;
}

/* Cube container */
.cube-container {
  width: 340px;
  height: 340px;
  perspective: 1100px;
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: center;
}

.cube-face {
  width: 340px;
  height: 340px;
  padding: 0;
  box-sizing: border-box;
  overflow: hidden;
}
.cube-face * {
  max-width: 100%;
  max-height: 100%;
  box-sizing: border-box;
  overflow: hidden;
}


/* True cube transforms */
.front  { transform: rotateY(0deg)   translateZ(170px); }
.back   { transform: rotateY(180deg) translateZ(170px); }
.right  { transform: rotateY(90deg)  translateZ(170px); }
.left   { transform: rotateY(-90deg) translateZ(170px); }
.top    { transform: rotateX(90deg)  translateZ(170px); }
.bottom { transform: rotateX(-90deg) translateZ(170px); }

/* Rune styling */
.rune {
  display: none;
  margin-top: 10px;
  font-size: 22px;
  color: #00f5b5;
  text-shadow: 0 0 8px rgba(0,245,181,0.65);
}

/* Inputs and buttons */
.cube-face input,
.cube-face button,
.cube-face .cell,
.cube-face .num {
  max-width: 100%;
  box-sizing: border-box;
}

#dial {
  width: 100%;
  margin-top: 8px;
}

#wordInput {
  width: 100%;
  padding: 10px;
  font-size: 1em;
  border-radius: 6px;
  border: 1px solid #666;
  background: #111;
  color: #fff;
}

/* Mobile scaling */
@media (max-width: 480px) {
  #imgVoidPuzzle {
    max-width: 240px;
    padding: 12px;
  }
  .cube-face {
    font-size: 12px;
    padding: 8px;
  }
}

    #imgVoidPuzzle {
  box-shadow:
    inset 0 0 80px rgba(0,0,0,0.95),
    0 0 60px rgba(255,215,0,0.08);
}
/* Panel always regular size */
#puzzleBoxPanel {
  max-width: 480px;   /* fixed ceremonial width */
  margin: 40px auto;
  padding: 20px;
  background: var(--panel-bg);
  border: 3px solid #444;
  border-radius: 12px;
  box-shadow: inset 0 0 25px rgba(0,0,0,0.8),
              0 0 20px rgba(255,215,0,0.18);
  color: var(--gold);
  font-family: 'Orbitron','Courier New', monospace;
}

/* Void shell default */
#imgVoidPuzzle {
  transition: transform 0.6s ease, max-width 0.6s ease;
}

/* Mobile shrink state */
@media (max-width: 768px) {
  #imgVoidPuzzle.shrunk {
    max-width: 50%;   /* half the panel width */
    transform: scale(0.9); /* slight inward shrink */
    margin: 0 auto;
    padding: 12px;
  }
}
/* Mystery Box (hidden branch) */
#mysteryBoxPanel { display: none; border: 3px solid #6a0dad; box-shadow: inset 0 0 25px rgba(0,0,0,0.8), 0 0 20px rgba(138,43,226,0.6); color: #e0dfff; text-align: center; position: relative; overflow: hidden; }
.mystery-title { margin-bottom: 12px; }
.mystery-crest { font-size: 2em; margin-bottom: 16px; text-shadow: 0 0 12px rgba(255,215,0,0.8); }
.cube-aura {
  position: absolute; inset: 0; pointer-events: none; z-index: 0;
  background: radial-gradient(180px 180px at 30% 40%, rgba(106,13,173,0.25), transparent 70%), radial-gradient(220px 220px at 70% 60%, rgba(255,215,0,0.18), transparent 70%);
  animation: auraPulse 5s ease-in-out infinite;
}
@keyframes auraPulse { 0%,100%{filter:saturate(1); opacity:0.75;} 50%{filter:saturate(1.3); opacity:1;} }

/* Locker dial 
.locker-dial { width: 180px; height: 180px; position: relative; }
.locker-dial .dial-face {
  width: 100%; height: 100%; border-radius: 50%;
  background: radial-gradient(120px 120px at 50% 50%, #0e0e0e, #111);
  border: 2px solid #555; box-shadow: inset 0 0 18px rgba(0,0,0,0.8), 0 0 16px rgba(0,245,181,0.15);
  position: relative;
}
.locker-dial .dial-pointer {
  position: absolute; left: 50%; top: 10%; width: 3px; height: 40%;
  transform-origin: bottom center; background: #00f5b5; box-shadow: 0 0 10px rgba(0,245,181,0.6);
}
.locker-dial .dial-numbers {
  position: absolute; inset: 0; display: block; pointer-events: none; color: #ddd; font-size: 12px; font-weight: 700;
}
.locker-dial .dial-numbers span { position: absolute; left: 50%; top: 50%; transform-origin: 0 0; }*/

/* Small screen polish */
@media (max-width: 480px) {
  body { padding: 10px; }
  .container { padding: 20px; }
  h1 { font-size: 1.4em; }
  .crest-header { width: 80px; height: 80px; }
}

/* Tablet/Mobile panel override */
@media (max-width: 768px) {
  .panel-shell, #colorPanel, #adminForm, #mysteryBoxChamber {
    width: 100%; max-width: 100%; margin: 20px auto; padding: 20px; border-radius: 12px;
  }
}
/* Admin VERIFY button (source of truth) */
#adminForm #verifyTierBtn {
  margin-top: 22px;
  width: 100%;
  padding: 13px 16px;
  background: linear-gradient(90deg, #4a4b52, #5a6a7a);
  color: #f2f0e9;
  border: 1px solid rgba(212, 184, 106, 0.35);
  border-radius: 10px;
  font-weight: 700;
  letter-spacing: 0.05em;
  box-shadow:
    0 6px 18px rgba(0, 0, 0, 0.5),
    inset 0 0 6px rgba(212, 184, 106, 0.12);
  cursor: pointer;
  transition: transform 0.12s ease, box-shadow 0.25s ease, filter 0.2s ease;
}
#adminForm #verifyTierBtn:hover {
  transform: translateY(-2px);
  box-shadow:
    0 10px 24px rgba(0, 0, 0, 0.6),
    0 0 14px rgba(212, 184, 106, 0.25);
  filter: brightness(1.05);
}

/* Rune VERIFY + CLEAR buttons — identical aura */
#runeVerifyBtn,
#runeClearBtn {
  margin-top: 22px;
  width: 100%;
  padding: 13px 16px;
  background: linear-gradient(90deg, #4a4b52, #5a6a7a);
  color: #f2f0e9;
  border: 1px solid rgba(212, 184, 106, 0.35);
  border-radius: 10px;
  font-weight: 700;
  letter-spacing: 0.05em;
  box-shadow:
    0 6px 18px rgba(0, 0, 0, 0.5),
    inset 0 0 6px rgba(212, 184, 106, 0.12);
  cursor: pointer;
  transition: transform 0.12s ease, box-shadow 0.25s ease, filter 0.2s ease;
}
#runeVerifyBtn:hover,
#runeClearBtn:hover {
  transform: translateY(-2px);
  box-shadow:
    0 10px 24px rgba(0, 0, 0, 0.6),
    0 0 14px rgba(212, 184, 106, 0.25);
  filter: brightness(1.05);
}
/* Admin form text field focus aura (source of truth) */
#adminForm input:focus,
#adminForm select:focus {
  outline: none;
  border-color: #d4b86a;
  box-shadow:
    inset 0 0 10px rgba(212, 184, 106, 0.25),
    0 0 10px rgba(212, 184, 106, 0.25);
  transform: translateY(-1px);
}

/* Admin Generator + Rune VERIFY/CLEAR buttons — same glow aura */
#genNameBtn,
#runeVerifyBtn,
#runeClearBtn {
  margin-top: 22px;
  width: 100%;
  padding: 13px 16px;
  background: linear-gradient(90deg, #4a4b52, #5a6a7a);
  color: #f2f0e9;
  border: 1px solid rgba(212, 184, 106, 0.35);
  border-radius: 10px;
  font-weight: 700;
  letter-spacing: 0.05em;
  box-shadow:
    0 6px 18px rgba(0, 0, 0, 0.5),
    inset 0 0 6px rgba(212, 184, 106, 0.12);
  cursor: pointer;
  transition: transform 0.12s ease, box-shadow 0.25s ease, filter 0.2s ease;
}

/* Hover glow matches text field focus aura */
#genNameBtn:hover,
#runeVerifyBtn:hover,
#runeClearBtn:hover {
  transform: translateY(-2px);
  border-color: #d4b86a;
  box-shadow:
    inset 0 0 10px rgba(212, 184, 106, 0.25),
    0 0 10px rgba(212, 184, 106, 0.25),
    0 10px 24px rgba(0, 0, 0, 0.6);
  filter: brightness(1.05);
}
/* Admin chamber input + select sizing */
#adminForm input,
#adminForm select,
#adminForm textarea {
  width: 100%;               /* full width inside the chamber */
  min-height: 52px;          /* taller field height */
  font-size: 1.05rem;        /* slightly larger text */
  padding: 14px 16px;        /* more breathing room */
  border-radius: 12px;       /* match button aura */
  box-sizing: border-box;    /* consistent sizing */
}

/* Ensure phone + code fields don’t look cramped */
#adminPhone,
#adminCode {
  letter-spacing: 0.05em;    /* ceremonial spacing */
  font-weight: 600;          /* prestige emphasis */
}

// When Puzzle Box opens
function openPuzzleBox() {
  document.getElementById('puzzleBoxPanel').classList.add('shrunk');
  document.getElementById('puzzleBoxPanel').style.display = 'block';
}

// When Puzzle Box is solved or closed
function closePuzzleBox() {
  document.getElementById('puzzleBoxPanel').classList.remove('shrunk');
  document.getElementById('puzzleBoxPanel').style.display = 'none';
}

/* Shrink state for mobile */
@media (max-width: 768px) {
  #imgVoidPuzzle.shrunk {
    max-width: 50%;   /* half screen width */
    margin: 0 auto;
    padding: 12px;
  }
}

/* Mobile PuzzleBox notification */
#puzzleNotice {
  display: none;
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  max-width: 90%;
  background: rgba(0,0,0,0.85);
  color: #ffd700;
  font-family: 'Orbitron','Courier New', monospace;
  font-size: 0.95em;
  padding: 12px 18px;
  border-radius: 10px;
  box-shadow: 0 0 12px rgba(255,215,0,0.6);
  z-index: 9999;
  text-align: center;
}
#puzzleNotice.show {
  display: block;
  animation: fadeIn 0.4s ease;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateX(-50%) translateY(20px); }
  to   { opacity: 1; transform: translateX(-50%) translateY(0); }
}
#hiddenSigil {
  display: none;
  position: absolute;
  bottom: -40px;
  left: 50%;
  transform: translateX(-50%);
  font-size: 22px;
  color: #ffd700;
  text-shadow: 0 0 12px rgba(255,215,0,0.8);
  animation: pulseSigil 2s infinite;
}

@keyframes pulseSigil {
  0%   { opacity: 0.4; transform: translateX(-50%) scale(0.9); }
  50%  { opacity: 1;   transform: translateX(-50%) scale(1.1); }
  100% { opacity: 0.4; transform: translateX(-50%) scale(0.9); }
}

/* Fade-out effect */
#hiddenSigil.fadeOut {
  animation: fadeOutSigil 2s forwards;
}

@keyframes fadeOutSigil {
  from { opacity: 1; transform: translateX(-50%) scale(1); }
  to   { opacity: 0; transform: translateX(-50%) scale(0.8); }
}

#imgVoidPuzzle.unlocked {
  box-shadow:
    inset 0 0 60px rgba(0,0,0,0.9),
    0 0 40px rgba(255,215,0,0.6),
    0 0 80px rgba(106,13,173,0.6),
    0 0 120px rgba(0,245,181,0.4);
  animation: auraDance 6s infinite alternate;
}

@keyframes auraDance {
  0%   { transform: scale(1) rotate(0deg); }
  50%  { transform: scale(1.05) rotate(2deg); }
  100% { transform: scale(1) rotate(-2deg); }
}
/* Cube fade-out */
#labyrinthCube.fadeOut {
  animation: fadeOutCube 3s forwards;
}

@keyframes fadeOutCube {
  from { opacity: 1; transform: scale(1) rotateY(0deg); }
  to   { opacity: 0; transform: scale(0.85) rotateY(15deg); }
}

/* === Mystery Box chamber (hidden branch) === */
#mysteryBoxPanel {
  display: none;
  border: 3px solid var(--violet);
  box-shadow: inset 0 0 25px rgba(0,0,0,0.8), 0 0 20px rgba(138,43,226,0.6);
  color: #e0dfff;
  text-align: center;
  position: relative;
  overflow: hidden;
}
.mystery-title { margin-bottom: 12px; }
.mystery-crest { font-size: 2em; margin-bottom: 16px; text-shadow: 0 0 12px rgba(255,215,0,0.8); }

/* Glowing cube aura behind Mystery Box */
.cube-aura {
  position: absolute; inset: 0; pointer-events: none; z-index: 0;
  background:
    radial-gradient(180px 180px at 30% 40%, rgba(106,13,173,0.25), transparent 70%),
    radial-gradient(220px 220px at 70% 60%, rgba(255,215,0,0.18), transparent 70%);
  animation: auraPulse 5s ease-in-out infinite;
}
@keyframes auraPulse {
  0%, 100% { filter: saturate(1); opacity: 0.75; }
  50%      { filter: saturate(1.3); opacity: 1; }
}
/* Oversight entry panel */
#oversightPanel {
  max-width: 480px;       /* fixed ceremonial width */
  margin: 0 auto;         /* center horizontally */
  padding: 20px;
}

/* Tablet/Mobile override */
@media (max-width: 860px) {
  #oversightPanel {
    width: 90%;           /* responsive but centered */
    margin: 0 auto;
  }
}

 /* === Frosted inputs — Account Holder & Clearance Code === */
#mysteryBoxPanel input[type="text"],
#mysteryBoxPanel input[type="password"] {
  width: 50%;
  min-height: 52px;
  font-size: 1.05rem;
  padding: 12px 14px;
  font-weight: 600;
  background: rgba(255, 255, 255, 0.04);
  color: #e9e3ff;
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 10px;
  backdrop-filter: blur(6px);
  box-shadow:
    inset 0 0 6px rgba(255,255,255,0.05),
    0 0 12px rgba(106,90,205,0.15);
  box-sizing: border-box;
  transition: border-color 0.2s ease, box-shadow 0.2s ease, transform 0.12s ease;
}

/* === Tier dropdown — neon cyan glow only === */
#mysteryBoxPanel select {
  width: 50%;
  min-height: 52px;
  font-size: 1.05rem;
  padding: 12px 14px;
  font-weight: 600;
  color: #ffd87a;
  background: transparent;
  border: none;
  border-radius: 10px;
  backdrop-filter: blur(6px);
  text-shadow:
    0 0 6px rgba(255,216,122,0.6),
    0 0 12px rgba(255,216,122,0.4);
  box-shadow:
    inset 0 0 6px rgba(255,255,255,0.05),
    0 0 12px rgba(106,90,205,0.15);
  box-sizing: border-box;
}

/* === Dropdown options — readable and ceremonial */
#mysteryBoxPanel select option {
  font-size: 1.05rem;
  background: rgba(15,15,25,0.85);
  color: #ffd87a;
  text-shadow:  inset 0 0 6px rgba(255,255,255,0.05),
    0 0 12px rgba(106,90,205,0.15);
  padding: 10px 14px;
  border: none;
}
/* === Dropdown options — neon orange-red only (no other changes) === */
#mysteryBoxPanel select option {
  
}

/* === Submit button — frost-layered elegance, no neon === */
#mysteryBoxPanel button[type="submit"] {
  display: block;
  margin: 24px auto 0;
  max-width: 280px;
  width: 100%;
  padding: 12px 16px;
  font-size: 1.05rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: #ffd87a;
  background:  background: rgba(255,255,255,0.06); /* soft frost */

  border: 1px solid rgba(255,255,255,0.12);
  border-radius: 10px;
  backdrop-filter: blur(6px);
  box-shadow:
    inset 0 0 6px rgba(255,255,255,0.05),
    0 0 12px rgba(106,90,205,0.15);
  transition: transform 0.15s ease, box-shadow 0.3s ease, filter 0.2s ease;
}
   
   /* Apply frost-layered transparency and glow — no font or color changes */
   #mysteryBoxPanel input[type="text"],
{
  background: transparent;
  text-shadow:
    
  inset 0 0 6px rgba(255,255,255,0.05),
    0 0 12px rgba(106,90,205,0.15);
  border: none;
  backdrop-filter: blur(4px);
}
   
   
/* Apply frost-layered transparency and glow — no font or color changes */

#mysteryBoxPanel input[type="password"],
#mysteryBoxPanel button[type="submit"] {
  background: transparent;
  text-shadow:
    
  0 0 4px rgba(255,255,255,0.12),       /* subtle white mist */
  0 0 8px rgba(106,90,205,0.18);        /* soft violet frost, gently transparent */

  border: none;
  backdrop-filter: blur(4px);
}
/* === Frost lettering class for Account Holder, Clearance Code, Submit === */
.superLevelFrost {
  font-size: 1.05rem;
  font-weight: 600;
  color: #e9e3ff; /* icestone grey frost */
  text-shadow:
    0 0 4px rgba(255,255,255,0.15),
    0 0 8px rgba(106,90,205,0.2); /* soft violet frost glow */
  background: transparent;
  border: none;
  backdrop-filter: blur(4px);
}

/* Apply this class only to Account Holder, Clearance Code, and Submit button */
#mysteryBoxPanel input[type="text"],
#mysteryBoxPanel input[type="password"],
#mysteryBoxPanel button[type="submit"] {
  composes: superLevelFrost;
}

/* === Tier dropdown — remains sovereign neon cyan, untouched === */
#mysteryBoxPanel {
  background: rgba(15,15,25,0.9); /* dark chamber base */
  border: 2px solid rgba(212,184,106,0.45); /* prestige gold cord */
  border-radius: 12px;
  box-shadow:
    0 0 14px rgba(212,184,106,0.35),   /* outer shimmer */
    0 0 28px rgba(212,184,106,0.25),   /* ceremonial aura */
    0 0 42px rgba(212,184,106,0.15),   /* extended glow depth */
    inset 0 0 10px rgba(212,184,106,0.12), /* inner Rune-style shimmer */
    inset 0 0 6px rgba(255,255,255,0.04);  /* frost depth */
  padding: 24px;
  transition: box-shadow 0.3s ease;
}
#mysteryBoxPanel button[type="submit"] {
  font-family: 'Unica One', serif;
  font-weight: 700;
  letter-spacing: 0.06em;
  text-transform: uppercase;
}
/* Generator button — frost but slightly more solid */
#mysteryBoxPanel button#genSuperNameBtn {
  display: block;
  margin: 16px auto;
  max-width: 240px;
  width: 100%;
  padding: 12px 16px;
  font-size: 1.05rem;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.05em;
  color: #e9e3ff; /* frost lettering */
  background: rgba(255,255,255,0.08); /* more solid frost */
  border: 1px solid rgba(255,255,255,0.18);
  border-radius: 10px;
  backdrop-filter: blur(6px);
  box-shadow:
    inset 0 0 6px rgba(255,255,255,0.08),
    0 0 12px rgba(106,90,205,0.25);
  transition: transform 0.15s ease, box-shadow 0.3s ease, filter 0.2s ease;
}
#mysteryBoxPanel button#genSuperNameBtn:hover {
  transform: scale(1.02);
  box-shadow:
    inset 0 0 8px rgba(255,255,255,0.12),
    0 0 16px rgba(106,90,205,0.3);
}
/* Super-level phone input — styled to match frost inputs and show neon digits */
/* SuperPhone — frost + neon numeric style */
#superPhone,
#mysteryBoxPanel input[type="tel"].superLevelFrost,
#mysteryBoxPanel input.superLevelFrost[type="tel"] {
  width: 50%;
  min-height: 52px;
  font-size: 1.05rem;
  padding: 12px 14px;
  font-weight: 600;

  /* Frosted base (transparent) */
  background: transparent;
  border: none;
  backdrop-filter: blur(4px);

  /* Frost / subtle mist text-shadow preserved */
  color: #ffd87a; /* neon digits — change to #e9e3ff for icestone grey instead */
  text-shadow:
    0 0 4px rgba(255,255,255,0.12),    /* subtle white mist */
    0 0 8px rgba(106,90,205,0.18);     /* soft violet frost */

  /* Optional soft inner frost and outer glow to match other inputs visually */
  box-shadow:
    inset 0 0 6px rgba(255,255,255,0.05),
    0 0 12px rgba(106,90,205,0.12);

  border-radius: 10px;
  box-sizing: border-box;
  transition: border-color 0.18s ease, box-shadow 0.18s ease, transform 0.12s ease;
  -webkit-appearance: none;
  appearance: none;
}

/* Focus state mirrors other frost inputs but keeps neon digits */
#superPhone:focus,
#mysteryBoxPanel input[type="tel"].superLevelFrost:focus,
#mysteryBoxPanel input.superLevelFrost[type="tel"]:focus {
  outline: none;
  border: 1px solid rgba(255,255,255,0.12);
  box-shadow:
    inset 0 0 10px rgba(255,255,255,0.06),
    0 0 12px rgba(212,184,106,0.10),
    0 0 18px rgba(106,90,205,0.18);
  transform: translateY(-1px);
}

/* Placeholder & caret styling */
#superPhone::placeholder { color: rgba(233,227,255,0.45); }
#superPhone { caret-color: #ffd87a; }

/* Responsive: full-width on small screens for consistent UX */
@media (max-width: 860px) {
  #superPhone,
  #mysteryBoxPanel input[type="text"],
  #mysteryBoxPanel input[type="password"],
  #mysteryBoxPanel select {
    width: 100%;
  }
}

/* Make the Super-level panel use the richer gold border + glow (matches inputs) */
#mysteryBoxPanel {
  /* stronger gold border */
  border: 2px solid rgba(212,184,106,0.95); /* warm gold edge */
  /* layered glows: outer ceremonial shimmer + inner frost */
  box-shadow:
    0 0 18px rgba(212,184,106,0.22),   /* outer soft gold aura */
    0 0 36px rgba(212,184,106,0.14),   /* extended gold halo */
    inset 0 0 12px rgba(255,255,255,0.04), /* inner frost depth */
    0 0 28px rgba(106,90,205,0.08);    /* retained violet depth for continuity */
  transition: box-shadow 220ms ease, border-color 180ms ease, transform 160ms ease;
  /* keep existing background / padding / rounding already set elsewhere */
}

/* Slight hover/active emphasis for the panel (subtle lift) */
#mysteryBoxPanel:hover {
  transform: translateY(-3px);
  box-shadow:
    0 0 22px rgba(212,184,106,0.30),
    0 0 44px rgba(212,184,106,0.18),
    inset 0 0 14px rgba(255,255,255,0.06),
    0 0 36px rgba(106,90,205,0.10);
}

/* Stronger focus state when any control inside is focused (keeps UX accessible) */
#mysteryBoxPanel:focus-within {
  border-color: rgba(212,184,106,1);
  box-shadow:
    0 0 28px rgba(212,184,106,0.34),
    0 0 56px rgba(212,184,106,0.20),
    inset 0 0 16px rgba(255,255,255,0.07),
    0 0 44px rgba(106,90,205,0.12);
}
/* Match Account Holder, Clearance Code and Submit button to SuperPhone gold border */

#mysteryBoxPanel button[type="submit"] {
  /* base sizing/appearance already set elsewhere; only override border/glow here */
  border: 1px solid rgba(212,184,106,0.85);   /* gold border */
  box-shadow:
    inset 0 0 8px rgba(255,255,255,0.05),     /* subtle inner frost */
    0 0 14px rgba(212,184,106,0.12),          /* soft gold aura */
    0 0 18px rgba(106,90,205,0.08);           /* retained violet depth */
  border-radius: 10px;
  background: transparent;                     /* keep frosted transparency */
  color: #ffd87a;                              /* keep neon/gold digits/text */
  text-shadow:
    0 0 4px rgba(255,255,255,0.12),
    0 0 8px rgba(106,90,205,0.18);
  transition: border-color 0.18s ease, box-shadow 0.18s ease, transform 0.12s ease;
}

/* Stronger focus state (gold emphasis) */

#mysteryBoxPanel button[type="submit"]:focus {
  outline: none;
  border: 1px solid rgba(212,184,106,1);
  box-shadow:
    inset 0 0 12px rgba(255,255,255,0.06),
    0 0 18px rgba(212,184,106,0.22),
    0 0 22px rgba(106,90,205,0.12);
  transform: translateY(-1px);
}

/* Keep placeholder and caret readable */


/* Responsive: full-width on small screens */
@media (max-width: 860px) {
  
  #mysteryBoxPanel input[type="tel"],
  #mysteryBoxPanel select,
  #mysteryBoxPanel button[type="submit"] {
    width: 100%;
  }
}
/* Generator button — translucent, frosted, visible */
#mysteryBoxPanel button#genSuperNameBtn,
#genNameBtn,
.prestige-form #genNameBtn {
  display: block;
  margin: 16px auto;
  width: 100%;
  max-width: 240px;
  padding: 12px 16px;
  font-size: 1.05rem;
  font-weight: 600;
  letter-spacing: 0.05em;
  text-transform: uppercase;
  border-radius: 10px;

  /* translucent base + subtle frost */
  background: transparent;
  border: none;
  backdrop-filter: blur(4px);

  /* visible text with soft mist + violet glow */
  color: #e9e3ff;
  text-shadow:
    0 0 4px rgba(255,255,255,0.12),
    0 0 8px rgba(106,90,205,0.18);

  /* faint visible outline and depth so the button reads on varied backgrounds */
  box-shadow:
    inset 0 0 4px rgba(255,255,255,0.06),
    0 0 8px rgba(106,90,205,0.12);

  cursor: pointer;
  transition: transform 0.14s ease, box-shadow 0.18s ease, background 0.12s ease, border-color 0.12s ease;
}

/* Hover: slightly more visible while keeping translucency */
#mysteryBoxPanel button#genSuperNameBtn:hover,
#genNameBtn:hover,
.prestige-form #genNameBtn:hover {
  transform: translateY(-2px);
  background: rgba(255,255,255,0.02);
  box-shadow:
    inset 0 0 6px rgba(255,255,255,0.08),
    0 0 12px rgba(106,90,205,0.18);
}

/* Focus / active: subtle gold rim for accessibility and emphasis */
#mysteryBoxPanel button#genSuperNameBtn:focus,
#genNameBtn:focus,
.prestige-form #genNameBtn:focus,
#mysteryBoxPanel button#genSuperNameBtn:active,
#genNameBtn:active,
.prestige-form #genNameBtn:active {
  outline: none;
  border: 1px solid rgba(212,184,106,0.85);
  box-shadow:
    inset 0 0 8px rgba(255,255,255,0.08),
    0 0 18px rgba(212,184,106,0.14),
    0 0 14px rgba(106,90,205,0.12);
  background: rgba(255,255,255,0.02);
}

/* Keep responsive behavior consistent with other inputs */
@media (max-width: 860px) {
  #mysteryBoxPanel button#genSuperNameBtn,
  #genNameBtn,
  .prestige-form #genNameBtn {
    max-width: none;
    width: 100%;
  }
}
/* One-time reveal styling (magic 8-ball) */
#finalBranchPanel .oneTimeCodeWrap { display:flex; flex-direction:column; align-items:center; gap:8px; }
#finalBranchPanel select#finalTier { min-width:220px; padding:10px 12px; border-radius:8px; background:rgba(255,255,255,0.03); color:#ffd87a; border:1px solid rgba(255,255,255,0.06); }
#finalBranchPanel button#generateTierCodeBtn { padding:10px 12px; border-radius:8px; cursor:pointer; }
#finalBranchPanel .oneTimeCode {
  min-width:240px; text-align:center; padding:12px 14px; border-radius:10px;
  font-family: "Share Tech Mono", monospace; font-size:1.02rem;
  color:#111; background:linear-gradient(180deg,#fffdf6,#fff2d9);
  border:2px solid rgba(212,184,106,0.95);
  box-shadow: 0 0 10px rgba(212,184,106,0.12), inset 0 0 6px rgba(255,255,255,0.6);
  opacity:0; transform:scale(0.98); transition: opacity 420ms ease, transform 420ms cubic-bezier(.2,.9,.2,1);
  pointer-events:none;
}
#finalBranchPanel .oneTimeCode.visible { opacity:1; transform:scale(1); pointer-events:auto; }
#finalBranchPanel .oneTimeCode.fading { opacity:0; transform:scale(0.96); transition: opacity 620ms ease, transform 620ms ease; }
/* Trophy card enclosure (gold border, frosted interior) */
.final-trophy-wrap { display:flex; justify-content:center; }
.trophy-card {
  width: min(760px, 94%);
  border: 2px solid rgba(212,184,106,0.95); /* gold edge */
  border-radius: 12px;
  background: rgba(15,15,25,0.88);
  padding: 20px;
  box-shadow:
    0 0 20px rgba(212,184,106,0.20),
    0 0 36px rgba(212,184,106,0.12),
    inset 0 0 10px rgba(255,255,255,0.03),
    0 0 24px rgba(106,90,205,0.06);
}

/* Header layout */
.trophy-header { display:flex; align-items:center; gap:16px; justify-content:center; }
.trophy-title { margin:0; color:#ffd87a; font-weight:700; letter-spacing:0.06em; }

/* Body & rows center-aligned */
.trophy-body { display:flex; flex-direction:column; align-items:center; gap:12px; margin-top:8px; }
.trophy-row { display:flex; gap:12px; align-items:center; justify-content:center; width:100%; }

/* Inputs styled like Superform frosted fields, with gold border on focus */
.superLevelFrost {
  width: 320px;
  min-height:52px;
  padding:12px 14px;
  font-size:1.05rem;
  font-weight:600;
  color:#e9e3ff;
  background: rgba(255,255,255,0.04);
  border: 1px solid rgba(255,255,255,0.12);
  border-radius:10px;
  backdrop-filter: blur(6px);
  text-shadow: 0 0 4px rgba(255,255,255,0.12), 0 0 8px rgba(106,90,205,0.18);
  box-shadow: inset 0 0 6px rgba(255,255,255,0.05), 0 0 12px rgba(106,90,205,0.12);
  box-sizing:border-box;
}

/* Submit/unlock button: translucent but visible, centered */
.superBtn {
  padding: 12px 18px;
  border-radius: 10px;
  background: transparent;
  color: #e9e3ff;
  text-transform:uppercase;
  font-weight:700;
  border: 1px solid rgba(255,255,255,0.06);
  text-shadow: 0 0 4px rgba(255,255,255,0.12), 0 0 8px rgba(106,90,205,0.18);
  box-shadow: inset 0 0 4px rgba(255,255,255,0.04), 0 0 8px rgba(106,90,205,0.10);
  backdrop-filter: blur(4px);
  cursor:pointer;
}

/* Generator button: translucent but prominent, centered */
.gen-btn {
  padding:12px 18px;
  border-radius:10px;
  background: transparent;
  border: none;
  color: #ffd87a;
  font-weight:700;
  text-shadow: 0 0 4px rgba(255,255,255,0.12), 0 0 8px rgba(106,90,205,0.18);
  box-shadow: inset 0 0 4px rgba(255,255,255,0.06), 0 0 10px rgba(106,90,205,0.12);
  cursor:pointer;
}

/* oneTimeCode reveal styling: match Superform plaque look, centered trophy token */
.oneTimeCode {
  min-width:260px;
  max-width:86%;
  text-align:center;
  padding:12px 16px;
  border-radius:10px;
  font-family: "Share Tech Mono", monospace;
  font-size:1.05rem;
  color:#111;
  background: linear-gradient(180deg,#fffdf6,#fff2d9);
  border:2px solid rgba(212,184,106,0.95);
  box-shadow: 0 0 12px rgba(212,184,106,0.14), inset 0 0 6px rgba(255,255,255,0.6);
  opacity:0; transform:scale(0.98); transition: opacity 420ms ease, transform 420ms cubic-bezier(.2,.9,.2,1);
  pointer-events:none;
}
.oneTimeCode.visible { opacity:1; transform:scale(1); pointer-events:auto; }
.oneTimeCode.fading { opacity:0; transform:scale(0.96); transition: opacity 620ms ease, transform 620ms ease; }

/* small label, select style */
.trophy-label { color:#ffd87a; font-weight:600; margin-top:6px; }
.tier-select {
  min-width:220px; padding:8px 10px; border-radius:8px;
  background:rgba(255,255,255,0.03); color:#ffd87a;
  border:1px solid rgba(255,255,255,0.06);
  text-shadow: 0 0 4px rgba(255,255,255,0.06);
}

/* small separator */
.trophy-sep { width:80%; border:0; height:1px; background:linear-gradient(90deg,transparent,rgba(212,184,106,0.14),transparent); margin:12px 0; }

/* responsive */
@media (max-width:860px){
  .trophy-row { flex-direction:column; }
  .superLevelFrost { width:100%; max-width:420px; }
  .trophy-card { padding:16px; }
}

/* Access Panel styling */
/* Centered heading and instruction */
.access-heading {
  text-align: center;
  font-size: 1.6rem;
  color: #ffd87a;
  margin-bottom: 12px;
}
.access-instruction {
  text-align: center;
  font-size: 1rem;
  color: #e9e3ff;
  margin-bottom: 18px;
  z-index: 1;
}

/* Input wrapper with crown behind */
.access-input-wrap {
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  margin-bottom: 16px;
   
}

/* Input field */
#accessCodeInput {
  width: 280px;
  padding: 12px 14px;
  font-size: 1rem;
  font-weight: 600;
  border-radius: 10px;
  border: 1px solid rgba(255,255,255,0.12);
  background: rgba(255,255,255,0.04);
  color: #e9e3ff;
  backdrop-filter: blur(6px);
  position: relative;
  z-index: 2;
}

/* Crown behind input */
.access-crown {
  position: absolute;
  font-size: 230px;
  color: rgba(212,184,106,0.85);
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  opacity: 0;
  z-index: 0; /* lowest layer */
  pointer-events: none;
  text-shadow:
    0 0 12px rgba(212,184,106,0.6),
    0 0 24px rgba(212,184,106,0.4),
    0 0 36px rgba(212,184,106,0.2);
}

/* Input, button, and instruction text above crown */
.access-instruction,
#accessCodeInput,
#accessConfirmBtn {
  position: relative;
  z-index: 3;
}


/* Fade-in animation */
@keyframes crownFade {
  from { opacity: 0; transform: translate(-50%, -50%) scale(0.8); }
  to   { opacity: 1; transform: translate(-50%, -50%) scale(1); }
}
.access-crown.fade-in {
  animation: crownFade 800ms ease-out forwards, crownPulse 3s ease-in-out infinite;
}

/* Pulse animation */
@keyframes crownPulse {
  0%   { transform: translate(-50%, -50%) scale(1);   text-shadow: 0 0 12px rgba(212,184,106,0.6), 0 0 24px rgba(212,184,106,0.4); }
  50%  { transform: translate(-50%, -50%) scale(1.08); text-shadow: 0 0 20px rgba(212,184,106,0.9), 0 0 36px rgba(212,184,106,0.7); }
  100% { transform: translate(-50%, -50%) scale(1);   text-shadow: 0 0 12px rgba(212,184,106,0.6), 0 0 24px rgba(212,184,106,0.4); }
}


/* Centered sigil */
.mystery-crest-wrap {
  display: flex;
  justify-content: center;
  margin: 12px 0;
}
.mystery-crest {
  font-size: 2rem;
  color: #ffd87a;
  letter-spacing: 0.4em;
  text-align: center;
}

/* Centered sentence */
#mysteryBoxChamber .mystery-sentence {
  text-align: center;
  font-size: 1.05rem;
  color: #e9e3ff;
  margin: 14px 0;
}

/* Centered button with wood styling */
.mystery-button-wrap {
  display: flex;
  justify-content: center;
  margin-top: 16px;
}
.wooden-btn {
  padding: 12px 20px;
  font-size: 1rem;
  font-weight: 700;
  color: #fff8e1;
  background: transparent;
  border: none;
  border-radius: 10px;
  backdrop-filter: blur(4px);
  text-shadow:
    0 0 4px rgba(255,255,255,0.12),
    0 0 8px rgba(106,90,205,0.18); /* soft violet frost */
  box-shadow:
    inset 0 0 6px rgba(255,255,255,0.05),
    0 0 12px rgba(106,90,205,0.15); /* violet outer glow */
  cursor: pointer;
  transition: transform 0.2s ease, box-shadow 0.2s ease;
}

.wooden-btn:hover {
  transform: scale(1.03);
  box-shadow:
    inset 0 0 8px rgba(255,255,255,0.08),
    0 0 16px rgba(106,90,205,0.25); /* stronger violet glow on hover */
}
#finalBranchPanel h2 {
  text-align: center;
  font-size: 1.6rem;
  color: #ffd87a;
  margin-bottom: 12px;
}

#finalBranchPanel p {
  text-align: center;
  font-size: 1rem;
  color: #e9e3ff;
  margin-bottom: 18px;
}



#voidRelayPanel {
  position: relative;
  background: radial-gradient(circle at center, #0a0a0a 0%, #1a1a1a 100%);
  padding: 40px 20px;
  text-align: center;
  color: #e9e3ff;
  font-family: 'Orbitron', sans-serif;
  border: 1px solid rgba(255,255,255,0.06);
  box-shadow: 0 0 40px rgba(106,90,205,0.2);
}

.void-message {
  font-size: 1.2rem;
  margin-bottom: 24px;
  animation: fadeIn 1.2s ease-out forwards;
}

@keyframes fadeIn {
  from { opacity: 0; transform: translateY(20px); }
  to   { opacity: 1; transform: translateY(0); }
}

/* ---------- Trophy Room Final Clearance Styles ---------- */

/* ---------- Final Clearance (fully namespaced to #finalClearancePanel) ---------- */

#finalClearancePanel {
  position: relative;
  display: none;
  width: min(920px, 96%);
  margin: 28px auto;
  padding: 28px;
  border-radius: 12px;
  background: radial-gradient(1200px 400px at 50% 10%, #070607 0%, #050405 40%, #020202 100%);
  color: #e6fbe8;
  box-shadow: 0 30px 80px rgba(0,0,0,0.8), inset 0 0 40px rgba(0,0,0,0.85);
  overflow: hidden;
  font-family: 'Share Tech Mono', monospace;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* backdrop */
#finalClearancePanel .room-backdrop {
  position: absolute;
  inset: 0;
  background: linear-gradient(180deg, rgba(20,6,20,0.85), rgba(6,2,6,0.95));
  z-index: 0;
  pointer-events: none;
}

/* ensure panel content stacks above backdrop */
#finalClearancePanel > * { position: relative; z-index: 6; }

/* header */
#finalClearancePanel .mystery-title {
  text-align: center;
  color: #ffd87a;
  font-size: 1.4rem;
  margin: 0 0 12px 0;
  letter-spacing: 0.12em;
  text-shadow: 0 0 10px rgba(255,216,122,0.18);
}

/* stage & pedestal */
#finalClearancePanel .trophy-stage {
  display:flex;
  justify-content:center;
  align-items:flex-end;
  margin: 8px 0 18px;
  z-index: 6;
}
#finalClearancePanel .pedestal { width:260px; height:160px; display:flex; align-items:flex-end; justify-content:center; transform-style:preserve-3d; position:relative; }
#finalClearancePanel .pedestal-base {
  width:260px; height:44px; transform:translateY(8px);
  background: linear-gradient(180deg,#0b0b0b,#060606);
  border-radius:10px; border:2px solid rgba(217,184,106,0.06);
  box-shadow: 0 18px 40px rgba(0,0,0,0.85), inset 0 6px 18px rgba(255,255,255,0.02);
}

/* cube aura (namespaced) */
#finalClearancePanel .cube-aura {
  position:absolute; inset:0; pointer-events:none; z-index:1;
  background:
    radial-gradient(180px 180px at 30% 40%, rgba(106,13,173,0.25), transparent 70%),
    radial-gradient(220px 220px at 70% 60%, rgba(255,215,0,0.18), transparent 70%);
  animation: fc-auraPulse 5s ease-in-out infinite;
}
@keyframes fc-auraPulse { 0%,100%{filter:saturate(1);opacity:0.75}50%{filter:saturate(1.3);opacity:1} }

/* keep your .glowing-cube rules elsewhere; add only safe namespaced helpers */
#finalClearancePanel .glowing-cube { margin: 16px auto; z-index: 7; }

/* instruction */
#finalClearancePanel .final-instruction { text-align:center; color:#dfffe8; margin:8px 0 14px; z-index:7; }

/* input */
#finalClearancePanel #finalClearanceCode {
  padding:10px 12px; border-radius:8px; border:1px solid rgba(255,255,255,0.06);
  background: rgba(255,255,255,0.02); color:#e6fbe8; min-width:260px; font-family:inherit; z-index:8;
}

/* unlock button (namespaced) */
#finalClearancePanel .trophy-btn {
  padding:12px 18px; border-radius:12px;
  background: linear-gradient(180deg,#ffd87a 0%,#e6b84a 45%,#b8861f 100%);
  color:#0b0b0b; border:2px solid rgba(255,215,0,0.28);
  box-shadow: 0 10px 30px rgba(0,0,0,0.6), inset 0 0 18px rgba(255,215,0,0.06), 0 6px 18px rgba(255,200,60,0.08);
  font-weight:900; letter-spacing:0.06em; cursor:pointer; display:inline-flex; align-items:center; gap:10px;
  transition: transform .18s ease, box-shadow .18s ease;
  z-index:8;
}
#finalClearancePanel .trophy-btn:hover { transform: translateY(-4px) scale(1.01); }

/* one-time code wrapper (namespaced) */
#finalClearancePanel .oneTimeCodeWrap { margin-top:12px; text-align:center; z-index:8; position:relative; }

/* reveal button — strongly namespaced to avoid global overrides */
#finalClearancePanel #generateTierCodeBtn {
  display:inline-flex !important;
  align-items:center; justify-content:center; gap:8px;
  min-height:40px; padding:10px 14px !important; border-radius:10px;
  background: linear-gradient(180deg,#fff7c8 0%,#ffe79a 45%,#ffd24a 100%) !important;
  color:#1b1200 !important; border:2px solid rgba(255,200,60,0.95) !important;
  box-shadow: 0 12px 36px rgba(0,0,0,0.55), inset 0 0 36px rgba(255,200,60,0.06) !important;
  font-weight:800 !important; cursor:pointer !important; z-index:13 !important; position:relative !important;
  text-transform:none !important; font-family:inherit !important;
}

/* ensure pseudo-elements can't hide the label */
#finalClearancePanel #generateTierCodeBtn::before,
#finalClearancePanel #generateTierCodeBtn::after { display:none !important; content:none !important; }

/* one-time code display (namespaced) */
#finalClearancePanel #oneTimeCode,
#finalClearancePanel .oneTimeCode {
  display:inline-block; min-width:220px; padding:12px 16px; border-radius:12px;
  background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02));
  color:#dfffe8; border:1px solid rgba(255,255,255,0.04); text-align:center; font-weight:700;
  letter-spacing:0.06em; transition: background .36s ease, color .36s ease, box-shadow .42s ease, transform .36s ease;
  z-index:12; position:relative; box-shadow:0 6px 18px rgba(0,0,0,0.5); margin:8px auto 0;
}

/* revealed state (namespaced) */
#finalClearancePanel #oneTimeCode.revealed,
#finalClearancePanel .oneTimeCode.revealed {
  background: linear-gradient(180deg,#fff8d6 0%,#ffe79a 45%,#ffd24a 100%);
  color:#1b1200; border:1px solid rgba(255,200,60,0.95);
  box-shadow: 0 12px 40px rgba(255,200,60,0.12), inset 0 0 80px rgba(255,200,60,0.10), 0 0 160px rgba(255,200,60,0.04);
  transform: translateY(-6px) scale(1.02);
}
#finalClearancePanel #oneTimeCode.revealed::before,
#finalClearancePanel .oneTimeCode.revealed::before {
  content: "🏆"; display:inline-block; margin-right:8px; font-size:1.05rem; vertical-align:middle;
  filter: drop-shadow(0 2px 6px rgba(0,0,0,0.45));
}

/* reveal pulse (namespaced) */
@keyframes fc-revealPulse { 0%{transform:translateY(-2px) scale(1)}40%{transform:translateY(-8px) scale(1.04)}100%{transform:translateY(-6px) scale(1.02)} }
#finalClearancePanel #oneTimeCode.revealed.pulse,
#finalClearancePanel .oneTimeCode.revealed.pulse { animation: fc-revealPulse 760ms ease; }

/* panel buttons grid (namespaced) */
#finalClearancePanel .panel-buttons { display:grid; grid-template-columns:repeat(4,1fr); gap:10px; margin-top:12px; z-index:7; position:relative; }
#finalClearancePanel .panel-buttons button { padding:10px; border-radius:8px; background: rgba(255,255,255,0.02); border:1px solid rgba(255,255,255,0.04); color:#dfffe8; cursor:pointer; }

/* tier select — namespaced and forced dark */
#finalClearancePanel #finalTier {
  min-width:220px; padding:8px 10px; border-radius:6px;
  background: linear-gradient(180deg, rgba(6,6,6,0.98), rgba(18,18,18,0.92)) !important;
  color:#ffd87a !important; border:1px solid rgba(255,255,255,0.04) !important;
  box-shadow: 0 6px 18px rgba(0,0,0,0.6) inset !important; font-family:inherit; appearance:none; -webkit-appearance:none;
  z-index:11 !important;
}
#finalClearancePanel #finalTier option { background:#070707; color:#ffd87a; }

/* status text (namespaced) */
#finalClearancePanel #finalClearanceStatus { text-align:center; margin-top:8px; color:#bfffd0; min-height:1.2em; z-index:8; position:relative; }

/* responsive tweaks (namespaced) */
@media (max-width:640px) {
  #finalClearancePanel .panel-buttons { grid-template-columns: repeat(2,1fr); }
  #finalClearancePanel .pedestal { width:180px; }
  #finalClearancePanel .glowing-cube { width:100px; height:100px; transform: translateY(-40px) rotateX(14deg) rotateY(-14deg); }
  #finalClearancePanel #generateTierCodeBtn, #finalClearancePanel .runez-btn { width:100%; max-width:none; }
  #finalClearancePanel #oneTimeCode { min-width:160px; padding:10px 12px; }
}

   
   /* ---------- Final Branch — Phantom Console (consolidated) ---------- */

/* Ensure panel is the stacking context and clips overlays */
#finalBranchPanel {
  position: relative;
  overflow: hidden;
  background: #000; /* base black for true terminal look */
  color: #00ff88;
  border-radius: 12px;
  padding: 20px;
  box-shadow:
    inset 0 0 60px rgba(0,0,0,0.95),
    0 0 40px rgba(0,255,136,0.03);
}

/* crisp terminal border + inner neon line */
#finalBranchPanel {
  outline: 2px solid rgba(0,255,136,0.12); /* crisp frame */
  box-shadow:
    0 0 0 3px rgba(0,255,136,0.04),
    0 0 18px rgba(0,255,136,0.08),
    inset 0 0 40px rgba(0,0,0,0.9);
}
/* Retro green terminal bezel (drop-in replacement for #finalBranchPanel and its pseudo-elements) */
#finalBranchPanel {
  position: relative;
  overflow: hidden;
  background: #000;                       /* true black core */
  color: #00ff88;
  border-radius: 10px;
  padding: 20px;
  outline: 3px solid rgba(0,255,136,0.10); /* outer neon ring */
  box-shadow:
    0 0 18px rgba(0,255,136,0.06),        /* soft halo */
    inset 0 0 40px rgba(0,0,0,0.95),      /* deep inner shadow */
    inset 0 0 6px rgba(0,255,136,0.03);   /* faint inner glow */
  z-index: 10;
}

/* inner neon line for crisp bezel */
#finalBranchPanel::before {
  content: "";
  position: absolute;
  inset: 6px;                             /* sits inside the outer outline */
  border-radius: 8px;
  pointer-events: none;
  box-shadow: inset 0 0 10px rgba(0,255,136,0.06);
  border: 1px solid rgba(0,255,136,0.06);
  z-index: 1;
}

/* CRT scanlines and subtle flicker */
#finalBranchPanel::after {
  content: "";
  position: absolute;
  inset: 0;
  pointer-events: none;
  background-image:
    repeating-linear-gradient(
      to bottom,
      rgba(0,0,0,0) 0px,
      rgba(0,0,0,0) 1px,
      rgba(0,0,0,0.06) 2px
    ),
    linear-gradient(180deg, rgba(0,255,136,0.02), rgba(0,255,136,0.00));
  opacity: 0.28;
  mix-blend-mode: screen;
  z-index: 2;
  animation: crtFlicker 3.6s steps(2) infinite;
}

/* faint, irregular flicker to sell the CRT effect */
@keyframes crtFlicker {
  0%   { opacity: 0.30; transform: translateZ(0); }
  10%  { opacity: 0.22; }
  50%  { opacity: 0.34; }
  90%  { opacity: 0.26; }
  100% { opacity: 0.30; }
}

/* stronger inner bezel glow when panel is active */
#finalBranchPanel.branch-enter::before {
  box-shadow: inset 0 0 18px rgba(0,255,136,0.10);
  border-color: rgba(0,255,136,0.10);
}

/* ensure content sits above overlays */
#finalBranchPanel > * {
  position: relative;
  z-index: 3;
}

/* optional: small beveled edge to mimic old hardware frame */
#finalBranchPanel .terminal-bezel-edge {
  position: absolute;
  inset: 0;
  border-radius: 10px;
  pointer-events: none;
  box-shadow: 0 6px 18px rgba(0,0,0,0.6) inset;
  z-index: 0;
}


/* Vertical data stream (behind content) */
.data-stream {
  position: absolute;
  inset: 0;
  z-index: 0;
  pointer-events: none;
  background-image:
    linear-gradient(90deg, rgba(0,0,0,0.0), rgba(0,255,136,0.02) 1px, rgba(0,0,0,0.0)),
    linear-gradient(180deg, rgba(0,255,136,0.03) 0%, rgba(0,255,136,0.01) 8%, transparent 40%);
  background-size: 4px 100%, 100% 300px;
  opacity: 0.32;
  filter: blur(0.8px) contrast(1.05);
  animation: streamScroll 8s linear infinite;
}
@keyframes streamScroll {
  0% { background-position: 0 0, 0 0; }
  100% { background-position: 0 -1200px, 0 -300px; }
}


/* Header — monospaced terminal glow (no shimmer) */
#finalBranchPanel .final-branch-heading {
  position: relative;
  z-index: 3;
  font-family: 'Share Tech Mono', monospace;
  font-size: 1.8rem;
  color: #00ff88;
  font-weight: 800;
  letter-spacing: 0.12em;
  text-align: center;
  margin: 0 0 12px 0;
  text-shadow:
    0 0 6px rgba(0,255,136,0.6),
    0 0 12px rgba(0,255,136,0.35);
}

/* Tier hologram — terminal log style (green, monospaced) */
#finalBranchPanel #tierHologram {
  position: relative;
  z-index: 3;
  font-family: 'Share Tech Mono', monospace;
  font-size: 1.25rem;
  color: #7fffb0;
  text-align: center;
  letter-spacing: 0.12em;
  min-height: 1.6em;
  margin: 6px 0 12px;
  opacity: 0;
  transform: translateY(6px) scale(0.98);
  text-shadow: 0 0 8px rgba(127,255,176,0.35);
  pointer-events: none;
}

/* ghost echo behind hologram */
#tierHologram::before {
  content: attr(data-echo);
  position: absolute;
  inset: 0;
  color: rgba(127,255,176,0.06);
  z-index: -1;
  transform: translateY(2px) scale(1.02);
  filter: blur(6px);
  pointer-events: none;
}

/* holo animations */
.holo-fade-in { animation: holoIn 900ms cubic-bezier(.2,.9,.2,1) forwards; }
.holo-fade-out { animation: holoOut 700ms cubic-bezier(.2,.9,.2,1) forwards; }

@keyframes holoIn {
  0%   { opacity: 0; transform: translateY(10px) scale(0.96); filter: blur(3px) saturate(0.8); }
  60%  { opacity: 1; transform: translateY(-2px) scale(1.02); filter: blur(0.8px) saturate(1.05); }
  100% { opacity: 1; transform: translateY(0) scale(1); filter: blur(0px) saturate(1.1); }
}
@keyframes holoOut {
  0%   { opacity: 1; transform: translateY(0) scale(1); filter: blur(0px) saturate(1.1); }
  100% { opacity: 0; transform: translateY(-8px) scale(0.96); filter: blur(3px) saturate(0.8); }
}


/* Boot script block (separate from tierHologram) */
#finalBranchPanel #finalBranchScript {
  position: relative;
  z-index: 3;
  font-family: 'Share Tech Mono', monospace;
  font-size: 1rem;
  color: #00ff88;
  white-space: pre-wrap;
  line-height: 1.5;
  margin: 6px 0;
  border-left: 2px solid rgba(0,255,136,0.12);
  padding-left: 10px;
  text-shadow: 0 0 6px rgba(0,255,136,0.18);
}

/* Mystery sentence (singular ID) */
#finalBranchPanel #mysterySentence {
  position: relative;
  z-index: 3;
  font-family: 'Share Tech Mono', monospace;
  font-size: 1.05rem;
  color: #aaffcc;
  font-style: italic;
  text-align: center;
  margin: 14px 0 18px 0;
  opacity: 0;
  transition: opacity 1.2s ease;
  text-shadow: 0 0 6px rgba(0,255,136,0.25);
}

/* Sigil glow (optional crest behind content) */
#finalBranchPanel .sigil-glow {
  position: absolute;
  top: 50%;
  left: 50%;
  width: 180px;
  height: 180px;
  transform: translate(-50%, -50%);
  border-radius: 50%;
  background: radial-gradient(circle, rgba(0,255,136,0.06) 0%, transparent 60%);
  animation: pulseGlow 3s ease-in-out infinite;
  z-index: 1;
  pointer-events: none;
}
@keyframes pulseGlow {
  0%   { transform: translate(-50%, -50%) scale(1); opacity: 0.6; }
  50%  { transform: translate(-50%, -50%) scale(1.06); opacity: 1; }
  100% { transform: translate(-50%, -50%) scale(1); opacity: 0.6; }
}

/* Proceed button — console prompt style (hidden until revealed) */
#finalBranchPanel .branch-sigil-btn {
  position: relative;
  z-index: 3;
  display: inline-block;
  margin: 18px auto 0 auto;
  padding: 12px 26px;
  font-family: 'Share Tech Mono', monospace;
  font-size: 1.02rem;
  color: #00ff88;
  background: transparent;
  border: 2px solid rgba(0,255,136,0.6);
  border-radius: 8px;
  box-shadow: 0 0 12px rgba(0,255,136,0.18), inset 0 0 6px rgba(0,255,136,0.04);
  cursor: pointer;
  transform: translateY(8px);
  opacity: 0;
  pointer-events: none;
  transition: opacity 420ms ease, transform 420ms ease;
}

/* Button visible state (JS toggles) */
#finalBranchPanel .branch-sigil-btn.visible {
  transform: translateY(0);
  opacity: 1;
  pointer-events: auto;
}

/* Terminal flicker glow for script text */
.terminal-script {
  font-family: 'Share Tech Mono', monospace;
  font-size: 1.02rem;
  color: #00ff88;
  text-shadow: 0 0 6px rgba(0,255,136,0.35);
  white-space: pre-wrap;
  line-height: 1.5;
  padding: 8px 0;
  border-left: 2px solid rgba(0,255,136,0.12);
  z-index: 3;
}

/* blinking cursor (single definition) */
.terminal-script::after {
  content: "_";
  display: inline-block;
  margin-left: 6px;
  color: #00ff88;
  animation: blinkCursor 1s steps(1) infinite;
}
@keyframes blinkCursor {
  0%, 100% { opacity: 1; }
  50% { opacity: 0; }
}

/* awaiting-fade: fade the last awaiting line (applies to the whole block briefly) */
.terminal-script.awaiting-fade {
  animation: terminalAwaitFade 1.2s forwards;
}
@keyframes terminalAwaitFade {
  0%   { opacity: 1; filter: none; transform: translateY(0); }
  80%  { opacity: 0.35; filter: blur(0.6px); transform: translateY(-4px); }
  100% { opacity: 0; transform: translateY(-6px); }
}
.oneTimeCodeWrap { z-index: 4; margin-top: 12px; text-align:center; }
.runez-btn {
  padding: 10px 14px;
  border-radius: 10px;
  background: linear-gradient(180deg, rgba(127,255,176,0.06), rgba(127,255,176,0.03));
  color: #07120a;
  border: 2px solid rgba(127,255,176,0.12);
  cursor: pointer;
  font-weight:700;
  transition: transform 220ms ease, box-shadow 220ms ease;
  font-family: inherit;
}
.runez-btn:hover { transform: translateY(-4px); box-shadow: 0 18px 40px rgba(0,0,0,0.6), 0 0 36px rgba(127,255,176,0.08); }
/* Legibility tweak for runez buttons */
.runez-btn {
  color: #0b1f12;               /* slightly deeper green-black for better contrast */
  font-weight: 800;             /* stronger weight for clarity */
  font-size: 15px;             /* slightly larger for readability */
  letter-spacing: 0.03em;      /* gentle tracking to improve character separation */
  text-shadow: 0 1px 0 rgba(255,255,255,0.06), 0 2px 8px rgba(0,0,0,0.28);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

/* Optional: stronger outline for low-contrast backgrounds */
.runez-btn.runez-btn--outlined {
  color: rgba(255,255,255,0.60) !important;
  text-shadow: 0 1px 0 rgba(0,0,0,0.22);
  font-weight: 700;
}




  </style>
</head>
<body>
  <div class="container">
    <div class="crest-header"></div>
    <h1>Prestige Triumph: Oversight Entry</h1>

    <!-- Public form -->
    <form id="loveform" method="POST" class="prestige-form"
      action="https://www.blogger.com/contact-form.do"
      target="hidden_iframe"
      onsubmit="return submitCeremonialForm();"
          data-unify="true"
      style="max-width:600px;margin:40px auto;padding:32px;background:#fff;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.12);">
      <label for="role">Select Tier</label>
      <select id="role" name="role" required>
        <option value="">Select your role</option>
        <option value="Initiate">Initiate</option>
        <option value="Steward">Steward</option>
        <option value="Neighbor">Neighbor</option>
        <option value="Contributor">Contributor</option>
        <option value="Observer">Observer</option>
        <option value="Supporter">Supporter</option>
        <option value="Archivist">Archivist</option>
      </select>

      <div style="text-align:center; margin:12px 0 18px 0;">
        <button type="button" id="genNameBtn"
                onclick="generateNameFromTier()"
                style="width:70%; max-width:320px; background:#c2a76d; color:#fff;
                       border:none; padding:10px 18px; border-radius:6px;
                       font-size:1em; box-shadow:0 2px 6px rgba(0,0,0,0.2);
                       cursor:pointer;">
          ✨ Generate Prestige Name
        </button>
      </div>

      <input type="text" id="name" name="name" placeholder="e.g., Solenne of the Third Tier" required style="width:100%;padding:12px 14px;border:1px solid #b8aee0;border-radius:6px;background:#fafafa;color:#4b3f72;">
      <label for="phone">Contact Number</label>
      <input type="tel" id="phone" name="phone" placeholder="e.g., +1 616-555-1234" required style="width:100%;padding:12px 14px;border:1px solid #b8aee0;border-radius:6px;background:#fafafa;color:#4b3f72;">

      <textarea id="message" name="message" style="display:none;"></textarea>
      <input type="email" name="email" id="bloggerEmail" style="display:none;">
      <button type="submit" style="margin-top:24px;width:100%;padding:14px;background:linear-gradient(to right,#4b3f72,#6a5acd);color:white;border:none;border-radius:8px;font-size:1.1em;cursor:pointer;">Create Account</button>
<iframe name="hidden_iframe" style="display:none;"></iframe>
      <!--<p id="tapHint" style="margin-top:10px;">Tap top-left then top-right to unlock Admin gate.</p>-->
    </form>

    <!-- Admin chamber -->
<!-- Admin Chamber (hidden by default) -->
<form id="adminForm"
      method="POST"
      action="https://www.blogger.com/contact-form.do"
      target="hidden_iframe"
      onsubmit="return handleAdminAccess(false);"
      class="chamber-form"
      style="display:none;"
      data-unify="true">
   <h2>Admin Access</h2>
  
   <!-- Tier selection -->
  <label for="adminTier">Tier</label>
  <select id="adminTier" name="adminTier" required>
    <option value="">-- Select Tier --</option>
    <option value="Admin">Admin</option>
    <option value="MasterAdmin">MasterAdmin</option>
    <option value="Overseer">Overseer</option>
    <option value="Controller">Controller</option>
    <option value="Custodian">Custodian</option>
    <option value="Guardian">Guardian</option>
    <option value="Sentinel">Sentinel</option>
    <option value="Supervisor">Supervisor</option>
    <option value="Coordinator">Coordinator</option>
    <option value="Director">Director</option>
    <option value="Chancellor">Chancellor</option>
    <option value="Prefect">Prefect</option>
    <option value="Warden">Warden</option>
    <option value="Marshal">Marshal</option>
    <option value="Commander">Commander</option>
    <option value="Principal">Principal</option>
    <option value="Chief">Chief</option>
    <option value="SovereignAdmin">SovereignAdmin</option>
    <option value="LegacyAdmin">LegacyAdmin</option>
  </select>

 
<!-- Specialized name generator -->
<button type="button" id="adminGenNameBtn"class="runez-btn runez-btn--outlined">Generate Beloved Name</button><br>
<br>
<br>

<!-- Target field (same as public form) -->
<input type="text" id="adminName" name="name" placeholder="Ceremonial Name" />

  

  <!-- Contact phone -->
  <label for="adminPhone">Contact Phone</label>
  <input id="adminPhone" name="phone" type="tel" placeholder="(###) ###-####" required />

  <!-- Clearance code -->
  <label for="adminCode">Clearance Code</label>
  <input id="adminCode" name="adminCode" type="password" required />


  <!-- Hidden Blogger fields -->
  <textarea id="adminMessage" name="message" style="display:none;"></textarea>
  <input type="email" id="adminEmail" name="email" style="display:none;">

  <!-- Buttons -->
  <button type="submit" id="runeClearBtn" class="runez-btn">Submit Admin Form</button>
  <iframe name="hidden_iframe" style="display:none;"></iframe>
  <button type="button" id="verifyTierBtn" style="display:none;">Verify</button>

  <!-- Status -->
  <p id="verifyStatus"></p>
</form>



<div id="colorPanel" class="panel-shell" style="display:none;">
      <div class="ritual-header" style="display:flex;flex-direction:column;align-items:center;gap:12px;margin-bottom:16px;">
        <div class="runic">ᚠᛇᚻᛜᚱ</div>
        <div class="sigil" aria-hidden="true" style="position:relative;width:72px;height:72px;display:flex;align-items:center;justify-content:center;filter:drop-shadow(0 0 14px rgba(212,184,106,0.45));">
          <span class="sigil-ring" style="position:absolute;inset:0;border-radius:50%;background:radial-gradient(circle, rgba(212,184,106,0.8), rgba(95,192,181,0.7));"></span>
          <span class="sigil-core" style="position:absolute;inset:18px;border-radius:50%;background:radial-gradient(circle, rgba(40,40,45,0.8), rgba(90,106,122,0.6));"></span>
          <span class="sigil-square" style="position:absolute;width:36px;height:36px;transform:rotate(45deg);background:linear-gradient(135deg, rgba(242,240,233,0.95), rgba(212,184,106,0.85));"></span>
        </div>
      </div>

      <p class="designation">Designation: <strong id="nameInRitual"></strong></p>

      <div class="indicator-lines" id="indicatorLines">
        <span></span><span></span><span></span><span></span>
</div>

      <div id="sequenceReadout" class="sequence">— — —</div>
      <div class="rune-grid" id="panelButtons"></div>

      <div class="ritual-controls">
        <button type="button" id="runeVerifyBtn">VERIFY</button>
        <button type="reset" id="runeClearBtn">CLEAR</button>
      </div>
    </div>

    <!-- Access keypad -->
<div id="superCodePanel" class="panel-shell" style="display:none; position:relative;">
  <h3 class="access-heading">Access Panel</h3>
  <div class="panel-content">
    <p class="access-instruction">Rune keypad unlocked. Enter access code to proceed.</p>

    <div class="access-input-wrap">
      <input id="accessCodeInput" type="text" placeholder="Enter code (X-719-BOX)">
      <div class="access-crown" aria-hidden="true">♛</div>
    </div>

    <button type="button" id="accessConfirmBtn" class="runez-btn">CONFIRM</button>
    <p id="accessCodeStatus"></p>
  </div>
</div>


    <!-- Mystery Box chamber -->
<div id="mysteryBoxChamber" class="panel-shell" style="display:none;">
  <h2 class="mystery-title">Mystery Box Chamber</h2>

  <div class="mystery-crest-wrap">
    <div class="mystery-crest">♛ ⚚ ⟁</div>
  </div>

  <p class="mystery-sentence">The chamber hums with hidden power. Attempt the Puzzle Box?</p>

  <div class="mystery-button-wrap">
    <button id="attemptPuzzleBtn" class="wooden-btn">Attempt Puzzle Box</button>
  </div>
</div>


 <!-- Puzzle Box — Labyrinth Cube -->
<!-- Puzzle Box — Labyrinth Cube -->
<div id="puzzleBoxPanel" class="panel-shell" style="display:none;">
  <h2 class="mystery-title">Puzzle Box — Labyrinth Cube</h2>
  <p>Designation: <strong id="nameInPuzzle"></strong></p>
<div id="hiddenSigil">✧ Triumphal Sigil ✧</div>

  <div id="imgVoidPuzzle">
    <div class="cube-container">
      <div class="cube" id="labyrinthCube">
        <div class="cube-face front">
          <p>Toggle all lights green</p>
          <div id="lightsGrid">
            <button class="light-cell"></button><button class="light-cell"></button><button class="light-cell"></button>
            <button class="light-cell"></button><button class="light-cell"></button><button class="light-cell"></button>
            <button class="light-cell"></button><button class="light-cell"></button><button class="light-cell"></button>
          </div>
          <div id="runeL" class="rune">Λ</div>
        </div>
        <div class="cube-face back">
          <p>Align the dial to ★</p>
          <input type="range" id="dial" min="0" max="5" value="0">
          <div id="runeD" class="rune">✦</div>
        </div>
        <div class="cube-face right">
          <p>Unscramble: "RAEL"</p>
          <input type="text" id="wordInput" placeholder="Your answer">
          <div id="runeW" class="rune">Ψ</div>
        </div>
        <div class="cube-face left">
          <p>Trace the hidden path</p>
          <div id="labyrinthGrid">
            <!-- 5x5 grid -->
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
            <div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div><div class="cell"></div>
          </div>
          <div id="runeM" class="rune">Ω</div>
        </div>
        <div class="cube-face top">
          <p>Repeat the sequence</p>
          <button id="startMemory">Start</button>
          <div id="memoryButtons">
            <button class="mem" data-val="0">▲</button>
            <button class="mem" data-val="1">◆</button>
            <button class="mem" data-val="2">⚙</button>
          </div>
          <div id="runeS" class="rune">Σ</div>
        </div>
        <div class="cube-face bottom">
          <p>Select numbers to sum to 15</p>
          <div id="mathGrid">
            <button class="num">4</button><button class="num">7</button>
            <button class="num">2</button><button class="num">8</button><button class="num">5</button>
          </div>
          <div id="runeN" class="rune">Φ</div>
        </div>
      </div>
    </div>
  </div>
<div id="voidRelayPanel" class="panel-shell" style="display:none;">
  <div class="void-message" id="voidMessageArea"></div>
</div>

  <p id="unlockMessage" style="display:none;">✨ The Labyrinth Cube Unlocks! ✨</p>
</div>

    <!-- Final Branch QUBE-ACCESS-777-->
    <!-- Drop this into your page where the Final Branch panel should appear -->
<div id="finalBranchPanel" class="panel-shell" role="region" aria-label="Final Branch" style="display:none; position:relative;">
  <!-- Vertical data stream (background) -->
  <div class="data-stream" aria-hidden="true"></div>

  <!-- Optional ghost crest glow (behind content) -->
  <div class="sigil-glow" aria-hidden="true"></div>

  <!-- Header (monospaced terminal style) -->
  <h2 class="final-branch-heading" aria-hidden="true">FINAL BRANCH</h2>

  <!-- Tier hologram (cycles tier lines like a terminal) -->
  <pre id="tierHologram" class="terminal-script" aria-live="polite" role="status"></pre>

  <!-- Boot script block (separate from tierHologram) -->
  <pre id="finalBranchScript" class="terminal-script" aria-hidden="false"></pre>

  <!-- Final mystery sentence (revealed after boot sequence) -->
  <p id="mysterySentence" class="terminal-script" aria-hidden="false"></p>

  <!-- Proceed button (hidden until revealed by JS) -->
  <div style="text-align:center; margin-top:12px;">
    <button id="toFinalClearanceBtn" class="branch-sigil-btn" type="button" aria-label="Proceed to Final Clearance Qube">
      Proceed to Final Clearance Qube
    </button>
  </div>
</div>







 
<!-- Final Clearance Chamber Puzzle Box Mechanism -->
<div id="finalClearancePanel" class="panel-shell" style="display:none; position:relative;">
  <h2 class="mystery-title">🎖 CONGRATULATIONS🎖</h2>
  <div class="glowing-cube"></div>

  <p class="final-instruction">Enter the final clearance code to unlock the Superform.</p>

  <div style="display:flex;justify-content:center;align-items:center;gap:12px;margin-bottom:16px;">
    <input id="finalClearanceCode" type="password" placeholder="Re-enter final code" />
    <button id="finalClearanceBtn" class="trophy-btn">Unlock</button>
  </div>

  <p id="finalClearanceStatus"></p>

  <!-- One-time tier code controls -->
  <div class="oneTimeCodeWrap" style="margin-top:12px; text-align:center;">
    <label for="finalTier" style="color:var(--gold);font-weight:600;display:block;margin-bottom:8px;">Choose one-time tier</label>
    <select id="finalTier" aria-label="Choose tier for one-time code" style="min-width:220px;padding:8px;border-radius:6px;background:rgba(255,255,255,0.03);color:#ffd87a;border:1px solid rgba(255,255,255,0.06);">
      <option value="">-- pick tier --</option>
      <option value="Legacy">Legacy</option>
      <option value="Luminary">Luminary</option>
      <option value="Sovereign">Sovereign</option>
      <option value="Ascendant">Ascendant</option>
      <option value="Founders">Founders</option>
      <option value="Eternal">Eternal</option>
      <option value="Prime">Prime</option>
      <option value="Dominion">Dominion</option>
    </select>

    <div style="height:10px;"></div>

    <button id="generateTierCodeBtn" type="button" class="runez-btn" style="max-width:260px;">
      Reveal One‑Time Code
    </button>

    <div id="oneTimeCode" class="oneTimeCode" role="status" aria-hidden="true" style="margin-top:12px;"></div>
  </div>

  <!-- Grid container for 8-ball ritual -->
  <div id="panelButtons" class="panel-buttons" style="margin-top:18px;"></div>
</div>



    <!-- Superform chamber -->
    <div id="mysteryBoxPanel" class="panel-shell" style="display:none; border-color: var(--violet); box-shadow: inset 0 0 25px rgba(0,0,0,0.8), 0 0 20px rgba(138,43,226,0.6);">
      <h2 class="mystery-title">Super Level Access</h2>
      <div class="mystery-crest">♛ ⚚ ⟁</div>
      <div class="cube-aura" aria-hidden="true"></div>
      <form id="superLevelForm" data-unify="true"onsubmit="return submitSuperForm();">
        <!-- Sigil watermark behind form -->
  <div class="panel-sigil"></div>
        <!-- Frost overlay layer -->
  <div class="frost-overlay"></div>
        
         <br> <br>
        <label for="superTier">Tier</label>
        <select id="superTier" name="superTier">
    <option value="">-- choose --</option>
    <option value="Legacy">Legacy</option>
    <option value="Luminary">Luminary</option>
    <option value="Sovereign">Sovereign</option>
    <option value="Ascendant">Ascendant</option>
    <option value="Founders">Founders</option>
    <option value="Eternal">Eternal</option>
    <option value="Prime">Prime</option>
    <option value="Dominion">Dominion</option>
  </select>
        <br> <br>
        <!-- Generator button -->
  <button type="button" id="genSuperNameBtn">Commemence </button>
        <br> <br>
         <label for="superName">Account Holder</label>
        <input id="superName" name="superName" required type="text" />
        <br> <br>
        <!-- Contact phone -->
  <label for="superPhone">Contact Phone</label>
  <input id="superPhone" name="phone" type="tel" placeholder="(###) ###-####" required />
        <br> <br>
        <label for="superCode">Clearance Code</label>
        <input id="superCode" name="superCode" required type="password" />
         <br> <br>
        <button type="submit">Honor Granted</button>
        <iframe name="hidden_iframe" style="display:none;"></iframe>
        <p id="superStatus"></p>
      </form>
    </div>

    <!-- Verification plaque -->
    <div class="verification-plaque" id="verificationPlaque">
      <p>Copy this verification text and paste it into the official Prestige Verification Form:</p>
      <textarea id="verificationText" readonly></textarea>
      <button type="button" onclick="copyVerification()">📋 Copy Verification Text</button>
    </div>
  </div>

  <!-- Crest shortcut -->
  <div class="floating-crest" onclick="unlockSuperForm()" title="Bonus"></div>

  <!-- Blogger iframe target 
  <iframe name="hidden_iframe" style="display:none;"></iframe>
<!-- Canonical hidden Blogger widget (single source-of-truth for all submissions) -->
<form id="hiddenBloggerForm" action="https://www.blogger.com/contact-form.do" method="POST" target="hidden_iframe" style="display:none;">
  <input type="text" id="hbName" name="name" value="">
  <input type="tel"  id="hbPhone" name="phone" value="">
  <textarea   id="hbMessage" name="message"></textarea>
  <input type="email" id="hbSubmitBtn" name="email" value="">
  <button type="submit" id="hbSubmitBtn">Send</button>
</form>

  <!-- Tap shimmer + zones -->
  <div class="tap-shimmer" id="tapShimmer"></div>
  <div id="tapTopLeft" class="tap-zone" aria-hidden="true"></div>
  <div id="tapTopRight" class="tap-zone" aria-hidden="true"></div>
<div id="puzzleNotice">
  📱 For true Puzzle Box engagement, reduce your screen size to 50% on mobile.
</div>
<script>
/* =========================
   Prestige Triumph — Merged Script
   Single-file canonical copy (paste into your page)
   ========================= */

/* ===== Panel helpers ===== */
function showPanel(id){ const el=document.getElementById(id); if(el) el.style.display='block'; }
function hidePanel(id){ const el=document.getElementById(id); if(el) el.style.display='none'; }

/* ===== Clipboard for verification plaque ===== */
function copyVerification() {
  const textArea = document.getElementById("verificationText");
  if (!textArea) return;
  textArea.select();
  textArea.setSelectionRange(0, 99999);
  try { document.execCommand("copy"); } catch(e) { /* ignore */ }
  alert("Verification text copied. Please paste it into the Google Form field.");
}

/* ===== Utility helpers ===== */
function shuffleArray(arr) {
  const a = [...arr];
  for (let i = a.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [a[i], a[j]] = [a[j], a[i]];
  }
  return a;
}
function arraysMatch(a, b) {
  if (a.length !== b.length) return false;
  for (let i = 0; i < a.length; i++) if (a[i] !== b[i]) return false;
  return true;
}

function pickRandom(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
function el(id){ return document.getElementById(id); }
/* ===== Name generators (public + admin) ===== */
function generateTieredName(tier) {
  const pools = {
    Initiate: { names:[ "Lena","Jamal","Sofia","Kai","Maya","Aria","Jonas","Clara","Mateo","Nora","Ethan","Layla","Owen","Iris","Caleb","Zoe","Lucas","Amira","Noah","Elise","Ravi","Chloe","Daniel","Isla","Micah"], suffixes:["of the Welcome Ledger","of the First Entry","of the Community Fold","of the Opening Gate","of the Dawn Register","of the Entry Scroll","of the Common Hall","of the First Circle","of the Hearth Record","of the Entryway","of the Shared Beginning","of the Welcome Chamber","of the Initial Archive","of the Entry Crest","of the Common Ledger","of the First Bond","of the Entry Tier","of the Hearth Fold","of the Welcome Archive","of the Entry Seal"] },
    Steward: { names:[ "Elias","Priya","Malcolm","Zara","Omar","Jonah","Fatima","Marcus","Leila","Hassan","Claudia","Rafael","Nadia","Victor","Amal","Simone","Darius","Farah","Julien","Anika","Mateo","Selene","Harun","Lucia","Khalid"], suffixes:["of the Civic Watch","of the Shared Archive","of the Stewardship Line","of the Civic Chamber","of the Guardian Fold","of the Civic Register","of the Watchful Tier","of the Civic Crest","of the Steward’s Bond","of the Civic Archive","of the Guardian Ledger","of the Civic Seal","of the Stewardship Archive","of the Civic Scroll","of the Watch Chamber","of the Civic Fold","of the Stewardship Crest","of the Civic Tier","of the Guardian Archive","of the Civic Authority"] },
    Neighbor: { names:[ "Ava","Noah","Grace","Leo","Isla","Hugo","Mila","Samir","Clara","Julian","Tara","Felix","Nina","Oscar","Amira","Eli","Sienna","Mateo","Lila","Jonas","Raya","Victor","Nora","Arjun","Elena"], suffixes:["of the Local Registry","of the Neighborhood Tier","of the Common Fold","of the Shared Street","of the Neighbors Archive","of the Local Crest","of the Common Ledger","of the Hearth Tier","of the Local Archive","of the Neighbors Bond","of the Shared Ledger","of the Local Scroll","of the Common Register","of the Neighbors Seal","of the Local Fold","of the Shared Archive","of the Hearth Crest","of the Local Tier","of the Neighbors Archive","of the Common Authority"] },
    Contributor: { names:[ "Milan","Tessa","Jude","Nina","Arlo","Ravi","Clara","Jonas","Elise","Mateo","Amira","Daniel","Layla","Owen","Iris","Chloe","Lucas","Noah","Zoe","Micah","Anya","Victor","Nora","Julien","Farah"], suffixes:["of the Support Ledger","of the Contributor Line","of the Community Archive","of the Shared Ledger","of the Contribution Crest","of the Support Archive","of the Contributors Bond","of the Community Fold","of the Support Register","of the Contribution Seal","of the Contributors Archive","of the Support Scroll","of the Community Ledger","of the Contribution Tier","of the Support Crest","of the Contributors Fold","of the Community Seal","of the Contribution Archive","of the Support Tier","of the Contributors Authority"] },
    Observer: { names:[ "Theo","Luna","Miles","Ivy","Rowan","Clara","Jonas","Elise","Mateo","Amira","Daniel","Layla","Owen","Iris","Chloe","Lucas","Noah","Zoe","Micah","Anya","Victor","Nora","Julien","Farah","Simone"], suffixes:["of the Quiet Watch","of the Passive Tier","of the Ledger Periphery","of the Silent Archive","of the Watchful Crest","of the Quiet Register","of the Passive Fold","of the Ledger Edge","of the Silent Ledger","of the Watch Chamber","of the Quiet Seal","of the Passive Archive","of the Ledger Scroll","of the Silent Crest","of the Watch Archive","of the Quiet Tier","of the Passive Ledger","of the Ledger Crest","of the Silent Fold","of the Watch Authority"] },
    Supporter: { names:[ "Elena","Caleb","Raya","Finn","Naomi","Jonas","Clara","Mateo","Nora","Amira","Daniel","Layla","Owen","Iris","Chloe","Lucas","Noah","Zoe","Micah","Anya","Victor","Nora","Julien","Farah","Simone"], suffixes:["of the Advocacy Fold","of the Support Tier","of the Donor Registry","of the Patron’s Archive","of the Support Crest","of the Advocacy Ledger","of the Donor’s Bond","of the Support Archive","of the Patron’s Fold","of the Advocacy Scroll","of the Support Register","of the Donor’s Seal","of the Patron’s Ledger","of the Advocacy Tier","of the Support Authority","of the Donor’s Archive","of the Patron’s Crest","of the Advocacy Archive","of the Support Seal","of the Donor’s Authority"] },
    Archivist: { names:[ "Solenne","Idris","Helena","Lucan","Amara","Jonas","Clara","Mateo","Nora","Amira","Daniel","Layla","Owen","Iris","Chloe","Lucas","Noah","Zoe","Micah","Anya","Victor","Nora","Julien","Farah","Simone"], suffixes:["of the Memory Vault","of the Archivist Line","of the Tiered Archive","of the Record Chamber","of the Archive Crest","of the Memory Ledger","of the Archivist’s Bond","of the Tiered Ledger","of the Record Scroll","of the Archive Seal","of the Memory Archive","of the Archivist’s Fold","of the Tiered Register","of the Record Archive","of the Archive Authority","of the Memory Crest","of the Archivist’s Archive","of the Tiered Seal","of the Record Ledger","of the Archive Tier"] }
  };
  const pool = pools[tier] || pools.Initiate;
  const name = pool.names[Math.floor(Math.random() * pool.names.length)];
  const suffix = pool.suffixes[Math.floor(Math.random() * pool.suffixes.length)];
  return `${name} ${suffix}`;
}
function generateNameFromTier() {
  const tier = document.getElementById('role')?.value;
  if (!tier) { alert('Please select a tier first.'); return; }
  document.getElementById('name').value = generateTieredName(tier);
}

/* Admin specialized name generator */
function generateAdminSpecializedName(tier) {
  const pools = {
    Admin: { names:["Xyric","Velonar","Kaelith","Druvenor","Myrosan","Tavricus","Zerath","Olyren","Nerith","Solvion"], suffixes:["of the Gate Sigil","of the Iron Seal","of the Hidden Ledger","of the Crown Archive","of the Watch Spire"] },
    MasterAdmin: { names:["Solvarn","Eryndor","Calethor","Thyrosan","Lumielor","Varrosan","Aurethor","Calyrian","Therion","Vaelor"], suffixes:["of the Eternal Crown","of the Master Seal","of the Oversight Chamber","of the Sovereign Archive","of the Prime Ledger"] },
    Overseer: { names:["Maraven","Oristar","Kyreth","Valmor","Serath","Ilyrion","Drevan","Koriel","Navros","Pelior"], suffixes:["of the Panoptic Tier","of the Vigil Crest","of the Oversight Watch","of the Long View","of the Sentinel Ledger"] },
    Controller: { names:["Branth","Cyris","Tavren","Morix","Elion","Kadroth","Fenlor","Rystan","Ulric","Veldor"], suffixes:["of the Axis Chamber","of the Control Seal","of the Switch Crest","of the Relay Archive","of the Circuit Ledger"] },
    Custodian: { names:["Amaret","Soriel","Bastin","Eldra","Hamon","Lethir","Norian","Pelra","Quenel","Serin"], suffixes:["of the Keep Fold","of the Vault Seal","of the Memory Hold","of the Chamber Keys","of the Archive Lock"] },
    Guardian: { names:["Rhaeth","Galenor","Mireth","Thalen","Corvus","Eryx","Jorrel","Kaeth","Lorik","Serros"], suffixes:["of the Shield Line","of the Gate Ward","of the Crest Watch","of the Hall Guard","of the Bastion Seal"] },
    Sentinel: { names:["Ariste","Caden","Delys","Ferox","Ithar","Kynos","Lyren","Maelor","Nestor","Pyron"], suffixes:["of the Upper Watch","of the Quiet Keep","of the Night Vigil","of the Sight Line","of the Lamp Crest"] },
    Supervisor: { names:["Renvar","Tessan","Orwyn","Marella","Dorian","Helis","Karaen","Leoris","Navor","Selyn"], suffixes:["of the Line Ledger","of the Flow Tier","of the Review Crest","of the Pattern Scroll","of the Rhythm Archive"] },
    Coordinator: { names:["Arion","Belis","Coraen","Demin","Elvar","Faryn","Galius","Heryn","Islor","Jalara"], suffixes:["of the Node Tier","of the Thread Ledger","of the Mesh Crest","of the Lattice Archive","of the Sequence Seal"] },
    Director: { names:["Callion","Drexor","Eamon","Fiora","Helion","Ivara","Jorik","Kaelis","Lyraen","Mavros"], suffixes:["of the Arc Chamber","of the Prime Tier","of the Guiding Seal","of the Lineage Archive","of the Crest Ledger"] },
    Chancellor: { names:["Aurel","Beren","Cyral","Demos","Elara","Fidel","Galen","Helia","Isran","Joriel"], suffixes:["of the Council Seal","of the Civic Crest","of the Scroll Authority","of the Ledger Court","of the Archive Seat"] },
    Prefect: { names:["Ardan","Basile","Cyrion","Delios","Ephra","Feron","Gaius","Helor","Iason","Jaryn"], suffixes:["of the Order Seal","of the Hall Rule","of the Crest Codex","of the Tier Decree","of the Ledger Law"] },
    Warden: { names:["Brenor","Cadal","Dethis","Eryon","Faelis","Gorath","Halden","Ivern","Jareth","Kalen"], suffixes:["of the Gate Hold","of the Lock Tier","of the Bar Crest","of the Guard Archive","of the Seal Chain"] },
    Marshal: { names:["Caldris","Dorian","Eryx","Faelor","Gareth","Harion","Jalen","Korath","Lyris","Mavren"], suffixes:["of the Banner Line","of the Crest March","of the Field Seal","of the Standard Archive","of the Rally Ledger"] },
    Commander: { names:["Corvin","Darex","Eidon","Feran","Galen","Hector","Ilyon","Jaro","Kaelis","Leron"], suffixes:["of the Legion Crest","of the Column Seal","of the Order March","of the Line Archive","of the Command Ledger"] },
    Principal: { names:["Alestor","Bryn","Calyx","Demos","Eland","Fiora","Galen","Helis","Ionar","Jarin"], suffixes:["of the Ledger Seat","of the Crest Chair","of the Prime Scroll","of the Tier Authority","of the Archive Root"] },
    Chief: { names:["Avar","Bastion","Cairn","Dorel","Evanor","Ferran","Garran","Helion","Ithar","Jaro"], suffixes:["of the Crest Line","of the Root Ledger","of the Core Seal","of the Upper Archive","of the Crown Scroll"] },
    SovereignAdmin: { names:["Solvarn","Aurion","Calther","Eryndor","Lumiel","Thyros","Varros","Xerion","Ylath","Zevran"], suffixes:["of the Sovereign Crown","of the Eternal Seal","of the Prime Archive","of the Royal Ledger","of the High Chamber"] },
    LegacyAdmin: { names:["Arion","Belor","Cyris","Drevan","Elion","Faryn","Galen","Helor","Ilyas","Jorren"], suffixes:["of the Legacy Archive","of the Elder Seal","of the Ancestral Ledger","of the Memory Court","of the Root Chamber"] }
  };
  const pool = pools[tier] || pools.Admin;
  const name = pool.names[Math.floor(Math.random() * pool.names.length)];
  const suffix = pool.suffixes[Math.floor(Math.random() * pool.suffixes.length)];
  return `${name} ${suffix}`;
}
/* Admin specialized name generator */
/* ===== Super-level registry and generator (single canonical source) ===== */
const SUPER_REGISTRY = {
  Legacy:    { accessCode: "LEGACY-444",   names: ["Riverstone∆ of the Eternal Crest","EchoRain77 of the Dawn Register","Sunveil-9 of the Legacy Seal","MoonspireX of the Ascendant Fold","Willow-333 of the Crowned Archive","StarpathΩ of the Hidden Ledger","Oceanrise-11 of the Sovereign Path","Emberflow∆line of the Ultra Tier","Cloudora-7 of the Honor Gate","Solstice-88 of the Chamber of Light","Brontis-77 of the Eternal Crest","Calyra-Ω of the Dawn Register","Drovian-X of the Legacy Seal","Ephyros-333 of the Ascendant Fold","Fynora-9 of the Crowned Archive","Galveth-∆line of the Hidden Ledger","Hestara-22 of the Sovereign Path","Icaron-X7 of the Ultra Tier","Jorvex-Ω11 of the Honor Gate","Lysorin-∆ of the Chamber of Light"] },
  Luminary:  { accessCode: "LUMINARY-333", names: ["C0gnira-X of the Eternal Crest","Neuro∆line of the Dawn Register","Synthara-9 of the Legacy Seal","Optivex-77 of the Ascendant Fold","Algoritha-22 of the Crowned Archive","Datara-Ω of the Hidden Ledger","Circuiton-5 of the Sovereign Path","Logicia-∆ of the Ultra Tier","Machinor-X3 of the Honor Gate","Codeon-44 of the Chamber of Light","Æthra-11 of the Eternal Crest","Veyra∆line of the Dawn Register","Orithan-77 of the Legacy Seal","Druvenor-X of the Ascendant Fold","Myrosan-Ω of the Crowned Archive"] },
  Sovereign: { accessCode: "SOVEREIGN-222", names: ["Tavricus-9 of the Hidden Ledger","Chronara-22 of the Sovereign Path","Custora-∆ of the Ultra Tier","Archivon-333 of the Honor Gate","Memoria-7 of the Chamber of Light","Astrovex-Ω of the Eternal Crest","Novacrest-77 of the Dawn Register","Igniscore-∆ of the Legacy Seal","Aurionis-9 of the Ascendant Fold","Velocent-X of the Crowned Archive","Omnira-22 of the Hidden Ledger","Spectrava-333 of the Sovereign Path","Zenithra-∆line of the Ultra Tier","Hyperion-5 of the Honor Gate","Stellaris-X7 of the Chamber of Light"] },
  Ascendant: { accessCode: "ASCEND-111",   names: ["Quiptor-9 of the Eternal Crest","Snarkis-77 of the Dawn Register","Witara-∆ of the Legacy Seal","Jestrel-X of the Ascendant Fold","Chuckleon-22 of the Crowned Archive","Praxen-Ω of the Hidden Ledger","Zyphor-333 of the Sovereign Path","Banterra-7 of the Ultra Tier","Smirkon-∆line of the Honor Gate","Gleevor-X5 of the Chamber of Light"] },
  Founders:  { accessCode: "FOUNDERS-999", names: ["Veythros-Ω of the Eternal Crest","Morvane-77 of the Dawn Register","Xytheris∆ of the Legacy Seal","Dreadalis-X9 of the Ascendant Fold","Corvantis-333 of the Crowned Archive","Nullara-∆line of the Hidden Ledger","Obscyra-11 of the Sovereign Path","Torvex-Ω7 of the Ultra Tier","Grimora-XIII of the Honor Gate","Ruinara-∆77 of the Chamber of Light"] },
  Eternal:   { accessCode: "ETERNAL-888",  names: ["Amunara-∆ of the Eternal Crest","Solkara-77 of the Dawn Register","Khepri-X of the Legacy Seal","Raelion-Ω of the Ascendant Fold","Osirion-333 of the Crowned Archive","Ankhotep-9 of the Hidden Ledger","Saphira-∆line of the Sovereign Path","Horvane-22 of the Ultra Tier","Luxora-X7 of the Honor Gate","Pharael-Ω11 of the Chamber of Light"] },
  Prime:     { accessCode: "PRIME-777",    names: ["Galvian-77 of the Eternal Crest","Aristona-∆ of the Dawn Register","Aurelius-X of the Legacy Seal","Cassivex-Ω of the Ascendant Fold","Domitian-333 of the Crowned Archive","Octavira-9 of the Hidden Ledger","Vitruvia-∆line of the Sovereign Path","Senecor-22 of the Ultra Tier","Plinora-X7 of the Honor Gate","Cicara-Ω11 of the Chamber of Light"] },
  Dominion:  { accessCode: "DOMINION-000", names: ["Lúmina-∆ of the Eternal Crest","Eryndra-77 of the Dawn Register","Kairos-X of the Legacy Seal","Solstice-Ω of the Ascendant Fold","EchoRain-333 of the Crowned Archive","Moonveil-9 of the Hidden Ledger","Astralis-∆line of the Sovereign Path","Serenya-22 of the Ultra Tier","Veyra-X7 of the Honor Gate","Novara-Ω11 of the Chamber of Light"] }
};

function generateSuperLevelNameFromRegistry(tier, accessCode){
  if (!tier || !accessCode) return "Invalid input";
  const pool = SUPER_REGISTRY[tier];
  if (!pool) return "Invalid tier";
  if (String(pool.accessCode).trim() !== String(accessCode).trim()) return "Invalid tier or access code";
  return pickRandom(pool.names);
}

/* ===== Blogger helpers and unified submission ===== */
function generateCardID() { return 'CARD-' + Math.random().toString(36).substr(2, 8).toUpperCase(); }
function generateAccessCode() { return 'ACCESS-' + Math.floor(100000 + Math.random() * 900000); }

/*
  submitToBlogger options:
   - name, phone, messageForBlogger, plaqueMessage, clearanceCode, accessCode, email, redirectURL
  Preferred flow: hiddenBloggerForm (hbName/hbPhone/hbMessage/hbEmail) if present.
  Plaque displays plaqueMessage (must not include sensitive access code).
/* Robust unified submitToBlogger (accepts message or messageForBlogger) */
function submitToBlogger({ name, phone = '', messageForBlogger = '', message = '', plaqueMessage = '', clearanceCode = '', accessCode = '', email = "prestige@triumph.org", redirectURL = '' }) {
  // normalize message variable (backwards compatible)
  const finalMessage = (messageForBlogger || message || '').trim();

  // local registry write (non-blocking)
  try {
    const cardMatch = finalMessage.match(/Account ID:\s*(\S+)/);
    const codeMatch = finalMessage.match(/Access Code:\s*(\S+)/) || finalMessage.match(/Clearance Code:\s*(\S+)/);
    const tierMatch = finalMessage.match(/Tier:\s*(.+)/);
    const registry = JSON.parse(localStorage.getItem('userRegistry')) || {};
    registry[name || ('anon_' + Date.now())] = {
      role: tierMatch ? tierMatch[1].trim() : '',
      phone,
      card: cardMatch ? cardMatch[1] : '',
      accessCode: codeMatch ? codeMatch[1] : (accessCode || ''),
      created: Date.now(),
      activated: false
    };
    localStorage.setItem('userRegistry', JSON.stringify(registry));
  } catch (e) { /* ignore storage errors */ }

  // Preferred: single canonical hidden form
  const hiddenForm = document.getElementById('hiddenBloggerForm');
  const hbName = document.getElementById('hbName');
  const hbPhone = document.getElementById('hbPhone');
  const hbMessage = document.getElementById('hbMessage');
  const hbEmail = document.getElementById('hbEmail');

  const payloadMessage = finalMessage || plaqueMessage || '';

  if (hiddenForm && hbName && hbMessage && hbEmail) {
    hbName.value = name || '';
    if (hbPhone) hbPhone.value = phone || '';
    hbMessage.value = payloadMessage;
    hbEmail.value = email || '';
    // submit and wait for iframe load before redirect
    try {
      const iframe = document.querySelector('iframe[name="hidden_iframe"], iframe[name="hidden_iframe"]');
      if (typeof hiddenForm.requestSubmit === 'function') hiddenForm.requestSubmit();
      else hiddenForm.submit();
      if (redirectURL && iframe) {
        const onLoad = () => {
          iframe.removeEventListener('load', onLoad);
          try { window.location.href = redirectURL; } catch (e) { /* ignore */ }
        };
        iframe.addEventListener('load', onLoad);
        // fallback safeguard
        setTimeout(() => { try { window.location.href = redirectURL; } catch (e) {} }, 8000);
      } else if (redirectURL) {
        // no iframe found: delay a bit before redirect to let browser queue submit
        setTimeout(() => { try { window.location.href = redirectURL; } catch (e) {} }, 2500);
      }
    } catch (err) {
      try { hiddenForm.submit(); } catch (e) { console.error('Blogger submit failed', e); }
      if (redirectURL) setTimeout(() => { try { window.location.href = redirectURL; } catch (e) {} }, 2500);
    }
    // surface plaque
    const plaque = document.getElementById('verificationPlaque');
    const vText = document.getElementById('verificationText');
    if (plaque && vText) { vText.value = plaqueMessage || ''; plaque.style.display = 'block'; }
    return;
  }

  // Fallback: legacy public widget fields
  const legacyName = document.getElementById('name');
  const legacyPhone = document.getElementById('phone');
  const legacyMsg = document.getElementById('message');
  const legacyEmail = document.getElementById('bloggerEmail');
  if (legacyName) legacyName.value = name || '';
  if (legacyPhone) legacyPhone.value = phone || '';
  if (legacyMsg) legacyMsg.value = payloadMessage;
  if (legacyEmail) legacyEmail.value = email || '';
  const loveForm = document.getElementById('love-form');
  if (loveForm) {
    try {
      if (typeof loveForm.requestSubmit === 'function') loveForm.requestSubmit();
      else loveForm.submit();
    } catch (e) {
      try { loveForm.submit(); } catch (err) { console.error('legacy form submit failed', err); }
    }
    const plaque = document.getElementById('verificationPlaque');
    const vText = document.getElementById('verificationText');
    if (plaque && vText) { vText.value = plaqueMessage || ''; plaque.style.display = 'block'; }
    if (redirectURL) setTimeout(() => { try { window.location.href = redirectURL; } catch (e) {} }, 2500);
    return;
  }

  // no form found — still show plaque
  const plaque = document.getElementById('verificationPlaque');
  const vText = document.getElementById('verificationText');
  if (plaque && vText) { vText.value = plaqueMessage || payloadMessage || ''; plaque.style.display = 'block'; }
  if (redirectURL) setTimeout(() => { try { window.location.href = redirectURL; } catch (e) {} }, 2500);
}

/* Public form submit: always generate an accessCode and keep plaque free of secrets */
function submitCeremonialForm() {
  const name = (document.getElementById('name')?.value || '').trim();
  const phone = (document.getElementById('phone')?.value || '').trim();
  const role = (document.getElementById('role')?.value || '').trim();
  const card = generateCardID();
  const accessCode = generateAccessCode();

  const messageForBlogger = `🪔 Prestige Triumph Verification
👤 Name: ${name}
📞 Phone: ${phone}
🎖 Tier: ${role}
🆔 Account ID: ${card}
🔑 Access Code: ${accessCode}`.trim();

  const plaqueMessage = `🪔 Prestige Triumph Verification
👤 Name: ${name}
🎖 Tier: ${role}
🆔 Account ID: ${card}`.trim(); // plaque intentionally excludes Access Code

  const redirectURL = `https://mrhim00.blogspot.com/2025/10/issued.html?card=${encodeURIComponent(card)}`;

  submitToBlogger({ name, phone, messageForBlogger, plaqueMessage, accessCode, redirectURL });
  return false;
}


/* ===== Crest unlock shortcut (Superform) ===== */
/**
 * Open a target which can be:
 *  - a full URL (http(s):// or starting with /) -> navigates or opens new tab
 *  - an element id or selector (e.g., "mysteryBoxPanel" or "#mysteryBoxPanel" or ".panel") -> shows the element
 *  - a function name (e.g., "openSuperform") -> calls the function if available
 *
 * options:
 *  - newTab: boolean (for URLs)
 *  - nameField: id of an input to populate with the value from #name (optional)
 *  - showClass: class to add when revealing an element (default "revealed")
 *  - displayStyle: style to set when revealing an element (default "block")
 */
function openTarget(target, options = {}) {
  if (!target) return console.warn('openTarget: no target provided');

  const cfg = Object.assign({
    newTab: false,
    nameField: 'superName',
    showClass: 'revealed',
    displayStyle: 'block'
  }, options);

  // helper: is URL?
  const isUrl = (t) => {
    try {
      // treat protocol-relative and absolute paths as URLs too
      return /^([a-zA-Z][a-zA-Z\d+\-.]*:)?\/\//.test(t) || t.startsWith('/');
    } catch (e) { return false; }
  };

  // helper: normalize selector/id
  const normalize = (t) => {
    if (t.startsWith('#') || t.startsWith('.')) return t;
    // if it looks like an id (no spaces, no special chars), try id first
    if (/^[\w-]+$/.test(t)) return `#${t}`;
    return t;
  };

  // 1) If it's a URL, navigate or open new tab
  if (isUrl(target)) {
    if (cfg.newTab) {
      window.open(target, '_blank', 'noopener');
      return;
    } else {
      window.location.href = target;
      return;
    }
  }

  // 2) If a global function exists with that name, call it
  if (typeof window[target] === 'function') {
    try {
      window[target]();
      return;
    } catch (err) {
      console.warn('openTarget: error calling function', target, err);
    }
  }

  // 3) Try to find an element by id or selector
  const sel = normalize(target);
  const el = document.querySelector(sel);

  if (el) {
    // If it's a form or panel, reveal it
    // Prefer calling a showPanel helper if available
    if (typeof window.showPanel === 'function') {
      try { window.showPanel(el.id || target); } catch (e) { /* ignore */ }
    }

    // set inline display and add reveal class
    el.style.display = cfg.displayStyle;
    if (cfg.showClass) el.classList.add(cfg.showClass);

    // focus first focusable child if present
    const focusable = el.querySelector('input,button,select,textarea,a[href]');
    if (focusable) focusable.focus();

    // populate name field if requested
    const nameVal = document.getElementById('name')?.value?.trim();
    if (nameVal && cfg.nameField) {
      const nf = document.getElementById(cfg.nameField);
      if (nf) nf.value = nameVal;
    }

    return;
  }

  // 4) If nothing matched, try calling a "open" prefixed function (openX)
  const tryFn = 'open' + target[0].toUpperCase() + target.slice(1);
  if (typeof window[tryFn] === 'function') {
    try { window[tryFn](); return; } catch (e) { console.warn('openTarget: error calling', tryFn, e); }
  }

  // 5) fallback: log and optionally navigate to a branch path if looks like one
  if (/^(branch|form|panel)[\w-]*$/i.test(target)) {
    // example fallback: /branches/<target>.html
    const fallbackUrl = `/branches/${target}.html`;
    window.location.href = fallbackUrl;
    return;
  }

  console.warn('openTarget: could not resolve target', target);
}

/* Convenience wrapper similar to your original function */
function unlockSuperForm(target = 'https://mrhim00.blogspot.com/2025/11/prestigestore.html', opts = {}) {
  // populate name into a default field if present
  const name = document.getElementById('name')?.value?.trim();
  if (name && opts.nameField) {
    const nf = document.getElementById(opts.nameField);
    if (nf) nf.value = name;
  }

  // call the generic opener
  openTarget(target, Object.assign({ nameField: opts.nameField || 'superName' }, opts));

  // optional user feedback
  if (opts.silent !== true) {
    // use non-blocking UI feedback if available
    if (typeof showToast === 'function') {
      showToast('Super-level access opened.');
    } else {
      console.info('Super-level access opened for target:', target);
    }
  }
}


/* ===== Tap shimmer and admin mobile unlock ===== */
let shimmerTimer;
function shimmerPulse(){
  const s=document.getElementById('tapShimmer'); if(!s) return;
  s.classList.add('active');
  clearTimeout(shimmerTimer);
  shimmerTimer=setTimeout(()=>s.classList.remove('active'),260);
}
let adminTapSequence=[]; let adminTapResetTimer;
function resetAdminTap(){ adminTapSequence=[]; clearTimeout(adminTapResetTimer); }
function checkAdminMobileUnlock(){
  const correct=['tapTopLeft','tapTopRight'];
  if(adminTapSequence.join(',')===correct.join(',')){
    showPanel('adminForm'); shimmerPulse(); resetAdminTap();
    const hint=document.getElementById('tapHint'); if(hint) hint.textContent="Admin gate unlocked. Verify your tier.";
  } else {
    adminTapResetTimer=setTimeout(resetAdminTap,8000);
  }
}
document.getElementById('tapTopLeft')?.addEventListener('click',()=>{ adminTapSequence.push('tapTopLeft'); shimmerPulse(); checkAdminMobileUnlock(); });
document.getElementById('tapTopRight')?.addEventListener('click',()=>{ adminTapSequence.push('tapTopRight'); shimmerPulse(); checkAdminMobileUnlock(); });

/* ===== Admin tier codes ===== */
const TIER_CODES = {
  Admin:"A-231-GATE", MasterAdmin:"M-Q8/-CROWN", Overseer:"OVR-442-SIGHT", Controller:"CTRL-993-AXIS",
  Custodian:"CUST-118-KEEP", Guardian:"GUARD-775-SHIELD", Sentinel:"SENT-560-WATCH", Supervisor:"SUP-823-LINE",
  Coordinator:"COORD-237-NODE", Director:"DIR-901-ARC", Chancellor:"CHANC-314-SEAL", Prefect:"PREF-628-ORDER",
  Warden:"WARD-452-GATE", Marshal:"MAR-739-BANNER", Commander:"COMM-888-LEGION", Principal:"PRINC-505-LEDGER",
  Chief:"CHIEF-272-CREST", SovereignAdmin:"SOV-999-CROWN", LegacyAdmin:"LEG-777-ARCHIVE"
};
const HIDDEN_CODE = "X-719-BOX";

let ceremonyName = "";
let superSequence = []; // ritual grid input record
let tapLog = [];        // ritual grid feedback map

/* ===== Admin bindings ===== */
document.getElementById('adminGenNameBtn')?.addEventListener('click', () => {
  const tier = document.getElementById('adminTier').value || 'Admin';
  const generated = generateAdminSpecializedName(tier);
  ceremonyName = generated;
  document.getElementById('adminName').value = generated;
  const inRitual = document.getElementById('nameInRitual');
  if (inRitual) inRitual.textContent = generated;
});

function handleAdminAccess(isVerifyClick=false) {
  const tier = document.getElementById('adminTier').value;
  const code = (document.getElementById('adminCode').value || '').trim();
  const name = ceremonyName || document.getElementById('adminName').value.trim();
  const phone = document.getElementById('adminPhone')?.value.trim() || '';
  const status = document.getElementById('verifyStatus');
  const expectedCode = TIER_CODES[tier];

  if (!expectedCode) { if (status) status.textContent = "X Unknown tier selected."; return false; }
  if (code !== expectedCode && !(tier === "Admin" || tier === "MasterAdmin")) {
    if (status) status.textContent = `X Invalid clearance code for ${tier}.`; return false;
  }

  if (tier === "Admin" || tier === "MasterAdmin") {
    if (isVerifyClick) {
      if (status) status.textContent = " Clearance accepted. Unlocking ritual sequence...";
      ['colorPanel','superCodePanel','puzzleBoxPanel','finalClearancePanel','mysteryBoxPanel','finalBranchPanel'].forEach(hidePanel);
      showPanel('colorPanel');
      buildRitualGrid();
    } else {
      if (status) status.textContent = "Use Verify button for Admin/MasterAdmin.";
    }
    return false;
  }

  // Non-Admin tiers -> Blogger route (generate card + access code, store locally, send access code to Blogger)
  const card = generateCardID();
  const accessCode = generateAccessCode();
  const clearanceCode = expectedCode; // stored locally

  const messageForBlogger = `🔐 Admin Access Submission
👤 Name: ${name}
📞 Phone: ${phone || '—'}
🎖 Tier: ${tier}
🆔 Account ID: ${card}
🔑 Access Code: ${accessCode}`.trim();

  const plaqueMessage = `🔐 Admin Access Submission
👤 Name: ${name}
📞 Phone: ${phone || '—'}
🎖 Tier: ${tier}
🆔 Account ID: ${card}`.trim(); // plaque excludes access code

  const redirectURL = `https://mrhim00.blogspot.com/2025/10/issued.html?card=${encodeURIComponent(card)}`;

  submitToBlogger({
    name, phone,
    messageForBlogger, plaqueMessage,
    clearanceCode, accessCode, redirectURL
  });

  alert("Admin form submitted. Redirecting...");
  return false;
}
document.getElementById('adminForm')?.addEventListener('submit', (e)=>{ e.preventDefault(); handleAdminAccess(false); });
document.querySelector('#adminForm #verifyTierBtn')?.addEventListener('click', ()=>handleAdminAccess(true));
document.getElementById('adminCode')?.addEventListener('input', ()=>{
  const tierSel = document.getElementById('adminTier').value;
  const code = document.getElementById('adminCode').value.trim();
  const verifyBtn = document.querySelector('#adminForm #verifyTierBtn');
  if (!verifyBtn) return;
  if ((tierSel === 'Admin' && code === TIER_CODES.Admin) || (tierSel === 'MasterAdmin' && code === TIER_CODES.MasterAdmin)) {
    verifyBtn.style.display = 'block';
  } else verifyBtn.style.display = 'none';
});

/* ===== Ritual Grid (Color Sequence) ===== */
let requiredSequence = [];
function buildRitualGrid(){
  const panel = document.getElementById('panelButtons'); if(!panel) return;
  panel.innerHTML = "";
  const colors  = ["red","blue","green","mustard","violet","cyan","deepred","emerald","deepviolet"];
  const glyphs  = ["⟟","Ϟ","⟁","⧖","ᚠ","ζ","₣","⟊","⚚","♛","⧫"];
  const numbers = ["231","85/","V2ζ","₣2","77X","9Ø","31Δ","8.98","27$","719"];

  requiredSequence = shuffleArray(colors).slice(0,4);
  superSequence = []; tapLog = [];
  renderSequence(); updateIndicators();

  colors.forEach(c=>{
    const btn = document.createElement('button');
    btn.type = "button";
    btn.className = "rune-btn " + c;
    const sigil = glyphs[Math.floor(Math.random()*glyphs.length)];
    const num   = numbers[Math.floor(Math.random()*numbers.length)];
    btn.innerHTML = `<span class="sigil">${sigil}</span><small>${num}</small>`;
    btn.addEventListener('click', ()=>handleRitualTap(c, btn));
    panel.appendChild(btn);
  });

  const ritualVerify = document.querySelector('#colorPanel .ritual-controls button:nth-child(1)');
  const ritualClear  = document.querySelector('#colorPanel .ritual-controls button:nth-child(2)');
  if (ritualVerify && !ritualVerify.dataset.wired) {
    ritualVerify.dataset.wired = '1';
    ritualVerify.addEventListener('click', verifySequenceAttempt);
  }
  if (ritualClear && !ritualClear.dataset.wired) {
    ritualClear.dataset.wired = '1';
    ritualClear.addEventListener('click', clearSequence);
  }
}

function handleRitualTap(color, btn){
  superSequence.push(color);
  tapLog.push({ color, btn });
  renderSequence();
  btn.classList.toggle('active');
  updateIndicators();
  btn.classList.add('glow');
  setTimeout(()=>btn.classList.remove('glow'),1200);
}

function renderSequence(){
  const sequenceReadout = document.getElementById('sequenceReadout'); if(!sequenceReadout) return;
  const text = superSequence.length ? superSequence.join('~') : '----';
  sequenceReadout.textContent = '';
  let i = 0;
  const interval = setInterval(() => {
    sequenceReadout.textContent += text[i] || '';
    i++;
    if (i >= text.length) clearInterval(interval);
  }, 40);
}

function updateIndicators() {
  const indicators = document.querySelectorAll('#indicatorLines span');
  indicators.forEach((bar, i) => {
    if (i < superSequence.length) bar.classList.add('active'); else bar.classList.remove('active');
  });
}

function verifySequenceAttempt(){
  const attemptColors = superSequence.slice(0,4);
  const attemptTaps   = tapLog.slice(0,4);
  const correct = arraysMatch(attemptColors, requiredSequence);

  const sequenceReadout = document.getElementById('sequenceReadout');
  if (correct) {
    sequenceReadout.textContent = "ACCESS GRANTED >> ACCESS PANEL";
    sequenceReadout.style.color = "#6aff6a";
    hidePanel('colorPanel');
    showPanel('superCodePanel'); // crown fade-in auto-triggers via patch

    const nameInPuzzle = document.getElementById('nameInPuzzle');
    const nameInRitual = document.getElementById('nameInRitual');
    if (nameInPuzzle && nameInRitual) nameInPuzzle.textContent = nameInRitual.textContent;
  } else {
    sequenceReadout.textContent = "ACCESS DENIED";
    sequenceReadout.style.color = "#ff4a4a";
  }

  attemptTaps.forEach(({ color, btn }, i) => {
    btn.classList.remove('after-correct','after-wrong');
    if (color === requiredSequence[i]) {
      btn.classList.add('after-correct');
      setTimeout(() => btn.classList.remove('after-correct'), 4000);
    } else {
      btn.classList.add('after-wrong');
      setTimeout(() => btn.classList.remove('after-wrong'), 1200);
    }
  });

  superSequence = [];
  tapLog = [];
  updateIndicators();
}

function clearSequence(){
  superSequence = [];
  tapLog = [];
  renderSequence();
  document.querySelectorAll('#panelButtons .rune-btn').forEach(btn => {
    btn.classList.remove('active','after-correct','after-wrong','glow');
  });
  updateIndicators();
}

/* ===== Patch showPanel to animate crown when superCodePanel is shown ===== */
if (typeof window.showPanel === 'function' && !window.showPanel.__patchedForCrown) {
  const originalShowPanel = window.showPanel;
  window.showPanel = function(id){
    originalShowPanel.call(this, id);
    if (id === 'superCodePanel') {
      const crown = document.querySelector('#superCodePanel .access-crown');
      if (crown) {
        crown.classList.remove('fade-in');
        void crown.offsetWidth;
        crown.classList.add('fade-in');
      }
    }
  };
  window.showPanel.__patchedForCrown = true;
}

/* ===== Super Code Panel -> Mystery Box ===== */
document.getElementById('accessConfirmBtn')?.addEventListener('click', () => {
  const v = document.getElementById('accessCodeInput').value.trim().toUpperCase();
  const s = document.getElementById('accessCodeStatus');
  if (v === HIDDEN_CODE) {
    if (s) s.textContent = 'Code accepted. Proceeding to Mystery Box...';
    setTimeout(() => { hidePanel('superCodePanel'); showPanel('mysteryBoxChamber'); }, 600);
  } else {
    if (s) s.textContent = 'X Incorrect code.';
  }
});

/* ===== Mystery Box -> Puzzle Box entry ===== */
document.getElementById('attemptPuzzleBtn')?.addEventListener('click', () => {
  hidePanel('mysteryBoxChamber');
  showPanel('puzzleBoxPanel');
  initPuzzleBox();
});

/* ====== Minigames consolidated and hardened ====== */

/* ===== Restored Puzzle Box — compatible with original layout ===== */

/* Shared state (single canonical copy) */
let puzzleInitDone = false;
let cubeUnlocked = false;
let keys = { L:false, D:false, W:false, M:false, S:false, N:false };

/* short element lookup */
const $ = id => document.getElementById(id);

/* Mobile shrink/notice (keeps original UX) */
function showPuzzleNotice(){
  const notice = $('puzzleNotice');
  if (!notice) return;
  if (window.innerWidth <= 768) {
    notice.classList.add('show');
    setTimeout(()=> notice.classList.remove('show'), 6000);
  }
}
function shrinkPuzzleBox(){
  const shell = $('puzzleBoxPanel') || $('imgVoidPuzzle');
  if (shell && window.innerWidth <= 768) { shell.classList.add('shrunk'); showPuzzleNotice(); }
}
function restorePuzzleBox(){
  const shell = $('puzzleBoxPanel') || $('imgVoidPuzzle');
  if (shell) shell.classList.remove('shrunk');
}

/* Cube pulse + unlock (keeps original behaviour) */
function pulseCube(){
  const cube = $('labyrinthCube');
  if (!cube) return;
  cube.style.boxShadow = "0 0 40px rgba(0,245,181,0.6)";
  setTimeout(()=>{ if (cube) cube.style.boxShadow = "none"; }, 900);
}
function checkCubeUnlock(){
  if (Object.values(keys).every(v => v) && !cubeUnlocked){
    cubeUnlocked = true;
    const msg = $('unlockMessage'); if (msg) msg.style.display = 'block';
    const sigil = $('hiddenSigil'); if (sigil) sigil.style.display = 'block';
    const voidEl = $('imgVoidPuzzle'); if (voidEl) voidEl.classList.add('unlocked');
    pulseCube();

    // mirror original timing: fade then navigate
    setTimeout(()=>{ if(sigil) sigil.classList.add('fadeOut'); const cube = $('labyrinthCube'); if(cube) cube.classList.add('fadeOut'); }, 30000);
    setTimeout(() => {
  hidePanel('puzzleBoxPanel');
  showPanel('finalBranchPanel');
  openFinalBranchSuspense(); // ← this is the correct placement

  const cube = $('labyrinthCube');
  if (cube) cube.classList.remove('fadeOut');
  if (sigil) {
    sigil.style.display = 'none';
    sigil.classList.remove('fadeOut');
  }
  const voidEl2 = $('imgVoidPuzzle');
  if (voidEl2) voidEl2.classList.remove('unlocked');
  restorePuzzleBox();
}, 60000);

  }
}

/* Reset visuals (original style) */
function resetPuzzleState(){
  keys = { L:false, D:false, W:false, M:false, S:false, N:false };
  cubeUnlocked = false;

  document.querySelectorAll('#lightsGrid .light-cell').forEach(c => { c.classList.remove('on'); c.style.background=''; c.style.boxShadow=''; });
  document.querySelectorAll('#labyrinthGrid .cell').forEach(c => c.classList.remove('on'));
  document.querySelectorAll('#memoryButtons .mem').forEach(btn => btn.classList.remove('flash'));
  ['runeL','runeD','runeW','runeM','runeS','runeN'].forEach(id => { const el = $(id); if(el) el.style.display = 'none'; });
  const msg = $('unlockMessage'); if (msg) msg.style.display = 'none';
  const dialEl = $('dial'); if(dialEl) { try { dialEl.value = 0; } catch(e){} }
}

/* Idempotent wiring helper to avoid duplicate listeners */
function onceWire(el, key, fn){
  if (!el) return;
  if (el.dataset[key]) return;
  el.dataset[key] = "1";
  fn();
}

/* ===== The original, proven puzzle logic (restored) ===== */

function initPuzzleBox_originalLayout(){
  // If we've wired once already just reset state and shrink -> same UX as original
  if (puzzleInitDone){
    resetPuzzleState();
    shrinkPuzzleBox();
    return;
  }

  /* ---------- Lights (original) ---------- */
  const lights = [...document.querySelectorAll('#lightsGrid .light-cell')];
  if (lights.length){
    // wire each cell once
    lights.forEach((cell, idx) => {
      onceWire(cell, 'lights', () => {
        cell.addEventListener('click', () => {
          // neighbor toggles using the static grid pattern used originally
          [idx, idx-1, idx+1, idx-3, idx+3].forEach(i => { if (lights[i]) lights[i].classList.toggle('on'); });
          // solved condition uses "all on" like original
          if ([...lights].every(c => c.classList.contains('on'))){
            keys.L = true;
            const el = $('runeL'); if (el) el.style.display = 'block';
            pulseCube(); checkCubeUnlock();
          }
        });
      });
    });
  }

  /* ---------- Dial (original simple numeric check) ---------- */
  // Original layout used a numeric lower dial and instruction "Start at 3 (CW ... 75)" — restore simple check
  const dial = $('dial'); // numeric input or small dial element in your original layout
  if (dial) {
    onceWire(dial, 'dial', () => {
      // original behavior: start at 3 (CW), accepted when value becomes 3 (you can adapt)
      dial.addEventListener('input', (e) => {
        const v = parseInt(e.target.value, 10);
        if (!Number.isNaN(v) && v === 3) {
          if (!keys.D){
            keys.D = true;
            const el = $('runeD'); if (el) el.style.display = 'block';
            pulseCube(); checkCubeUnlock();
          }
        }
      });
      // also support change event for elements that emit 'change'
      dial.addEventListener('change', (e) => {
        const v = parseInt(e.target.value, 10);
        if (!Number.isNaN(v) && v === 3) {
          if (!keys.D){
            keys.D = true;
            const el = $('runeD'); if (el) el.style.display = 'block';
            pulseCube(); checkCubeUnlock();
          }
        }
      });
    });
  }

  /* ---------- Word Lock (original: "real") ---------- */
  const wordInput = $('wordInput');
  if (wordInput){
    onceWire(wordInput, 'word', () => {
      wordInput.addEventListener('change', (e) => {
        if ((e.target.value || '').trim().toLowerCase() === 'real'){
          if (!keys.W){
            keys.W = true;
            const el = $('runeW'); if (el) el.style.display = 'block';
            pulseCube(); checkCubeUnlock();
          }
        }
      });
    });
  }

  /* ---------- Labyrinth Path (original fixed path) ---------- */
  const labCells = [...document.querySelectorAll('#labyrinthGrid .cell')];
  if (labCells.length){
    // original working path used by you: [0,1,6,11,16,17,18,23,24]
    const path = [0,1,6,11,16,17,18,23,24];
    let progress = 0;
    labCells.forEach((cell, idx) => {
      onceWire(cell, 'lab', () => {
        cell.addEventListener('click', () => {
          if (idx === path[progress]) {
            cell.classList.add('on'); progress++;
            if (progress === path.length){
              keys.M = true;
              const el = $('runeM'); if (el) el.style.display = 'block';
              pulseCube(); checkCubeUnlock();
            }
          } else {
            labCells.forEach(c => c.classList.remove('on'));
            progress = 0;
          }
        });
      });
    });
  }

  /* ---------- Memory (Simon) simplified original) ---------- */
  const memBtns = [...document.querySelectorAll('#memoryButtons .mem')];
  const startBtn = $('startMemory');
  if (memBtns.length && startBtn){
    let memSeq = [], playerSeq = [], playing = false;
    const flash = (btn) => { btn.classList.add('flash'); setTimeout(()=>btn.classList.remove('flash'), 220); };

    const playSequence = () => {
      playing = true;
      let i = 0;
      const interval = setInterval(() => {
        const val = memSeq[i];
        const btn = document.querySelector(`.mem[data-val="${val}"]`);
        if (btn) flash(btn);
        i++;
        if (i >= memSeq.length) { clearInterval(interval); playing = false; playerSeq = []; }
      }, 420);
    };
    const nextRound = () => { memSeq.push(Math.floor(Math.random()*memBtns.length)); playSequence(); };

    onceWire(startBtn, 'startMem', () => {
      startBtn.addEventListener('click', () => { memSeq = []; playerSeq = []; nextRound(); });
    });

    memBtns.forEach(btn => {
      onceWire(btn, 'memBtn', () => {
        btn.addEventListener('click', () => {
          if (playing || memSeq.length === 0) return;
          const val = parseInt(btn.dataset.val, 10);
          playerSeq.push(val); flash(btn);
          // prefix check
          for (let i=0;i<playerSeq.length;i++){
            if (playerSeq[i] !== memSeq[i]) { playerSeq = []; playSequence(); return; }
          }
          if (playerSeq.length === memSeq.length){
            if (memSeq.length >= 4){
              keys.S = true;
              const el = $('runeS'); if(el) el.style.display = 'block';
              pulseCube(); checkCubeUnlock();
            } else nextRound();
          }
        });
      });
    });
  }

  /* ---------- Math (original target 15) ---------- */
  const mathNums = [...document.querySelectorAll('#mathGrid .num')];
  if (mathNums.length){
    let sel = [];
    mathNums.forEach(btn => {
      onceWire(btn, 'math', () => {
        btn.addEventListener('click', () => {
          btn.classList.toggle('sel');
          const val = parseInt(btn.textContent.trim(), 10);
          if (btn.classList.contains('sel')) sel.push(val); else sel = sel.filter(v => v !== val);
          const sum = sel.reduce((a,b)=>a+b, 0);
          if (sum === 15){
            if (!keys.N){
              keys.N = true;
              const el = $('runeN'); if(el) el.style.display = 'block';
              pulseCube(); checkCubeUnlock();
            }
          } else if (sum > 15) {
            mathNums.forEach(n => n.classList.remove('sel'));
            sel = [];
          }
        });
      });
    });
  }

  /* Finalize wiring state and reset visuals per original flow */
  puzzleInitDone = true;
  resetPuzzleState();
  shrinkPuzzleBox();
}
window.addEventListener("message", (event) => {
  if (event.data === "cubeSolved") {
    document.getElementById('puzzleFrame').style.display = 'none';
    hidePanel('puzzleBoxPanel');

    // Show ceremonial void relay
    showPanel('voidRelayPanel');
    document.getElementById('voidMessageArea').innerHTML = `
      <p>✨ You’ve unlocked the Labyrinth Cube.</p>
      <p><a href="https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh7Xr0yArKKpo2gvFLpUcm9fMR5CgbrkBYTEChDOnIM59NhDxBVFHChMPQQzeVXKnIsS7FOxP4witstDDBjLciMAM1Tq0g_bM86dXGYMLHYms0KiFJniK_gJS0PjbxhgAE1DhdLHvwpD_Id-B2mtbW7SqgWDX72S05uifuP-Ag_XQQMqJGBBNvzV88OjYc/s1600/An%20abstract%20Masterad.png class="void-link">Proceed to Final Branch</a></p>
    `;
  }
});

/* Expose init for quick test */
window.initPuzzleBox = initPuzzleBox_originalLayout;

  
  
  
  
  
  
  
  
/* DOM-ready guard: attach the "Attempt Puzzle" button and ensure init when panel opens */
document.addEventListener('DOMContentLoaded', () => {
  // attemptPuzzleBtn should show puzzle box panel and call init
  const attemptBtn = $('attemptPuzzleBtn');
  if (attemptBtn) onceWire(attemptBtn, 'attemptPuzzle', () => {
    attemptBtn.addEventListener('click', () => {
      hidePanel('mysteryBoxChamber'); showPanel('puzzleBoxPanel'); initPuzzleBox_originalLayout();
    });
  });

  // if panel is already visible on load, init right away
  const pb = $('puzzleBoxPanel');
  if (pb && pb.style.display === 'block') initPuzzleBox_originalLayout();
});


/* Final branch -> Final clearance -> Superform */
// Final branch -> Final clearance -> Superform (clean, static-access-code, ready to paste)
document.getElementById('toFinalClearanceBtn')?.addEventListener('click', () => {
  hidePanel('finalBranchPanel'); showPanel('finalClearancePanel');
});

document.getElementById('finalClearanceBtn')?.addEventListener('click', () => {
  const code = (document.getElementById('finalClearanceCode')?.value || '').trim();
  const revealed = (document.getElementById('revealedPassword')?.textContent || '').trim();
  const status = document.getElementById('finalClearanceStatus');
  if (code && revealed && code === revealed) {
    if (status) status.textContent = " Clearance accepted. Superform unlocked.";
    setTimeout(() => {
      hidePanel('finalClearancePanel');
      showPanel('mysteryBoxPanel');
      const sn = document.getElementById('superName');
      if (sn) sn.value = ceremonyName || '';
    }, 800);
  } else if (status) {
    status.textContent = "X Incorrect code.";
  }
});

(function finalBranchOneTimeCode() {
  const KEY = 'prestige_one_time';
  const SHOW_MS = 4200;
  const FADE_MS = 620;

  const finalPanel = document.getElementById('finalClearancePanel');
  if (!finalPanel) return;

  // Elements (may be injected elsewhere in your markup)
  let genBtn = document.getElementById('generateTierCodeBtn');
  let tierSel = document.getElementById('finalTier');
  let display = document.getElementById('oneTimeCode');
  const superCodeEl = document.getElementById('superCode'); // optional: Superform placeholder target
  const superForm = document.getElementById('superLevelForm');
  const status = document.getElementById('finalClearanceStatus') || document.getElementById('superFormStatus');

  // Ensure a single hidden canonical revealedPassword exists
  const revealedPasswordEl = document.getElementById('revealedPassword') || (function () {
    const el = document.createElement('div');
    el.id = 'revealedPassword';
    el.style.display = 'none';
    document.body.appendChild(el);
    return el;
  })();

  // Ensure UI exists inside finalClearancePanel (only create if missing)
  (function ensureUI() {
    const body = finalPanel.querySelector('.trophy-body') || finalPanel;
    if (!document.getElementById('finalTier') || !document.getElementById('generateTierCodeBtn') || !document.getElementById('oneTimeCode')) {
      const existing = body.querySelector('.oneTimeCodeWrap');
      if (existing) return;
      const wrap = document.createElement('div');
      wrap.className = 'oneTimeCodeWrap';
      wrap.innerHTML = `
        <label for="finalTier" class="trophy-label" style="display:block;margin-top:8px;color:var(--gold)">Choose one-time tier</label>
        <select id="finalTier" aria-label="Choose tier for one-time code" class="tier-select">
          <option value="">-- pick tier --</option>
          <option value="Legacy">Legacy</option>
          <option value="Luminary">Luminary</option>
          <option value="Sovereign">Sovereign</option>
          <option value="Ascendant">Ascendant</option>
          <option value="Founders">Founders</option>
          <option value="Eternal">Eternal</option>
          <option value="Prime">Prime</option>
          <option value="Dominion">Dominion</option>
        </select>
        <div style="height:8px"></div>
        <button id="generateTierCodeBtn" type="button" class="gen-btn">Generate One-Time Code</button>
        <div id="oneTimeCode" class="oneTimeCode" role="status" aria-hidden="true" style="margin-top:12px"></div>
      `;
      body.appendChild(wrap);

      // rebind references
      genBtn = document.getElementById('generateTierCodeBtn');
      tierSel = document.getElementById('finalTier');
      display = document.getElementById('oneTimeCode');
    }
  })();

  // Static lookup: return the static access code from SUPER_REGISTRY or fallback map
  function makeOneTimeCode(tier) {
    if (!tier) return '';
    if (window.SUPER_REGISTRY && window.SUPER_REGISTRY[tier] && window.SUPER_REGISTRY[tier].accessCode) {
      return String(window.SUPER_REGISTRY[tier].accessCode).trim();
    }
    const FALLBACK = {
      Legacy: "LEGACY-444",
      Luminary: "LUMINARY-333",
      Sovereign: "SOVEREIGN-222",
      Ascendant: "ASCEND-111",
      Founders: "FOUNDERS-999",
      Eternal: "ETERNAL-888",
      Prime: "PRIME-777",
      Dominion: "DOMINION-000"
    };
    return FALLBACK[tier] || '';
  }

  // Canonical reveal + store: mirrors to revealedPassword and updates placeholder (non-destructive)
  function revealAndStore(code) {
    try { sessionStorage.setItem(KEY, code); } catch (e) { /* ignore */ }
    if (!display) return;

    // canonical mirror
    if (revealedPasswordEl) revealedPasswordEl.textContent = code;
    const finalClearInput = document.getElementById('finalClearanceCode');
    if (finalClearInput) finalClearInput.placeholder = code; // non-destructive: shows code as placeholder

    // show plaque
    display.textContent = code;
    display.setAttribute('aria-hidden', 'false');
    display.classList.remove('fading');
    void display.offsetWidth;
    display.classList.add('visible');

    // pulse animation
    try {
      display.animate(
        [{ transform: 'scale(0.98) translateY(6px)', opacity: 0 }, { transform: 'scale(1.02) translateY(-8px)', opacity: 1 }, { transform: 'scale(1) translateY(0)', opacity: 1 }],
        { duration: 520, easing: 'cubic-bezier(.2,.9,.2,1)' }
      );
    } catch (e) { /* ignore */ }

    // fade out and clear text after timers
    setTimeout(() => {
      if (!display) return;
      display.classList.remove('visible');
      display.classList.add('fading');
      display.setAttribute('aria-hidden', 'true');
      setTimeout(() => { if (display) display.textContent = ''; }, FADE_MS + 40);
    }, SHOW_MS);
  }

  // Wire generator button (idempotent)
  if (genBtn && !genBtn.dataset.wired) {
    genBtn.dataset.wired = '1';
    genBtn.addEventListener('click', function () {
      const tier = (tierSel?.value || '').trim();
      if (!tier) {
        tierSel?.classList.add('need-choice');
        setTimeout(() => tierSel?.classList.remove('need-choice'), 700);
        return;
      }
      const code = makeOneTimeCode(tier);
      if (superCodeEl) superCodeEl.placeholder = code; // mirror to Superform placeholder
      revealAndStore(code);
      if (status) status.textContent = `One-time code revealed for ${tier}. It will expire shortly.`;
      setTimeout(() => { if (status) status.textContent = ''; }, SHOW_MS + FADE_MS + 80);
    });
  }

  // subtle fade animation for selector + generate control when tier changes (idempotent)
  if (tierSel && genBtn && !tierSel.dataset.fadeWire) {
    tierSel.dataset.fadeWire = '1';
    tierSel.addEventListener('change', () => {
      tierSel.classList.add('fade-in-easy');
      genBtn.classList.add('fade-in-easy');
      setTimeout(() => { tierSel.classList.remove('fade-in-easy'); genBtn.classList.remove('fade-in-easy'); }, 700);
    });
  }

  // Observe plaque visibility to trigger pulse if class toggled externally (defensive)
  (function observePlaque() {
    const plaque = document.getElementById('oneTimeCode');
    if (!plaque || plaque.__observed) return;
    plaque.__observed = true;
    const obs = new MutationObserver(muts => {
      muts.forEach(m => {
        if (m.type === 'attributes' && m.attributeName === 'class') {
          if (m.target.classList.contains('visible')) {
            try {
              plaque.animate(
                [{ transform: 'scale(0.98) translateY(6px)', opacity: 0 }, { transform: 'scale(1.02) translateY(-8px)', opacity: 1 }, { transform: 'scale(1) translateY(0)', opacity: 1 }],
                { duration: 520, easing: 'cubic-bezier(.2,.9,.2,1)' }
              );
            } catch (e) { /* ignore */ }
          }
        }
      });
    });
    obs.observe(plaque, { attributes: true });
  })();

  // Superform submit validation: ensure revealed code (static) matches submitted value
  if (superForm && !superForm.dataset.oneTimeWired) {
    superForm.dataset.oneTimeWired = '1';
    superForm.addEventListener('submit', function (ev) {
      ev.preventDefault();
      const submitted = (document.getElementById('superCode')?.value || '').trim();
      let stored = null;
      try { stored = sessionStorage.getItem(KEY); } catch (e) { stored = null; }
      const statusEl = document.getElementById('finalClearanceStatus') || document.getElementById('superFormStatus') || document.getElementById('superStatus');

      if (!stored) {
        if (statusEl) statusEl.textContent = 'No active one-time code. Generate one from Final Branch.';
        return false;
      }
      if (stored !== submitted) {
        if (statusEl) statusEl.textContent = 'Incorrect one-time code. Please enter the revealed code.';
        return false;
      }

      try { sessionStorage.removeItem(KEY); } catch (e) { /* ignore */ }
      if (statusEl) statusEl.textContent = ' One-time code accepted. Submitting...';

      if (typeof submitSuperForm === 'function') {
        submitSuperForm();
      } else {
        try { superForm.removeEventListener('submit', arguments.callee); } catch (e) { /* ignore */ }
        superForm.submit();
      }
      return false;
    }, { passive: false });
  }

  // Heading animation integration (idempotent)
  (function finalClearanceVisuals() {
    const panel = document.getElementById('finalClearancePanel');
    if (!panel) return;
    function showFinalTrophy() {
      const card = panel.querySelector('.trophy-card');
      if (!card) return;
      card.classList.remove('active');
      setTimeout(() => card.classList.add('active'), 80);
    }
    if (typeof showPanel === 'function' && !showPanel.__patchedForFinal) {
      const originalShow = showPanel;
      showPanel = function (id) {
        originalShow.call(this, id);
        if (id === 'finalClearancePanel') showFinalTrophy();
      };
      showPanel.__patchedForFinal = true;
    } else if (panel.style.display === 'block') {
      showFinalTrophy();
    }
  })();

})();


/* Superform submit (unified) */
/* ===== Superform wiring (idempotent) ===== */
(function wireSuperform(){
  const tierSel = el("superTier");
  const codeInput = el("superCode");
  const genBtn = el("genSuperNameBtn");
  const nameField = el("superName");
  const statusEl = el("superStatus");
  const form = el("superLevelForm");
const phoneField = el("superPhone") || el("phone") || null;

if (!genBtn || !tierSel || !codeInput || !nameField) return;
  if (genBtn.dataset.wired === "1") return;
  genBtn.dataset.wired = "1";

  function updateStatus(msg, cls){
    if (!statusEl) return;
    statusEl.textContent = msg;
    statusEl.className = cls || '';
  }

  function toggleGenButton(){
    const tier = (tierSel.value || '').trim();
    const code = (codeInput.value || '').trim();
    if (!tier) { genBtn.disabled = true; updateStatus(" Select your tier.","info"); return; }
    const pool = SUPER_REGISTRY[tier];
    if (!pool) { genBtn.disabled = true; updateStatus("X Unknown tier selected.","error"); return; }
    if (code === pool.accessCode) { genBtn.disabled = false; updateStatus(`  Code accepted for ${tier}. Generator ready.`, "success"); }
    else { genBtn.disabled = true; if (code.length) updateStatus("X Invalid code for selected tier.","error"); else updateStatus("Enter clearance code to enable generator.","info"); }
  }

  tierSel.addEventListener("change", toggleGenButton);
  codeInput.addEventListener("input", toggleGenButton);

  genBtn.addEventListener("click", function(){
    const tier = (tierSel.value || '').trim();
    const code = (codeInput.value || '').trim();
    const result = generateSuperLevelNameFromRegistry(tier, code);
    nameField.value = result;
    updateStatus(result && !result.startsWith("Invalid") ? `  Name generated for ${tier}.` : result, result.startsWith("Invalid") ? "error" : "success");
  });

  if (form && !form.dataset.wired) {
    form.dataset.wired = "1";
    form.addEventListener("submit", function(ev){
      ev.preventDefault();
      const tier = (tierSel.value || '').trim();
      const code = (codeInput.value || '').trim();
      if (!tier || !code) { updateStatus("X Select tier and enter code before submitting.","error"); return false; }
      const pool = SUPER_REGISTRY[tier];
      if (!pool || pool.accessCode !== code) { updateStatus("X Invalid clearance code for selected tier.","error"); return false; }

      const name = (nameField.value || '').trim();
      if (!name) { updateStatus("X Generate a ceremonial name first.","error"); return false; }

      const phone = (phoneField && (phoneField.value || '').trim()) || ""; // normalized phone

      const card = generateCardID();
      const access = generateAccessCode();

      const messageForBlogger = [
        "👑 Super-Level Access Submission",
        `Name: ${name}`,
        `Phone: ${phone}`,
        `Tier: ${tier}`,
        `Account ID: ${card}`,
        `Access Code: ${access}`
      ].join("\n");

      const plaqueMessage = [
        "👑 Super-Level Access Submission",
        `Name: ${name}`,
        `Phone: ${phone}`,
        `Tier: ${tier}`,
        `Account ID: ${card}`
      ].join("\n");

      submitToBlogger({
        name: name,
        phone: phone,
        messageForBlogger,
        plaqueMessage,
        clearanceCode: code,
        accessCode: access,
        redirectURL: `https://mrhim00.blogspot.com/2025/10/issued.html?card=${encodeURIComponent(card)}`
      });

      updateStatus("  Super-level form submitted. Redirecting...", "success");
      return false;
    }, { passive:false });
  }

  // initial toggle
  toggleGenButton();
})();
/* Cube rotation (binding) */

    // Interactive rotation for the Labyrinth Cube
    const cubeEl = document.getElementById('labyrinthCube');
    let dragging = false, startX = 0, startY = 0, rotX = -15, rotY = 20;
    function updateRotation() { cubeEl.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg)`; }
    cubeEl.addEventListener('mousedown', e => { dragging = true; startX = e.clientX; startY = e.clientY; });
    window.addEventListener('mousemove', e => {
      if (!dragging) return;
      const dx = e.clientX - startX, dy = e.clientY - startY;
      startX = e.clientX; startY = e.clientY;
      rotY += dx * 0.4; rotX -= dy * 0.4; updateRotation();
    });
    window.addEventListener('mouseup', () => dragging = false);
    cubeEl.addEventListener('touchstart', e => { dragging = true; startX = e.touches[0].clientX; startY = e.touches[0].clientY; }, { passive: true });
    cubeEl.addEventListener('touchmove', e => {
      if (!dragging) return;
      const dx = e.touches[0].clientX - startX, dy = e.touches[0].clientY - startY;
      startX = e.touches[0].clientX; startY = e.touches[0].clientY;
      rotY += dx * 0.4; rotX -= dy * 0.4; updateRotation();
    }, { passive: true });
    cubeEl.addEventListener('touchend', () => dragging = false);
    updateRotation();
  
  
/* Keyboard shortcuts */
document.addEventListener("keydown", function (e) {
  if (e.ctrlKey && e.altKey && e.key.toLowerCase() === "q") {
    const superPanel = document.getElementById("mysteryBoxPanel");
    if (superPanel) { superPanel.style.display = "block"; alert("Super-level access form unlocked."); }
  }
  if (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 'a') {
    const f=document.getElementById('adminForm'); if(f){ f.style.display='block'; alert("Admin access form unlocked."); }
  }
});

/* Public form: generator hook */
document.getElementById('love-form')?.addEventListener('click', (e)=>{
  if (e.target && e.target.id === 'genNameBtn') generateNameFromTier();
});

/* Ensure ritual controls are wired on pageshow (bfcache restores) */
window.addEventListener('pageshow', ()=>{
  const colorPanel = document.getElementById('colorPanel');
  if (!colorPanel) return;
  const verifyBtn = colorPanel.querySelector('.ritual-controls button:nth-child(1)');
  const clearBtn  = colorPanel.querySelector('.ritual-controls button:nth-child(2)');
  if (verifyBtn && !verifyBtn.dataset.wired) { verifyBtn.dataset.wired = '1'; verifyBtn.addEventListener('click', verifySequenceAttempt); }
  if (clearBtn && !clearBtn.dataset.wired) { clearBtn.dataset.wired = '1'; clearBtn.addEventListener('click', clearSequence); }
});

/* Small convenience: wire initial admin tap zones if present */
(function bindAdminVisibilityShortcuts(){
  const adminForm = document.getElementById('adminForm');
  const zoneRight = document.getElementById('tapTopRight');
  if (zoneRight && adminForm) zoneRight.addEventListener('click', ()=> { adminForm.style.display = 'block'; });
})();

/* End of merged script */
  
  // ===== Unified form hook: route every form to the single canonical love-form + hidden iframe =====
(function unifyFormsToLoveForm(){
  // Ids used by canonical flow
  const CANONICAL_FORM_ID = 'loveform';         // visible canonical form id (public)
  const HIDDEN_FORM_ID    = 'hiddenBloggerForm'; // hidden blogger form (posted to Blogger) - preferred
  const HIDDEN_IFRAME     = 'hidden_iframe';     // iframe target name

  // Guarantee the hidden iframe exists (create if missing)
  function ensureHiddenIframe(){
    if (!document.querySelector(`iframe[name="${HIDDEN_IFRAME}"]`)) {
      const iframe = document.createElement('iframe');
      iframe.name = HIDDEN_IFRAME;
      iframe.style.display = 'none';
      document.body.appendChild(iframe);
    }
  }

  // Guarantee the canonical hidden blogger form exists (create minimal copy if missing)
  function ensureHiddenBloggerForm(){
    let hf = document.getElementById(HIDDEN_FORM_ID);
    if (hf) return hf;
    hf = document.createElement('form');
    hf.id = HIDDEN_FORM_ID;
    hf.method = 'POST';
    hf.action = 'https://www.blogger.com/contact-form.do';
    hf.target = HIDDEN_IFRAME;
    hf.style.display = 'none';
    // recommended fields used by submitToBlogger: hbName, hbPhone, hbMessage, hbEmail
    hf.innerHTML = [
      '<input id="hbName" name="name" type="text" value="">',
      '<input id="hbPhone" name="phone" type="tel" value="">',
      '<textarea id="hbMessage" name="message"></textarea>',
      '<input id="hbEmail" name="email" type="email" value="">',
      '<button type="submit">send</button>'
    ].join('');
    document.body.appendChild(hf);
    return hf;
  }

  // Single-submit guard: prevent double submission inside short window
  let lastSubmitAt = 0;
  function canSubmitNow(){
    const now = Date.now();
    if (now - lastSubmitAt < 1500) return false;
    lastSubmitAt = now;
    return true;
  }

  // Normalize a form so that its submit routes through submitToBlogger and the hidden form
  function routeFormToCanonical(form){
    if (!form || form.dataset.unified) return;
    form.dataset.unified = '1';

    // Intercept submit event
    form.addEventListener('submit', function (e){
      e.preventDefault();
      if (!canSubmitNow()) return;

      // Build canonical payload from common fields (best-effort)
      const name = (form.querySelector('[name="name"]')?.value || form.querySelector('#name')?.value || '').trim();
      const phone = (form.querySelector('[name="phone"]')?.value || form.querySelector('#phone')?.value || '').trim();
      const role = (form.querySelector('[name="role"]')?.value || form.querySelector('#role')?.value || '').trim();
      const messageField = form.querySelector('[name="message"]') || form.querySelector('#message');
      const rawMessage = (messageField?.value || '').trim();

      // If the page or form has a generator for IDs/codes, reuse them; otherwise generate
      const card = (form.querySelector('[name="accountId"]')?.value) || (window.generateCardID ? generateCardID() : ('CARD-'+Math.random().toString(36).slice(2,10).toUpperCase()));
      const access = (window.generateAccessCode ? generateAccessCode() : ('ACCESS-'+Math.floor(100000+Math.random()*900000)));

      // Compose a clear message (keeps access code out of plaque)
      const messageForBlogger = rawMessage || [
        '🪔 Prestige Triumph Verification',
        `👤 Name: ${name}`,
        `📞 Phone: ${phone}`,
        `🎖 Tier: ${role}`,
        `🆔 Account ID: ${card}`,
        `🔑 Access Code: ${access}`
      ].filter(Boolean).join('\n');

      const plaqueMessage = [
        '🪔 Prestige Triumph Verification',
        `👤 Name: ${name}`,
        `🎖 Tier: ${role}`,
        `🆔 Account ID: ${card}`
      ].filter(Boolean).join('\n');

      // Ensure hidden pieces are present
      ensureHiddenIframe();
      ensureHiddenBloggerForm();

      // Use your existing submitToBlogger helper if present, otherwise fill hidden form and submit
      if (typeof submitToBlogger === 'function') {
        submitToBlogger({
          name: name || 'Anonymous',
          phone,
          messageForBlogger,
          plaqueMessage,
          accessCode: access,
          redirectURL: (form.dataset.redirect || '')
        });
        return;
      }

      // Fallback manual fill/submit of hidden form
      const hf = document.getElementById(HIDDEN_FORM_ID);
      if (hf) {
        hf.querySelector('#hbName').value = name || '';
        hf.querySelector('#hbPhone').value = phone || '';
        hf.querySelector('#hbMessage').value = messageForBlogger || plaqueMessage || '';
        hf.querySelector('#hbEmail').value = (form.dataset.email || 'prestige@triumph.org');
        try { hf.requestSubmit ? hf.requestSubmit() : hf.submit(); } catch (err) { hf.submit(); }
      }

      // Surface plaque in-page
      const plaque = document.getElementById('verificationPlaque');
      const vText = document.getElementById('verificationText');
      if (plaque && vText) { vText.value = plaqueMessage; plaque.style.display = 'block'; }

      // Optional redirect if provided on the original form via data-redirect
      const redirect = form.dataset.redirect;
      if (redirect) setTimeout(() => { try { window.location.href = redirect; } catch(e){} }, 1000);
    }, { passive: false });
  }

  // Wire all candidate forms: canonical love-form plus other visible forms
  function wireAllForms(){
    ensureHiddenIframe();
    ensureHiddenBloggerForm();

    // 1) The canonical visible form (love-form) — ensure it routes through same handler (idempotent)
    const canonical = document.getElementById(CANONICAL_FORM_ID);
    if (canonical) routeFormToCanonical(canonical);

    // 2) Any other forms that should also unify (give them data-unify attribute or auto-detect typical account forms)
    const candidates = Array.from(document.querySelectorAll('form')).filter(f => {
      if (f.id === CANONICAL_FORM_ID) return false;
      if (f.id === HIDDEN_FORM_ID) return false;
      if (f.target === HIDDEN_IFRAME) return false;
      // auto-detect by presence of name/phone/role fields, or explicit opt-in via data-unify
      if (f.dataset.unify === 'true') return true;
      const hasName = !!(f.querySelector('[name="name"]') || f.querySelector('#name'));
      const hasPhone = !!(f.querySelector('[name="phone"]') || f.querySelector('#phone'));
      const hasRole = !!(f.querySelector('[name="role"]') || f.querySelector('#role'));
      return (hasName && hasPhone) || (f.classList.contains('prestige-form'));
    });
    candidates.forEach(routeFormToCanonical);
  }

  // Run on DOM ready (if DOM already ready, run now)
  if (document.readyState === 'loading') document.addEventListener('DOMContentLoaded', wireAllForms); else wireAllForms();
})();

// mark existing form
const f = document.getElementById('superLevelForm');
if (f) f.dataset.unify = 'true';

// or create a form and mark it
const newForm = document.createElement('adminForm');
newForm.dataset.unify = 'true';
document.body.appendChild(newForm);

  // One-time placeholder reveal (uses existing SUPER_REGISTRY)
// Idempotent wiring: safe to paste into page once

(function oneTimeTierCodeFlow(){
  const KEY = 'prestige_one_time';     // sessionStorage key
  const SHOW_MS = 4200;                // visible time
  const FADE_MS = 620;                 // fade duration (matches CSS)

  // Elements (create UI if missing)
  const finalPanel = document.getElementById('finalBranchPanel');
  if (!finalPanel) return;

  if (!document.getElementById('oneTimeCode')) {
    const wrap = document.createElement('div');
    wrap.className = 'oneTimeCodeWrap';
    wrap.innerHTML = `
      <label for="finalTier" style="color:var(--gold);font-weight:600;display:block;margin-bottom:8px;">Choose one-time tier</label>
      <select id="finalTier" aria-label="Choose tier for one-time code" style="min-width:220px;padding:8px;border-radius:6px;background:rgba(255,255,255,0.03);color:#ffd87a;border:1px solid rgba(255,255,255,0.06);">
        <option value="">-- pick tier --</option>
        <option value="Legacy">Legacy</option>
        <option value="Luminary">Luminary</option>
        <option value="Sovereign">Sovereign</option>
        <option value="Ascendant">Ascendant</option>
        <option value="Founders">Founders</option>
        <option value="Eternal">Eternal</option>
        <option value="Prime">Prime</option>
        <option value="Dominion">Dominion</option>
      </select>
      <div style="height:10px;"></div>
      <button id="generateTierCodeBtn" type="button" style="padding:8px 12px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.06);color:#e9e3ff;backdrop-filter:blur(4px);cursor:pointer;">Generate One-Time Code</button>
      <div id="oneTimeCode" class="oneTimeCode" role="status" aria-hidden="true" style="margin-top:12px;"></div>
    `;
    finalPanel.appendChild(wrap);
  }

  const genBtn = document.getElementById('generateTierCodeBtn');
  const tierSel = document.getElementById('finalTier');
  const display = document.getElementById('oneTimeCode');
  const superCodeEl = document.getElementById('superCode'); // Superform clearance input
  const superFormStatus = document.getElementById('superFormStatus') || document.getElementById('superStatus');

  // helper: pick base access from SUPER_REGISTRY
  function baseAccessFor(tier){
    if (window.SUPER_REGISTRY && window.SUPER_REGISTRY[tier]) return window.SUPER_REGISTRY[tier].accessCode;
    return (tier || 'ONE-TIME').toUpperCase();
  }

  // Compose one-time display code (base + nonce). This is only a user-visible token.
  function makeOneTimeCode(tier){
    const base = baseAccessFor(tier);
    const nonce = Math.floor(100 + Math.random()*900); // 3-digit nonce
    return `${base}-${nonce}`;
  }

  // Show display element with fade in/out and save in sessionStorage (one value only)
  function revealAndStore(code){
    try { sessionStorage.setItem(KEY, code); } catch(e) { /* ignore storage errors */ }
    if (!display) return;
    display.textContent = code;
    display.setAttribute('aria-hidden','false');
    display.classList.remove('fading');
    void display.offsetWidth; // reflow
    display.classList.add('visible');

    // After SHOW_MS, fade out and clear text after FADE_MS
    setTimeout(()=>{
      if(!display) return;
      display.classList.remove('visible');
      display.classList.add('fading');
      display.setAttribute('aria-hidden','true');
      setTimeout(()=>{ if(display) display.textContent=''; }, FADE_MS + 40);
    }, SHOW_MS);
  }

  // idempotent handler attach
  if (genBtn && !genBtn.dataset.wired) {
    genBtn.dataset.wired = '1';
    genBtn.addEventListener('click', function(){
      const tier = (tierSel?.value || '').trim();
      if (!tier) {
        // flash the select to indicate choice required
        tierSel?.classList.add('need-choice');
        setTimeout(()=> tierSel?.classList.remove('need-choice'), 700);
        return;
      }
      const code = makeOneTimeCode(tier);

      // set placeholder in Superform input (preferred behavior)
      if (superCodeEl) {
        superCodeEl.placeholder = code;
        // optional: prefill for convenience — uncomment if you prefer
        // superCodeEl.value = code;
      }

      // show temp reveal in Final Branch and store token for validation
      revealAndStore(code);
      if (superFormStatus) superFormStatus.textContent = `One-time code revealed for ${tier}. It will expire shortly.`;
      // clear status after reveal fades
      setTimeout(()=>{ if(superFormStatus) superFormStatus.textContent = ''; }, SHOW_MS + FADE_MS + 60);
    });
  }

  // Superform submit validation: ensure revealed code matches submitted value
  // Attach idempotently to form's submit logic (if you already have a handler, integrate the check there)
  const superForm = document.getElementById('superLevelForm');
  if (superForm && !superForm.dataset.oneTimeWired) {
    superForm.dataset.oneTimeWired = '1';
    superForm.addEventListener('submit', function(ev){
      ev.preventDefault();
      const submitted = (document.getElementById('superCode')?.value || '').trim();
      const stored = (function(){ try { return sessionStorage.getItem(KEY); } catch(e){ return null; } })();

      if (!stored) {
        if (superFormStatus) superFormStatus.textContent = 'No active one-time code. Generate one from Final Branch.';
        return false;
      }
      if (stored !== submitted) {
        if (superFormStatus) superFormStatus.textContent = 'Incorrect one-time code. Please enter the revealed code.';
        return false;
      }

      // success: invalidate token immediately then proceed with existing submit flow
      try { sessionStorage.removeItem(KEY); } catch(e) { /* ignore */ }
      if (superFormStatus) superFormStatus.textContent = '✅ One-time code accepted. Submitting...';

      // proceed with your existing submission routine
      // if you use submitToBlogger, call it here; otherwise submit the form or call your existing handler
      // Example: call the existing submitSuperForm if defined, else submit normally
      if (typeof submitSuperForm === 'function') {
        // if submitSuperForm already prevents default and handles submission, call it
        submitSuperForm();
      } else {
        // remove dataset guard to avoid recursion if canonical handler also intercepts
        superForm.removeEventListener('submit', arguments.callee);
        superForm.submit();
      }
      return false;
    }, { passive:false });
  }

})();

    </script><script>
function openFinalBranchSuspense() {
  const panel = document.getElementById('finalBranchPanel');
  const hologram = document.getElementById('tierHologram');      // single-line hologram
  const mystery = document.getElementById('mysterySentence');    // singular ID
  const scriptEl = document.getElementById('finalBranchScript'); // boot script <pre>
  const proceedBtn = document.getElementById('toFinalClearanceBtn');

  if (!panel || !hologram || !mystery || !scriptEl || !proceedBtn) return;

  // Tier names (single-line hologram readout)
  const tiers = ["Legacy", "Luminary", "Sovereign", "Ascendant", "Founders", "Eternal", "Prime", "Dominion"];

  // Mystery sentences pool
  const mysterySentences = [
    "The path is chosen, yet unseen...",
    "Your ascension awaits beyond the veil...",
    "The crown glimmers in shadow...",
    "Only silence knows your tier...",
    "The gate pulses with hidden truth...",
    "Legacy whispers, Sovereign calls...",
    "The code is sealed in gold...",
    "Dominion stirs beneath the surface...",
    "The eternal flame flickers once more...",
    "Prime awaits the worthy traveler...",
    "The chamber breathes with unseen power...",
    "Luminary light fades into mystery...",
    "Founders echo through the void...",
    "Ascendant steps are carved in silence...",
    "The crest trembles before revelation...",
    "Your tier is written in starlight...",
    "The sigil hums with forgotten voices...",
    "The vault holds secrets untold...",
    "The horizon bends toward your fate...",
    "The sovereign path is veiled in mist...",
    "Shadows conceal the eternal flame...",
    "The prime seal waits unbroken...",
    "Legacy dust drifts across the chamber...",
    "The dominion crown is restless...",
    "The ascendant pulse beats faintly...",
    "The founders oath lingers in silence...",
    "The luminary spark hides in shadow...",
    "The eternal crest glows unseen...",
    "The sovereign gate resists the light...",
    "The prime path coils in secrecy...",
    "The chamber hums with unseen resonance...",
    "Your ascension is whispered, not spoken...",
    "The sigil flickers, then fades...",
    "The crown shadow stretches across the void...",
    "The eternal flame hides its spark...",
    "The dominion seal trembles faintly...",
    "Legacy's echo fades into silence...",
    "The luminary crest shimmers unseen...",
    "The sovereign oath is half-spoken...",
    "The ascendant path is veiled in mist...",
    "The founders’ flame flickers once...",
    "The prime crest hums in secrecy...",
    "The eternal gate resists the dawn...",
    "The dominion crown glows faintly...",
    "Legacy whispers through the chamber walls...",
    "The luminary spark pulses unseen...",
    "The sovereign crest hides its glow...",
    "The ascendant oath trembles in silence...",
    "The founders’ path is sealed in shadow..."
  ];

  // Boot script lines
  const scriptLines = [
    "Initializing FINAL BRANCH...",
    "Mystery sequence: loaded",
    "System integrity: nominal"
  ];

  // Visual reset
  panel.style.display = 'block';
  panel.classList.add('branch-enter');
  hologram.textContent = "";
  scriptEl.textContent = "";
  mystery.textContent = "";
  proceedBtn.classList.remove('visible');
  proceedBtn.style.pointerEvents = 'none';

  // Hologram settings
  const displayMs = 1200;
  const loopCount = 2; // show each tier twice then stop

  // If startHologramCycle exists, use it and compute total duration
  if (typeof startHologramCycle === 'function') {
    startHologramCycle({ tiers, targetId: 'tierHologram', loopCount, displayMs });

    // total duration = displayMs * tiers.length * loopCount (+ small buffer)
    const holoTotal = displayMs * tiers.length * Math.max(1, loopCount) + 300;
    setTimeout(() => {
      // proceed with boot script and reveal sequence
      revealBootScriptThenAwait();
    }, holoTotal);
  } else {
    // Fallback: simple single-line hologram cycle (no external function)
    let idx = 0;
    let cycles = 0;
    const total = tiers.length;
    const fallbackInterval = setInterval(() => {
      // show single tier with simple fade classes
      const text = tiers[idx];
      hologram.setAttribute('data-echo', text || "");
      hologram.classList.remove('holo-fade-in', 'holo-fade-out');
      void hologram.offsetWidth;
      hologram.textContent = text;
      hologram.classList.add('holo-fade-in');

      setTimeout(() => {
        hologram.classList.remove('holo-fade-in');
        hologram.classList.add('holo-fade-out');
      }, Math.max(Math.round(displayMs * 0.66), 300));

      idx = (idx + 1) % total;
      if (idx === 0) cycles++;
      if (loopCount > 0 && cycles >= loopCount) {
        clearInterval(fallbackInterval);
        // leave last tier visible
        hologram.classList.remove('holo-fade-out');
        hologram.classList.add('holo-fade-in');
        // small buffer then continue
        setTimeout(revealBootScriptThenAwait, 300);
      }
    }, displayMs);
  }

  // reveal boot script lines sequentially, then mystery + awaiting + button
  function revealBootScriptThenAwait() {
    let s = 0;
    const si = setInterval(() => {
      if (s < scriptLines.length) {
        scriptEl.textContent += "| " + scriptLines[s] + "\n";
        s++;
      } else {
        clearInterval(si);
        revealMysteryAndAwait();
      }
    }, 700);
  }

  function revealMysteryAndAwait() {
    const randomSentence = mysterySentences[Math.floor(Math.random() * mysterySentences.length)];
    // show mystery sentence
    setTimeout(() => {
      mystery.textContent = ">> " + randomSentence;
      mystery.style.opacity = '1';
    }, 400);

    // show awaiting line, fade it, then reveal button
    setTimeout(() => {
      scriptEl.textContent += "| >> Awaiting clearance trigger...\n";
      setTimeout(() => {
        scriptEl.classList.add('awaiting-fade');
        setTimeout(() => {
          // remove the awaiting line
          const lines = scriptEl.textContent.split('\n');
          if (lines.length > 1) lines.splice(lines.length - 2, 1);
          scriptEl.textContent = lines.join('\n');
          scriptEl.classList.remove('awaiting-fade');

          // reveal button using class that matches your CSS
          setTimeout(() => {
            proceedBtn.classList.add('visible');
            proceedBtn.style.pointerEvents = 'auto';
          }, 220);
        }, 1200); // fade duration
      }, 1200); // awaiting visible duration
    }, 1400); // delay before showing awaiting line
  }
}

  
    </script>
  
  <script>
// Gamified Unlock button handler — replace the previous handler with this block
document.getElementById('finalClearanceBtn')?.addEventListener('click', () => {
  const codeInput = document.getElementById('finalClearanceCode');
  const status = document.getElementById('finalClearanceStatus');
  const cube = document.querySelector('#finalClearancePanel .glowing-cube');
  const btn = document.getElementById('finalClearanceBtn');
  if (!codeInput || !status || !btn) return;

  const code = (codeInput.value || '').trim();
  if (!code) {
    status.textContent = 'Enter the final clearance code.';
    status.style.color = '#ffb3b3';
    btn.classList.remove('success');
    return;
  }

  // gamified button feedback: disable, pulse, staged messages
  btn.disabled = true;
  btn.classList.remove('success');
  status.style.color = '#bfffd0';
  status.textContent = 'Verifying code integrity...';

  // quick visual: small press animation
  btn.animate(
    [{ transform: 'translateY(0)' }, { transform: 'translateY(4px) scale(0.995)' }, { transform: 'translateY(0)' }],
    { duration: 260 }
  );

  setTimeout(() => {
    status.textContent = 'Decrypting ceremonial seal...';
    setTimeout(() => {
      // demo validation
      const ok = code.length >= 6;
      if (ok) {
        status.style.color = '#dfffe8';
        status.textContent = 'Code accepted. Unlocking Superform...';
        // cube celebration
        if (cube) {
          cube.classList.add('pulse');
          setTimeout(() => cube.classList.remove('pulse'), 900);
        }
        // button success flash
        btn.classList.add('success');
        setTimeout(() => {
          btn.disabled = false;
          // final success message
          status.textContent = 'Superform unlocked. Proceed to Final Clearance Qube.';
        }, 900);
      } else {
        status.style.color = '#ffb3b3';
        status.textContent = 'Invalid code. The chamber rejects the attempt.';
        btn.disabled = false;
      }
    }, 900);
  }, 700);
});


  // One-time tier code generation
  document.getElementById('generateTierCodeBtn')?.addEventListener('click', () => {
    const tier = document.getElementById('finalTier')?.value || '';
    const out = document.getElementById('oneTimeCode');
    if (!out) return;
    if (!tier) {
      out.textContent = 'Select a tier to reveal its one-time code.';
      out.style.color = '#ffb3b3';
      return;
    }
    out.style.color = '#dfffe8';
    out.textContent = 'Generating one-time code...';
    // simulated secure generation
    setTimeout(() => {
      const code = generateOneTimeCode(tier);
      out.textContent = `${tier} • ${code}`;
      out.setAttribute('aria-hidden', 'false');
      // small cube pulse to celebrate
      const cube = document.querySelector('#finalClearancePanel .glowing-cube');
      if (cube) {
        cube.classList.add('pulse');
        setTimeout(() => cube.classList.remove('pulse'), 700);
      }
    }, 900);
  });

  // Simple one-time code generator (deterministic-ish for demo)
  function generateOneTimeCode(tier) {
    const seed = (tier + Date.now()).toString();
    let hash = 0;
    for (let i = 0; i < seed.length; i++) hash = (hash * 31 + seed.charCodeAt(i)) & 0xffffffff;
    const part = Math.abs(hash).toString(36).slice(0,8).toUpperCase();
    return part.replace(/(.{4})/g, '$1-').replace(/-$/,'');
  }

  // Optional: expose a close function
  window.closeFinalClearancePanel = function() {
    const panel = document.getElementById('finalClearancePanel');
    if (!panel) return;
    panel.style.transition = 'opacity 320ms ease, transform 320ms ease';
    panel.style.opacity = '0';
    panel.style.transform = 'translateY(8px)';
    setTimeout(() => {
      panel.style.display = 'none';
      if (window._finalClearanceCleanup) window._finalClearanceCleanup();
    }, 360);
  };
});
</script>
</body>
</html>
