<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Prestige Triumph ‚Äî Oversight Chambers (Hybrid, Restored)</title>

 <!-- Outer prestige shell (light aura) -->
 <style>
/* === Root palette and shared tokens === */
:root {
  --gold: #d4b86a;
  --ivory: #f2f0e9;
  --slate: #2f3036;
  --iron: #222;

  /* Verify aura (dark blue ‚Üí gray) */
  --verify-bg-start: #2c2f48;
  --verify-bg-end: #4a4d5f;
  --verify-border: #3a3d55;

  /* Outer shell */
  --shell-bg-start: #f5f7fa;
  --shell-bg-end: #e6ecf0;
  --shell-card: rgba(255,255,255,0.95);
}

/* === Outer prestige shell (light aura) === */
body {
  font-family: 'Segoe UI', system-ui, sans-serif;
  background: radial-gradient(circle at top center, var(--shell-bg-start) 0%, var(--shell-bg-end) 100%);
  color: #333; margin: 0; padding: 20px;
}

.container {
  max-width: 900px; margin: auto;
  background: var(--shell-card);
  padding: 30px; border-radius: 15px;
  box-shadow: 0 0 20px rgba(75,63,114,0.2);
  backdrop-filter: blur(6px);
}

.crest-header {
  width: 100px; height: 100px; margin: 0 auto 20px;
  background-image: url('https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh7Xr0yArKKpo2gvFLpUcm9fMR5CgbrkBYTEChDOnIM59NhDxBVFHChMPQQzeVXKnIsS7FOxP4witstDDBjLciMAM1Tq0g_bM86dXGYMLHYms0KiFJniK_gJS0PjbxhgAE1DhdLHvwpD_Id-B2mtbW7SqgWDX72S05uifuP-Ag_XQQMqJGBBNvzV88OjYc/s1600/An%20abstract%20Masterad.png');
  background-size: cover; background-position: center; border-radius: 50%;
  box-shadow: 0 0 20px rgba(194,167,109,0.6);
}

h1, h2, h3 {
  color: #4b3f72; text-align: center;
  text-shadow: 1px 1px 3px rgba(0,0,0,0.12);
  margin: 0 0 14px 0;
}

/* === Verification plaque === */
.verification-plaque {
  margin-top: 25px; padding: 20px;
  border: 2px solid var(--gold); border-radius: 12px;
  background: linear-gradient(to bottom, #fdfcfb, #f3e8e2);
  box-shadow: 0 0 15px rgba(194,167,109,0.4);
  text-align: center; display: none;
}
.verification-plaque textarea {
  width: 100%; height: 120px; margin-top: 10px; padding: 8px;
  border-radius: 8px; border: 1px solid var(--gold);
  font-family: 'Courier New', monospace; font-size: 0.95em; resize: none;
  background: #fffdf8;
}
.verification-plaque button {
  margin-top: 12px; padding: 10px 20px;
  background: linear-gradient(to right, #4b3f72, #6a5acd);
  color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1em;
  box-shadow: 0 4px 12px rgba(75,63,114,0.3);
}
.verification-plaque button:hover {
  background: linear-gradient(to right, #6a5acd, #4b3f72);
}

/* === Floating crest shortcut === */
.floating-crest {
  position: fixed; width: 60px; height: 60px; bottom: 20px; right: 20px;
  background-image: url('https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEh7Xr0yArKKpo2gvFLpUcm9fMR5CgbrkBYTEChDOnIM59NhDxBVFHChMPQQzeVXKnIsS7FOxP4witstDDBjLciMAM1Tq0g_bM86dXGYMLHYms0KiFJniK_gJS0PjbxhgAE1DhdLHvwpD_Id-B2mtbW7SqgWDX72S05uifuP-Ag_XQQMqJGBBNvzV88OjYc/s1600/An%20abstract%20Masterad.png');
  background-size: cover; background-position: center; border-radius: 50%;
  box-shadow: 0 0 20px rgba(194,167,109,0.6); cursor: pointer; z-index: 101; opacity: 0.95;
}
@media (max-width: 860px) { .floating-crest { pointer-events: none; opacity: 0.7; } }

/* === Tap shimmer + zones === */
.tap-zone { position: fixed; width: 64px; height: 64px; top: 0; z-index: 999; }
#tapTopLeft { left: 0; }
#tapTopRight { right: 0; }
.tap-shimmer {
  position: fixed; inset: 0; pointer-events: none; z-index: 998;
  background:
    radial-gradient(120px 120px at 32px 32px, rgba(255,215,0,0.25), transparent 70%),
    radial-gradient(120px 120px at calc(100% - 32px) 32px, rgba(106,90,205,0.22), transparent 70%);
  opacity: 0; transition: opacity 260ms ease;
}
.tap-shimmer.active { opacity: 1; }

/* === Inner ritual styling (panels) === */
.panel-shell {
  background: linear-gradient(180deg, #2a2b2f 0%, #3a3b42 100%);
  border: 3px solid #444; border-radius: 12px;
  box-shadow: inset 0 0 25px rgba(0,0,0,0.8), 0 0 20px rgba(255,215,0,0.18);
  padding: 20px; margin-top: 20px; color: var(--gold);
  font-family: 'Orbitron','Courier New', monospace;
}
.panel-shell h2, .panel-shell h3 {
  color: var(--gold); text-transform: uppercase;
  text-shadow: 0 0 8px rgba(255,215,0,0.6);
}

/* === Color panel (rune grid) === */
#colorPanel { max-width: 880px; margin: 48px auto; padding: 28px; border: 1px solid rgba(212,184,106,0.25); color: var(--ivory); }
#colorPanel .rune-grid {
  display: grid; grid-template-columns: repeat(3, 1fr); gap: 0;
  background: #1c1c1c; border: 8px solid #2a2a2a;
}
#colorPanel .rune-btn {
  display: grid; place-items: center; min-height: 100px;
  border: 6px solid #3a3a3a; background: #2a2b2f;
  font-family: "Cinzel", serif; font-weight: 700; cursor: pointer;
  box-shadow: inset 0 2px 6px rgba(255,255,255,0.05), inset 0 -4px 8px rgba(0,0,0,0.9), 0 0 12px rgba(0,0,0,0.6);
  transition: all 200ms ease;
}
#colorPanel .rune-btn .sigil {
  font-size: 1.6rem; color: rgba(212,184,106,0.9);
  text-shadow: 0 0 6px rgba(212,184,106,0.6), 0 0 14px rgba(242,240,233,0.35);
}
#colorPanel .rune-btn small { margin-top: 6px; font-size: 1rem; color: #aaa; text-shadow: 0 0 3px rgba(0,0,0,0.6); }

/* Active color glows */
#colorPanel .rune-btn.red.active         { background: radial-gradient(circle at 50% 30%, rgba(160,40,40,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.blue.active        { background: radial-gradient(circle at 50% 30%, rgba(40,100,180,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.green.active       { background: radial-gradient(circle at 50% 30%, rgba(60,150,90,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.mustard.active     { background: radial-gradient(circle at 50% 30%, rgba(190,160,60,0.72), #2a2b2f 70%); }
#colorPanel .rune-btn.violet.active      { background: radial-gradient(circle at 50% 30%, rgba(130,80,180,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.cyan.active        { background: radial-gradient(circle at 50% 30%, rgba(60,170,190,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.deepred.active     { background: radial-gradient(circle at 50% 30%, rgba(160,50,50,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.emerald.active     { background: radial-gradient(circle at 50% 30%, rgba(50,170,110,0.75), #2a2b2f 70%); }
#colorPanel .rune-btn.deepviolet.active  { background: radial-gradient(circle at 50% 30%, rgba(110,60,160,0.75), #2a2b2f 70%); }

#colorPanel .rune-btn.active .sigil,
#colorPanel .rune-btn.active small {
  color: var(--ivory);
  text-shadow: 0 0 6px rgba(255,220,120,0.6), 0 0 14px rgba(255,255,180,0.4);
}

/* Indicators + readout */
#colorPanel .indicator-lines { display: flex; justify-content: center; gap: 12px; margin-top: 8px; }
#colorPanel .indicator-lines span {
  width: 28px; height: 4px; border-radius: 2px; background: rgba(90, 60, 30, 0.4);
  box-shadow: inset 0 0 4px rgba(0,0,0,0.6); transition: all 200ms ease;
}
#colorPanel .indicator-lines span.active {
  background: rgba(255,140,60,0.9);
  box-shadow: 0 0 6px rgba(255,140,60,0.65), 0 0 12px rgba(255,200,120,0.45), 0 0 20px rgba(255,160,80,0.35);
}
#sequenceReadout {
  font-family: "Share Tech Mono", monospace; font-size: 1.2rem; color: #9fe8ff;
  background: rgba(20, 30, 40, 0.85); border: 2px inset rgba(120,180,200,0.4);
  padding: 6px 12px; margin-top: 12px; text-align: center; letter-spacing: 0.1em;
  text-shadow: 0 0 6px rgba(0,255,255,0.4), 0 0 12px rgba(0,180,255,0.25);
  overflow: hidden; white-space: nowrap;
}

/* Ritual controls: VERIFY + CLEAR (unified aura) */
.ritual-controls { display: flex; gap: 16px; justify-content: center; margin-top: 24px; }

/* === Unified ceremonial button aura (dark blue‚Äìgray) === */
.runez-btn {
  margin-top: 22px; width: 100%; padding: 13px 16px;
  background: linear-gradient(145deg, var(--verify-bg-start), var(--verify-bg-end));
  color: var(--ivory);
  border: 2px solid var(--verify-border);
  border-radius: 10px; font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em;
  box-shadow: 0 0 14px rgba(90,100,140,0.6), inset 0 0 8px rgba(255,255,255,0.1);
  cursor: pointer; transition: transform 0.14s ease, box-shadow 0.25s ease;
}
.runez-btn:hover {
  transform: translateY(-2px);
  box-shadow: 0 0 20px rgba(90,100,140,0.8), inset 0 0 12px rgba(255,255,255,0.2);
}

/* Optional palette variants (if you need dynamic verify aura) */
.runez-btn.rune-red    { background: radial-gradient(circle,#b04444,#d46a6a); border-color:#b04444; }
.runez-btn.rune-violet { background: radial-gradient(circle,#6a3fa8,#8a6ad4); border-color:#6a3fa8; }
.runez-btn.rune-gold   { background: radial-gradient(circle,#c2a76d,#f2e6a9); border-color:#c2a76d; }

/* === Admin Chamber ‚Äî Grey Prestige Hybrid === */
#adminForm {
  max-width: 640px; margin: 40px auto; padding: 32px;
  background: linear-gradient(180deg, #2a2b2f 0%, #3a3b42 100%);
  border-radius: 16px; border: 1px solid rgba(212, 184, 106, 0.25);
  box-shadow: 0 0 20px rgba(212, 184, 106, 0.12), inset 0 0 14px rgba(60, 65, 75, 0.6), 0 10px 24px rgba(0, 0, 0, 0.55);
  color: var(--ivory); position: relative; overflow: hidden;
}
#adminForm h2 {
  font-size: 1.5rem; text-align: center; margin-bottom: 28px; color: var(--ivory);
  letter-spacing: 0.05em; text-shadow: 0 0 8px rgba(212, 184, 106, 0.25);
  position: relative; padding-top: 70px;
}
#adminForm h2::before {
  content: ""; position: absolute; top: 0; left: 50%; width: 56px; height: 56px; transform: translateX(-50%);
  background: radial-gradient(circle at center, rgba(212,184,106,0.9), rgba(242,240,233,0.85), rgba(95,192,181,0.7));
  border-radius: 50%; box-shadow: 0 0 12px rgba(212, 184, 106, 0.5), 0 0 20px rgba(95, 192, 181, 0.35);
}
#adminForm h2::after {
  content: ""; position: absolute; top: 12px; left: 50%; width: 28px; height: 28px; transform: translateX(-50%) rotate(45deg);
  background: linear-gradient(135deg, rgba(242,240,233,0.95), rgba(212,184,106,0.85));
  box-shadow: 0 0 8px rgba(212, 184, 106, 0.4), inset 0 0 6px rgba(95, 192, 181, 0.25);
}

/* Admin labels and fields */
#adminForm label { display: block; margin: 14px 0 6px; font-weight: 600; color: var(--gold); }
#adminForm input, #adminForm select {
  width: 100%; padding: 12px 14px; background: var(--slate); color: var(--ivory);
  border: 1px solid rgba(90, 106, 122, 0.45); border-radius: 10px;
  box-shadow: inset 0 0 8px rgba(50, 55, 65, 0.6), 0 1px 6px rgba(0, 0, 0, 0.35);
  transition: border-color 0.2s ease, box-shadow 0.2s ease, transform 0.12s ease;
}
#adminForm input:focus, #adminForm select:focus {
  outline: none; border-color: var(--gold);
  box-shadow: inset 0 0 10px rgba(212, 184, 106, 0.25), 0 0 10px rgba(212, 184, 106, 0.25);
  transform: translateY(-1px);
}
#adminForm #verifyStatus { margin-top: 14px; font-size: 0.95rem; text-align: center; color: #b0b2bb; }

/* === Public (‚Äúprestige‚Äù) form ‚Äî consolidated === */
.prestige-form {
  width: 100%; max-width: 600px; margin: 40px auto; padding: 32px;
  background: #fff; border-radius: 12px; box-shadow: 0 6px 18px rgba(0,0,0,0.12);
  font-family: "Segoe UI", sans-serif; color: #333;
}
.prestige-form h1 { font-size: 1.4em; margin-bottom: 20px; text-align: center; color: #4b3f72; }
.prestige-form label { display: block; margin-top: 14px; margin-bottom: 6px; font-weight: 600; color: #4b3f72; }
.prestige-form input[type="text"], .prestige-form input[type="tel"], .prestige-form select {
  width: 100%; padding: 12px 14px; border: 1px solid #b8aee0; border-radius: 6px; font-size: 1em; background: #fafafa; color: #4b3f72;
  transition: border 0.2s ease, box-shadow 0.2s ease;
}
.prestige-form input:focus, .prestige-form select:focus { border-color: #6a5acd; box-shadow: 0 0 6px rgba(106,90,205,0.3); outline: none; }
/* Generator button in public form (use unified aura for parity) */
.prestige-form #genNameBtn { width: 70%; max-width: 320px; }
.prestige-form #genNameBtn,
.prestige-form button[type="submit"] {
  margin-top: 12px; padding: 12px 16px; border-radius: 10px; border: 2px solid var(--verify-border);
  background: linear-gradient(145deg, var(--verify-bg-start), var(--verify-bg-end));
  color: var(--ivory); font-weight: 700; text-transform: uppercase; letter-spacing: 0.06em;
  box-shadow: 0 0 14px rgba(90,100,140,0.6), inset 0 0 8px rgba(255,255,255,0.1);
  cursor: pointer; transition: transform 0.14s ease, box-shadow 0.25s ease;
  width: 100%;
}
.prestige-form button[type="submit"]:hover,
.prestige-form #genNameBtn:hover {
  transform: translateY(-2px); box-shadow: 0 0 20px rgba(90,100,140,0.8), inset 0 0 12px rgba(255,255,255,0.2);
}

/* === Mystery Box chamber === */
#mysteryBoxChamber .mystery-title {
  font-size: 1.6rem; text-align: center; letter-spacing: 0.06em; color: #f6e27a;
  text-shadow: 0 0 12px rgba(255, 200, 80, 0.35); margin-bottom: 20px;
}
#mysteryBoxChamber .mystery-crest { font-size: 2em; margin-bottom: 16px; text-shadow: 0 0 12px rgba(255,215,0,0.8); }

/* === Oversight entry panel === */
#oversightPanel { max-width: 480px; margin: 0 auto; padding: 20px; }
@media (max-width: 860px) { #oversightPanel { width: 90%; margin: 0 auto; } }

/* === Super Code panel inputs === */
#superCodePanel input[type="text"],
#superCodePanel input[type="password"] {
  width: 60%; max-width: 280px; margin: 10px auto; display: block;
  padding: 10px; border-radius: 6px; border: 2px solid #333; background: #111; color: var(--gold); font-weight: bold; box-shadow: inset 0 0 6px rgba(0,0,0,0.7);
}
/* Center panel buttons */
#mysteryBoxPanel button, #finalBranchPanel button, #puzzleBoxPanel button, #superCodePanel button {
  display: block; margin: 20px auto; text-align: center;
}

/* === Rune feedback overlays for panel grid === */
.rune-btn.glow { box-shadow: 0 0 18px rgba(255,215,0,0.9); }
.rune-btn.after-correct { outline: 2px solid rgba(106,255,106,0.5); box-shadow: 0 0 12px rgba(106,255,106,0.6); }
.rune-btn.after-wrong   { outline: 2px solid rgba(255,74,74,0.5); box-shadow: 0 0 12px rgba(255,74,74,0.6); }
.rune-btn.after-correct, .rune-btn.after-wrong { z-index: 1; }

/* === Puzzle Box: imgVoid shell + cube === */
#imgVoidPuzzle {
  width: 100%; max-width: 340px; aspect-ratio: 1 / 1; margin: 0 auto; padding: 16px;
  background: radial-gradient(600px 400px at 50% 50%, rgba(0,0,0,0.85), #0d0d0d);
  border-radius: 16px; box-shadow: inset 0 0 80px rgba(0,0,0,0.95), 0 0 60px rgba(255,215,0,0.08);
  transition: transform 0.6s ease, max-width 0.6s ease;
}
#imgVoidPuzzle.unlocked {
  box-shadow: inset 0 0 60px rgba(0,0,0,0.9), 0 0 40px rgba(255,215,0,0.6), 0 0 80px rgba(106,13,173,0.6), 0 0 120px rgba(0,245,181,0.4);
  animation: auraDance 6s infinite alternate;
}
@keyframes auraDance { 0%{ transform: scale(1) rotate(0deg); } 50%{ transform: scale(1.05) rotate(2deg); } 100%{ transform: scale(1) rotate(-2deg); } }

/* --- Minimal merged styles (focused on Puzzle Box + panel safety) --- */
:root{ --gold:#d4b86a; --ivory:#f2f0e9; --dark:#161616; --accent:#00f5b5; --verify-bg-start:#2c2f48; --verify-bg-end:#4a4d5f; }

body{font-family:Segoe UI,system-ui,-apple-system,Roboto,Helvetica,Arial,sans-serif; margin:18px;background:linear-gradient(#f5f7fa,#e6ecf0); color:#222;}
.container{max-width:960px;margin:0 auto;padding:20px;background:rgba(255,255,255,0.95);border-radius:12px;box-shadow:0 10px 30px rgba(0,0,0,0.06);}

/* panel shell */
.panel-shell{padding:18px;border-radius:12px;margin:18px 0;background:linear-gradient(180deg,#222,#2f2f33);color:var(--ivory);box-shadow:0 6px 20px rgba(0,0,0,0.6);}
.panel-shell h2{margin:0 0 10px;font-family:Orbitron,Segoe UI,monospace;color:var(--gold);text-align:center;}

/* puzzle container and cube */
#puzzleBoxPanel{max-width:520px;margin:18px auto;display:none;}
#imgVoidPuzzle{max-width:420px;margin:10px auto;display:none;}
.cube-container{perspective:1100px;}
.cube{width:100%;height:420px;position:relative;transform-style:preserve-3d;transform:translateZ(-170px) rotateX(-15deg) rotateY(20deg);transition:transform .16s ease-out;}
.cube-face{position:absolute;left:0;top:0;width:100%;height:100%;box-sizing:border-box;padding:18px;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;backface-visibility:hidden;}
.cube-face p{margin:6px 0 12px;color:#dfeffd;}
.cube-face.front{transform:rotateY(0deg) translateZ(calc(50%));}
.cube-face.back{transform:rotateY(180deg) translateZ(calc(50%));}
.cube-face.right{transform:rotateY(90deg) translateZ(calc(50%));}
.cube-face.left{transform:rotateY(-90deg) translateZ(calc(50%));}
.cube-face.top{transform:rotateX(90deg) translateZ(calc(50%));}
.cube-face.bottom{transform:rotateX(-90deg) translateZ(calc(50%));}

/* lights */
#lightsGrid{display:grid;grid-template-columns:repeat(3,60px);gap:8px;margin:8px 0;}
.light-cell{width:60px;height:60px;background:#0b0b0b;border-radius:8px;border:1px solid #333;cursor:pointer;transition:all 160ms;}
.light-cell.on{background:#ffd700;box-shadow:0 0 14px rgba(255,215,0,0.7);}

/* labyrinth grid */
#labyrinthGrid{display:grid;grid-template-columns:repeat(5,48px);gap:6px;margin:8px 0;}
.cell{width:48px;height:48px;background:#0d0d0d;border-radius:6px;border:1px solid #333;cursor:pointer;transition:all 120ms;}
.cell.on{background:#00b8f5;box-shadow:0 0 12px rgba(0,184,245,0.6);}

/* memory */
#memoryButtons{display:flex;gap:10px;margin:6px 0;}
.mem{width:64px;height:64px;border-radius:10px;background:#141414;border:1px solid #444;color:#fff;font-size:20px;cursor:pointer;}
.mem.flash{filter:brightness(1.6);box-shadow:0 0 14px rgba(255,255,255,0.28);}

/* math */
#mathGrid{display:flex;gap:10px;margin:6px 0;}
.num{min-width:54px;height:54px;border-radius:8px;background:#141414;border:1px solid #444;color:#fff;font-weight:700;cursor:pointer;}
.num.sel{transform:translateY(-3px);background:#2b2b2b;box-shadow:0 0 10px rgba(255,255,255,0.06);}

/* runes */
.rune{display:none;margin-top:12px;font-size:22px;color:var(--accent);text-shadow:0 0 10px rgba(0,245,181,0.6);}

/* locker dial */
.locker-dial{width:180px;height:180px;position:relative;margin:6px 0;}
.locker-dial .dial-face{width:100%;height:100%;border-radius:50%;position:relative;background:radial-gradient(circle,#0d0d0d,#060606);box-shadow:inset 0 0 18px rgba(0,0,0,0.7);overflow:visible;}
.locker-dial .dial-pointer{position:absolute;left:50%;top:8%;width:8px;height:46%;transform-origin:bottom center;background:linear-gradient(180deg,#ffd66b,#f1b600);border-radius:4px;box-shadow:0 0 14px rgba(255,200,60,0.9);transform:rotate(0deg);}
.locker-dial .dial-numbers{position:absolute;inset:0;pointer-events:none;}
.locker-dial .dial-numbers span{position:absolute;left:50%;top:50%;transform-origin:0 0;color:#ddd;font-weight:700;font-size:12px;pointer-events:none;}

/* dial center feedback */
.locker-dial .center-value{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);background:rgba(0,0,0,0.65);color:#fff;padding:6px 10px;border-radius:8px;font-weight:700;box-shadow:0 6px 14px rgba(0,0,0,0.6);}

/* UI controls */
.controls{display:flex;gap:12px;justify-content:center;margin-top:14px;}
.btn{padding:10px 14px;border-radius:10px;border:none;background:linear-gradient(90deg,var(--verify-bg-start),var(--verify-bg-end));color:var(--ivory);cursor:pointer;font-weight:700;}
.small{padding:6px 10px;font-size:0.9rem}

/* status */
.status{margin-top:12px;text-align:center;color:#b8dff3;font-family:monospace;}

/* puzzle notice and hidden sigil */
#puzzleNotice{display:none;position:fixed;bottom:16px;left:50%;transform:translateX(-50%);padding:10px 14px;background:rgba(0,0,0,0.9);color:var(--gold);border-radius:8px;z-index:9999;}
#hiddenSigil{display:none;margin-top:6px;color:var(--gold);}

/* small responsive */
@media(max-width:640px){ .cube{height:360px} .locker-dial{width:150px;height:150px} }

/* Mystery Box (hidden branch) */
#mysteryBoxPanel { display: none; border: 3px solid #6a0dad; box-shadow: inset 0 0 25px rgba(0,0,0,0.8), 0 0 20px rgba(138,43,226,0.6); color: #e0dfff; text-align: center; position: relative; overflow: hidden; }
.mystery-title { margin-bottom: 12px; }
.mystery-crest { font-size: 2em; margin-bottom: 16px; text-shadow: 0 0 12px rgba(255,215,0,0.8); }
.cube-aura {
  position: absolute; inset: 0; pointer-events: none; z-index: 0;
  background: radial-gradient(180px 180px at 30% 40%, rgba(106,13,173,0.25), transparent 70%), radial-gradient(220px 220px at 70% 60%, rgba(255,215,0,0.18), transparent 70%);
  animation: auraPulse 5s ease-in-out infinite;
}
@keyframes auraPulse { 0%,100%{filter:saturate(1); opacity:0.75;} 50%{filter:saturate(1.3); opacity:1;} }

/* Locker dial */
.locker-dial { width: 180px; height: 180px; position: relative; }
.locker-dial .dial-face {
  width: 100%; height: 100%; border-radius: 50%;
  background: radial-gradient(120px 120px at 50% 50%, #0e0e0e, #111);
  border: 2px solid #555; box-shadow: inset 0 0 18px rgba(0,0,0,0.8), 0 0 16px rgba(0,245,181,0.15);
  position: relative;
}
.locker-dial .dial-pointer {
  position: absolute; left: 50%; top: 10%; width: 3px; height: 40%;
  transform-origin: bottom center; background: #00f5b5; box-shadow: 0 0 10px rgba(0,245,181,0.6);
}
.locker-dial .dial-numbers {
  position: absolute; inset: 0; display: block; pointer-events: none; color: #ddd; font-size: 12px; font-weight: 700;
}
.locker-dial .dial-numbers span { position: absolute; left: 50%; top: 50%; transform-origin: 0 0; }

/* Small screen polish */
@media (max-width: 480px) {
  body { padding: 10px; }
  .container { padding: 20px; }
  h1 { font-size: 1.4em; }
  .crest-header { width: 80px; height: 80px; }
}

/* Tablet/Mobile panel override */
@media (max-width: 768px) {
  .panel-shell, #colorPanel, #adminForm, #mysteryBoxChamber {
    width: 100%; max-width: 100%; margin: 20px auto; padding: 20px; border-radius: 12px;
  }
}
/* Admin VERIFY button (source of truth) */
#adminForm #verifyTierBtn {
  margin-top: 22px;
  width: 100%;
  padding: 13px 16px;
  background: linear-gradient(90deg, #4a4b52, #5a6a7a);
  color: #f2f0e9;
  border: 1px solid rgba(212, 184, 106, 0.35);
  border-radius: 10px;
  font-weight: 700;
  letter-spacing: 0.05em;
  box-shadow:
    0 6px 18px rgba(0, 0, 0, 0.5),
    inset 0 0 6px rgba(212, 184, 106, 0.12);
  cursor: pointer;
  transition: transform 0.12s ease, box-shadow 0.25s ease, filter 0.2s ease;
}
#adminForm #verifyTierBtn:hover {
  transform: translateY(-2px);
  box-shadow:
    0 10px 24px rgba(0, 0, 0, 0.6),
    0 0 14px rgba(212, 184, 106, 0.25);
  filter: brightness(1.05);
}

/* Rune VERIFY + CLEAR buttons ‚Äî identical aura */
#runeVerifyBtn,
#runeClearBtn {
  margin-top: 22px;
  width: 100%;
  padding: 13px 16px;
  background: linear-gradient(90deg, #4a4b52, #5a6a7a);
  color: #f2f0e9;
  border: 1px solid rgba(212, 184, 106, 0.35);
  border-radius: 10px;
  font-weight: 700;
  letter-spacing: 0.05em;
  box-shadow:
    0 6px 18px rgba(0, 0, 0, 0.5),
    inset 0 0 6px rgba(212, 184, 106, 0.12);
  cursor: pointer;
  transition: transform 0.12s ease, box-shadow 0.25s ease, filter 0.2s ease;
}
#runeVerifyBtn:hover,
#runeClearBtn:hover {
  transform: translateY(-2px);
  box-shadow:
    0 10px 24px rgba(0, 0, 0, 0.6),
    0 0 14px rgba(212, 184, 106, 0.25);
  filter: brightness(1.05);
}
/* Admin form text field focus aura (source of truth) */
#adminForm input:focus,
#adminForm select:focus {
  outline: none;
  border-color: #d4b86a;
  box-shadow:
    inset 0 0 10px rgba(212, 184, 106, 0.25),
    0 0 10px rgba(212, 184, 106, 0.25);
  transform: translateY(-1px);
}

/* Admin Generator + Rune VERIFY/CLEAR buttons ‚Äî same glow aura */
#genNameBtn,
#runeVerifyBtn,
#runeClearBtn {
  margin-top: 22px;
  width: 100%;
  padding: 13px 16px;
  background: linear-gradient(90deg, #4a4b52, #5a6a7a);
  color: #f2f0e9;
  border: 1px solid rgba(212, 184, 106, 0.35);
  border-radius: 10px;
  font-weight: 700;
  letter-spacing: 0.05em;
  box-shadow:
    0 6px 18px rgba(0, 0, 0, 0.5),
    inset 0 0 6px rgba(212, 184, 106, 0.12);
  cursor: pointer;
  transition: transform 0.12s ease, box-shadow 0.25s ease, filter 0.2s ease;
}

/* Hover glow matches text field focus aura */
#genNameBtn:hover,
#runeVerifyBtn:hover,
#runeClearBtn:hover {
  transform: translateY(-2px);
  border-color: #d4b86a;
  box-shadow:
    inset 0 0 10px rgba(212, 184, 106, 0.25),
    0 0 10px rgba(212, 184, 106, 0.25),
    0 10px 24px rgba(0, 0, 0, 0.6);
  filter: brightness(1.05);
}
/* Admin chamber input + select sizing */
#adminForm input,
#adminForm select,
#adminForm textarea {
  width: 100%;               /* full width inside the chamber */
  min-height: 52px;          /* taller field height */
  font-size: 1.05rem;        /* slightly larger text */
  padding: 14px 16px;        /* more breathing room */
  border-radius: 12px;       /* match button aura */
  box-sizing: border-box;    /* consistent sizing */
}

/* Ensure phone + code fields don‚Äôt look cramped */
#adminPhone,
#adminCode {
  letter-spacing: 0.05em;    /* ceremonial spacing */
  font-weight: 600;          /* prestige emphasis */
}

/* Puzzle Box / Cube ‚Äî corrected and defensive */

#imgVoidPuzzle { display: none; max-width: 420px; margin: 0 auto; padding: 16px; box-sizing: border-box; }
#imgVoidPuzzle.active { display: block; }

/* container perspective */
.cube-container { perspective: 1100px; -webkit-perspective: 1100px; width: 100%; max-width: 420px; margin: 0 auto; box-sizing: border-box; }

/* cube sizing and 3D environment */
.cube {
  width: 100%;
  height: 420px;
  position: relative;
  transform-style: preserve-3d;
  transform-origin: 50% 50%;
  transition: transform 160ms ease-out;
  will-change: transform;
  pointer-events: auto;
  box-sizing: border-box;
}

/* ensure faces fill the cube and are backface-hidden */
.cube-face {
  position: absolute;
  left: 0;
  top: 0;
  width: 100%;
  height: 100%;
  box-sizing: border-box;
  padding: 18px;
  display: flex;
  flex-direction: column;
  justify-content: flex-start;
  align-items: center;
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
  pointer-events: auto;
}

/* Use a fixed translateZ to avoid calc issues ‚Äî match half the cube height */
.cube-face.front  { transform: rotateY(0deg)   translateZ(210px); }
.cube-face.back   { transform: rotateY(180deg) translateZ(210px); }
.cube-face.right  { transform: rotateY(90deg)  translateZ(210px); }
.cube-face.left   { transform: rotateY(-90deg) translateZ(210px); }
.cube-face.top    { transform: rotateX(90deg)  translateZ(210px); }
.cube-face.bottom { transform: rotateX(-90deg) translateZ(210px); }

/* ensure inner controls remain clickable and visible */
.cube-face * { pointer-events: auto; position: relative; z-index: 2; }

/* defensive min-size so translateZ has meaning */
#imgVoidPuzzle, .cube { min-height: 300px; min-width: 300px; }

/* Lights grid */
#lightsGrid { display: grid; grid-template-columns: repeat(3, 60px); gap: 8px; margin: 8px 0; }
.light-cell { width: 60px; height: 60px; border-radius: 8px; background: #0b0b0b; border: 1px solid #333; cursor: pointer; -webkit-appearance: none; appearance: none; }
.light-cell.on { background: #ffd700; box-shadow: 0 0 14px rgba(255,215,0,.7); }

/* Labyrinth grid */
#labyrinthGrid { display: grid; grid-template-columns: repeat(5, 48px); gap: 6px; margin: 8px 0; }
#labyrinthGrid .cell { width: 48px; height: 48px; border-radius: 6px; background: #0d0d0d; border: 1px solid #333; cursor: pointer; }
#labyrinthGrid .cell.on { background: #00b8f5; box-shadow: 0 0 12px rgba(0,184,245,0.6); }

/* Memory */
#memoryButtons { display:flex; gap:10px; margin:8px 0; }
.mem { width:64px; height:64px; border-radius:10px; background:#141414; border:1px solid #444; color:#fff; font-size:20px; cursor:pointer; -webkit-appearance:none; appearance:none; }
.mem.flash { filter:brightness(1.6); box-shadow:0 0 14px rgba(255,255,255,0.28); }

/* Math */
#mathGrid { display:flex; gap:10px; margin:8px 0; }
.num { min-width:54px; height:54px; border-radius:8px; background:#141414; border:1px solid #444; color:#fff; font-weight:700; cursor:pointer; -webkit-appearance:none; appearance:none; }
.num.sel { transform: translateY(-3px); background:#2b2b2b; box-shadow: 0 0 10px rgba(255,255,255,0.06); }

/* Locker dial ‚Äî geometry + pointer */
.locker-dial { width: 180px; height: 180px; position: relative; box-sizing: border-box; }
.locker-dial .dial-face { width: 100%; height: 100%; border-radius: 50%; position: relative; background: radial-gradient(circle,#0d0d0d,#060606); border:2px solid #444; overflow: visible; }
.locker-dial .dial-numbers { position: absolute; inset:0; pointer-events:none; }
.locker-dial .dial-numbers span { position: absolute; left:50%; top:50%; transform-origin:0 0; color:#ddd; font-weight:700; font-size:12px; pointer-events:none; }
.locker-dial .dial-pointer { position:absolute; left:50%; top:8%; width:6px; height:46%; transform-origin: bottom center; background: linear-gradient(180deg,#ffd700,#f0b800); border-radius:3px; box-shadow:0 0 14px rgba(255,190,0,0.9); transform: rotate(0deg); pointer-events:auto; }

/* Dial center readout */
.locker-dial .center-value { position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); background: rgba(0,0,0,0.65); color:#fff; padding:6px 10px; border-radius:8px; font-weight:700; z-index:3; }

/* puzzle notice and sigil */
#puzzleNotice { display:none; position:fixed; bottom:16px; left:50%; transform:translateX(-50%); padding:10px 14px; background:rgba(0,0,0,0.9); color:var(--gold); border-radius:8px; }
#hiddenSigil { display:none; color:var(--gold); margin-top:6px; }

/* responsive adjustments */
@media (max-width:640px) {
  .cube { height: 360px; }
  .locker-dial { width:150px; height:150px; }
  .cube-face { padding: 12px; }
}

  </style>
</head>
<body>
  <div class="container">
    <div class="crest-header"></div>
    <h1>Prestige Triumph: Oversight Entry</h1>

    <!-- Public form -->
    <form id="love-form" method="POST" class="prestige-form"
      action="https://www.blogger.com/contact-form.do"
      target="hidden_iframe"
      onsubmit="return submitCeremonialForm();"
      style="max-width:600px;margin:40px auto;padding:32px;background:#fff;border-radius:12px;box-shadow:0 6px 18px rgba(0,0,0,0.12);">
      <label for="role">Select Tier</label>
      <select id="role" name="role" required>
        <option value="">Select your role</option>
        <option value="Initiate">Initiate</option>
        <option value="Steward">Steward</option>
        <option value="Neighbor">Neighbor</option>
        <option value="Contributor">Contributor</option>
        <option value="Observer">Observer</option>
        <option value="Supporter">Supporter</option>
        <option value="Archivist">Archivist</option>
      </select>

      <div style="text-align:center; margin:12px 0 18px 0;">
        <button type="button" id="genNameBtn"
                onclick="generateNameFromTier()"
                style="width:70%; max-width:320px; background:#c2a76d; color:#fff;
                       border:none; padding:10px 18px; border-radius:6px;
                       font-size:1em; box-shadow:0 2px 6px rgba(0,0,0,0.2);
                       cursor:pointer;">
          ‚ú® Generate Prestige Name
        </button>
      </div>

      <input type="text" id="name" name="name" placeholder="e.g., Solenne of the Third Tier" required style="width:100%;padding:12px 14px;border:1px solid #b8aee0;border-radius:6px;background:#fafafa;color:#4b3f72;">
      <label for="phone">Contact Number</label>
      <input type="tel" id="phone" name="phone" placeholder="e.g., +1 616-555-1234" required style="width:100%;padding:12px 14px;border:1px solid #b8aee0;border-radius:6px;background:#fafafa;color:#4b3f72;">

      <textarea id="message" name="message" style="display:none;"></textarea>
      <input type="email" name="email" id="bloggerEmail" style="display:none;">
      <button type="submit" style="margin-top:24px;width:100%;padding:14px;background:linear-gradient(to right,#4b3f72,#6a5acd);color:white;border:none;border-radius:8px;font-size:1.1em;cursor:pointer;">Create Account</button>

      <!--<p id="tapHint" style="margin-top:10px;">Tap top-left then top-right to unlock Admin gate.</p>-->
    </form>

    <!-- Admin chamber -->
<!-- Admin Chamber (hidden by default) -->
<form id="adminForm"
      method="POST"
      action="https://www.blogger.com/contact-form.do"
      target="hidden_iframe"
      onsubmit="return handleAdminAccess(false);"
      class="chamber-form"
      style="display:none;">
   <h2>Admin Access</h2>
  
   <!-- Tier selection -->
  <label for="adminTier">Tier</label>
  <select id="adminTier" name="adminTier" required>
    <option value="">-- Select Tier --</option>
    <option value="Admin">Admin</option>
    <option value="MasterAdmin">MasterAdmin</option>
    <option value="Overseer">Overseer</option>
    <option value="Controller">Controller</option>
    <option value="Custodian">Custodian</option>
    <option value="Guardian">Guardian</option>
    <option value="Sentinel">Sentinel</option>
    <option value="Supervisor">Supervisor</option>
    <option value="Coordinator">Coordinator</option>
    <option value="Director">Director</option>
    <option value="Chancellor">Chancellor</option>
    <option value="Prefect">Prefect</option>
    <option value="Warden">Warden</option>
    <option value="Marshal">Marshal</option>
    <option value="Commander">Commander</option>
    <option value="Principal">Principal</option>
    <option value="Chief">Chief</option>
    <option value="SovereignAdmin">SovereignAdmin</option>
    <option value="LegacyAdmin">LegacyAdmin</option>
  </select>

 
<!-- Specialized name generator -->
<button type="button" id="adminGenNameBtn"class="runez-btn">Generate Specialized Name</button><br>
<br>
<br>

<!-- Target field (same as public form) -->
<input type="text" id="adminName" name="name" placeholder="Ceremonial Name" />

  

  <!-- Contact phone -->
  <label for="adminPhone">Contact Phone</label>
  <input id="adminPhone" name="phone" type="tel" placeholder="(###) ###-####" required />

  <!-- Clearance code -->
  <label for="adminCode">Clearance Code</label>
  <input id="adminCode" name="adminCode" type="password" required />


  <!-- Hidden Blogger fields -->
  <textarea id="adminMessage" name="message" style="display:none;"></textarea>
  <input type="email" id="adminEmail" name="email" style="display:none;">

  <!-- Buttons -->
  <button type="submit" id="runeClearBtn" class="runez-btn">Submit Admin Form</button>
  <button type="button" id="verifyTierBtn" style="display:none;">Verify</button>

  <!-- Status -->
  <p id="verifyStatus"></p>
</form>



<div id="colorPanel" class="panel-shell" style="display:none;">
      <div class="ritual-header" style="display:flex;flex-direction:column;align-items:center;gap:12px;margin-bottom:16px;">
        <div class="runic">·ö†·õá·öª·õú·ö±</div>
        <div class="sigil" aria-hidden="true" style="position:relative;width:72px;height:72px;display:flex;align-items:center;justify-content:center;filter:drop-shadow(0 0 14px rgba(212,184,106,0.45));">
          <span class="sigil-ring" style="position:absolute;inset:0;border-radius:50%;background:radial-gradient(circle, rgba(212,184,106,0.8), rgba(95,192,181,0.7));"></span>
          <span class="sigil-core" style="position:absolute;inset:18px;border-radius:50%;background:radial-gradient(circle, rgba(40,40,45,0.8), rgba(90,106,122,0.6));"></span>
          <span class="sigil-square" style="position:absolute;width:36px;height:36px;transform:rotate(45deg);background:linear-gradient(135deg, rgba(242,240,233,0.95), rgba(212,184,106,0.85));"></span>
        </div>
      </div>

      <p class="designation">Designation: <strong id="nameInRitual"></strong></p>

      <div class="indicator-lines" id="indicatorLines">
        <span></span><span></span><span></span><span></span>
</div>

      <div id="sequenceReadout" class="sequence">‚Äî ‚Äî ‚Äî</div>
      <div class="rune-grid" id="panelButtons"></div>

      <div class="ritual-controls">
        <button type="button" id="runeVerifyBtn">VERIFY</button>
        <button type="reset" id="runeClearBtn">CLEAR</button>
      </div>
    </div>

    <!-- Access keypad -->
    <div id="superCodePanel" class="panel-shell" style="display:none; position:relative;">
      <h3>Access Panel</h3>
      <div class="panel-sigil">‚ôõ</div>
      <div class="panel-content">
        <p>Rune keypad unlocked. Enter access code to proceed.</p>
        <input id="accessCodeInput" type="text" placeholder="Enter code (X-719-BOX)">
       <button type="button" id="accessConfirmBtn" class="runez-btn">CONFIRM</button>
        <p id="accessCodeStatus"></p>
      </div>
    </div>

    <!-- Mystery Box chamber -->
    <div id="mysteryBoxChamber" class="panel-shell" style="display:none;">
      <h2 class="mystery-title">Mystery Box Chamber</h2>
      <div class="mystery-crest">‚ôõ ‚öö ‚üÅ</div>
      <p>The chamber hums with hidden power. Attempt the Puzzle Box?</p>
      <button id="attemptPuzzleBtn">Attempt Puzzle Box</button>
    </div>

   <!-- Puzzle Box ‚Äî Labyrinth Cube -->

  <div class="container">
    <h1 style="text-align:center;color:#4b3f72">Prestige Triumph ‚Äî Puzzle Box test</h1>

    <!-- Controls to show puzzle -->
    <div style="text-align:center;margin:18px 0">
      <button id="attemptPuzzleBtn" class="btn">OPEN PUZZLE BOX</button>
    </div>

    <!-- Puzzle Panel -->
    <div id="puzzleBoxPanel" class="panel-shell" aria-hidden="true">
      <h2>Puzzle Box ‚Äî Labyrinth Cube</h2>
      <p style="text-align:center;color:#cfeefc">Designation: <strong id="nameInPuzzle">‚Äî</strong></p>

      <div id="imgVoidPuzzle" aria-hidden="true">
        <div class="cube-container">
          <div class="cube" id="labyrinthCube" aria-hidden="true">
            <!-- FRONT: Lights -->
            <div class="cube-face front">
              <p>Toggle all lights green</p>
              <div id="lightsGrid" aria-label="lights grid"></div>
              <div id="runeL" class="rune">Œõ</div>
            </div>

            <!-- BACK: Locker dial -->
            <div class="cube-face back">
              <p>Turn the locker dial in the right order</p>
              <div id="lockerDial" class="locker-dial" aria-hidden="false">
                <div class="dial-face"><div class="dial-pointer" id="dialPointer"></div><div class="dial-numbers" id="dialNumbers"></div></div>
                <div class="center-value" id="dialCenter">--</div>
              </div>
              <p id="dialHint" class="status">Rotate dial; try combos.</p>
              <div id="runeD" class="rune">‚ú¶</div>
            </div>

            <!-- RIGHT: Word -->
            <div class="cube-face right">
              <p id="wordHint">Unscramble: <span id="scrambledWord">‚Äî</span></p>
              <input id="wordInput" type="text" placeholder="type answer" style="padding:8px;border-radius:6px;border:1px solid #555;background:#0b0b0b;color:#fff;">
              <div id="runeW" class="rune">Œ®</div>
            </div>

            <!-- LEFT: Labyrinth -->
            <div class="cube-face left">
              <p>Trace the hidden path</p>
              <div id="labyrinthGrid" aria-label="labyrinth grid"></div>
              <div id="runeM" class="rune">Œ©</div>
            </div>

            <!-- TOP: Memory -->
            <div class="cube-face top">
              <p>Repeat the sequence</p>
              <button id="startMemory" class="btn small">Start</button>
              <div id="memoryButtons"></div>
              <div id="runeS" class="rune">Œ£</div>
            </div>

            <!-- BOTTOM: Math -->
            <div class="cube-face bottom">
              <p id="mathHint">Select numbers to sum to 15</p>
              <div id="mathGrid"></div>
              <div id="runeN" class="rune">Œ¶</div>
            </div>
          </div>
        </div>
      </div>

      <p id="unlockMessage" class="status" style="display:none">‚ú® The Labyrinth Cube Unlocks! ‚ú®</p>
      <div id="hiddenSigil">‚úß Triumphal Sigil ‚úß</div>
    </div>

    <div id="puzzleNotice">Tip: Use the dial center to read current label</div>
  </div>

    <!-- Final Branch -->
    <div id="finalBranchPanel" class="panel-shell" style="display:none;">
      <h2>Final Branch</h2>
      <p>Your final password is: <strong id="revealedPassword">QUBE-ACCESS-777</strong></p>
      <button id="toFinalClearanceBtn">Proceed to Final Clearance Qube</button>
    </div>

    <!-- Final Clearance Chamber -->
    <div id="finalClearancePanel" class="panel-shell" style="display:none;">
      <h2 class="mystery-title">Puzzle Box Mechanism</h2>
      <div class="glowing-cube"></div>
      <p>Enter the final clearance code to unlock the Superform.</p>
      <input id="finalClearanceCode" type="password" placeholder="Re-enter final code" />
      <button id="finalClearanceBtn">Unlock</button>
      <p id="finalClearanceStatus"></p>
    </div>

    <!-- Superform chamber -->
    <div id="mysteryBoxPanel" class="panel-shell" style="display:none; border-color: var(--violet); box-shadow: inset 0 0 25px rgba(0,0,0,0.8), 0 0 20px rgba(138,43,226,0.6);">
      <h2 class="mystery-title">Super Level Access</h2>
      <div class="mystery-crest">‚ôõ ‚öö ‚üÅ</div>
      <div class="cube-aura" aria-hidden="true"></div>
      <form id="superLevelForm" onsubmit="return submitSuperForm();">
        <!-- Sigil watermark behind form -->
  <div class="panel-sigil"></div>
        <!-- Frost overlay layer -->
  <div class="frost-overlay"></div>
        <label for="superName">Account Holder</label>
        <input id="superName" name="superName" required type="text" />
        <label for="superTier">Tier</label>
        <select id="superTier" name="superTier" required>
          <option value="Sovereign">Sovereign</option>
          <option value="Luminary">Luminary</option>
          <option value="Legacy">Legacy Tier</option>
        </select>
        <label for="superCode">Clearance Code</label>
        <input id="superCode" name="superCode" required type="password" />
        <button type="submit">Submit Super-Level Form</button>
        <p id="superFormStatus"></p>
      </form>
    </div>

    <!-- Verification plaque -->
    <div class="verification-plaque" id="verificationPlaque">
      <p>Copy this verification text and paste it into the official Prestige Verification Form:</p>
      <textarea id="verificationText" readonly></textarea>
      <button type="button" onclick="copyVerification()">üìã Copy Verification Text</button>
    </div>
  </div>

  <!-- Crest shortcut -->
  <div class="floating-crest" onclick="unlockSuperForm()" title="Unlock Super Form"></div>

  <!-- Blogger iframe target -->
  <iframe name="hidden_iframe" style="display:none;"></iframe>

  <!-- Tap shimmer + zones -->
  <div class="tap-shimmer" id="tapShimmer"></div>
  <div id="tapTopLeft" class="tap-zone" aria-hidden="true"></div>
  <div id="tapTopRight" class="tap-zone" aria-hidden="true"></div>
<div id="puzzleNotice">
  üì± For true Puzzle Box engagement, reduce your screen size to 50% on mobile.
</div>
<script>
/* =========================
   Prestige Triumph ‚Äî Consolidated Script
   Single-file canonical copy (paste into your page)
   - idempotent wiring
   - no duplicate global helpers
   - retains original UX and flows
   ========================= */

/* -------------------------
   Shared small utilities
   ------------------------- */
const $ = id => document.getElementById(id);
function safeAddEvent(el, evt, fn, opts) { if (!el) return; el.addEventListener(evt, fn, opts); }
function onceWire(el, key, fn) { if (!el) return; if (el.dataset && el.dataset[key]) return; if (el.dataset) el.dataset[key] = '1'; fn(); }
function shuffleArray(arr) { const a = Array.isArray(arr) ? [...arr] : []; for (let i = a.length - 1; i > 0; i--) { const j = Math.floor(Math.random() * (i + 1)); [a[i], a[j]] = [a[j], a[i]]; } return a; }
function arraysMatch(a, b) { if (!Array.isArray(a) || !Array.isArray(b) || a.length !== b.length) return false; for (let i = 0; i < a.length; i++) if (a[i] !== b[i]) return false; return true; }

/* -------------------------
   Panel helpers (idempotent)
   ------------------------- */
function showPanel(id) { const el = $(id); if (el) { el.style.display = 'block'; el.setAttribute('aria-hidden','false'); } }
function hidePanel(id) { const el = $(id); if (el) { el.style.display = 'none'; el.setAttribute('aria-hidden','true'); } }

/* -------------------------
   Verification plaque / clipboard
   ------------------------- */
function copyVerification() {
  const textArea = $('verificationText');
  if (!textArea) return;
  textArea.select();
  textArea.setSelectionRange(0, 99999);
  try { document.execCommand('copy'); } catch (e) { /* ignore */ }
  alert('Verification text copied. Please paste it into the Google Form field.');
}

/* -------------------------
   Name generators (public)
   ------------------------- */
function generateTieredName(tier) {
  const pools = {
    Initiate: { names:[ "Lena","Jamal","Sofia","Kai","Maya","Aria","Jonas","Clara","Mateo","Nora","Ethan","Layla","Owen","Iris","Caleb","Zoe","Lucas","Amira","Noah","Elise","Ravi","Chloe","Daniel","Isla","Micah"], suffixes:[ "of the Welcome Ledger","of the First Entry","of the Community Fold","of the Opening Gate","of the Dawn Register","of the Entry Scroll","of the Common Hall","of the First Circle","of the Hearth Record","of the Entryway","of the Shared Beginning","of the Welcome Chamber","of the Initial Archive","of the Entry Crest","of the Common Ledger","of the First Bond","of the Entry Tier","of the Hearth Fold","of the Welcome Archive","of the Entry Seal"] },
    Steward: { names:[ "Elias","Priya","Malcolm","Zara","Omar","Jonah","Fatima","Marcus","Leila","Hassan","Claudia","Rafael","Nadia","Victor","Amal","Simone","Darius","Farah","Julien","Anika","Mateo","Selene","Harun","Lucia","Khalid"], suffixes:["of the Civic Watch","of the Shared Archive","of the Stewardship Line","of the Civic Chamber","of the Guardian Fold","of the Civic Register","of the Watchful Tier","of the Civic Crest","of the Steward‚Äôs Bond","of the Civic Archive","of the Guardian Ledger","of the Civic Seal","of the Stewardship Archive","of the Civic Scroll","of the Watch Chamber","of the Civic Fold","of the Stewardship Crest","of the Civic Tier","of the Guardian Archive","of the Civic Authority"] },
    Neighbor: { names:[ "Ava","Noah","Grace","Leo","Isla","Hugo","Mila","Samir","Clara","Julian","Tara","Felix","Nina","Oscar","Amira","Eli","Sienna","Mateo","Lila","Jonas","Raya","Victor","Nora","Arjun","Elena"], suffixes:["of the Local Registry","of the Neighborhood Tier","of the Common Fold","of the Shared Street","of the Neighbor‚Äôs Archive","of the Local Crest","of the Common Ledger","of the Hearth Tier","of the Local Archive","of the Neighbor‚Äôs Bond","of the Shared Ledger","of the Local Scroll","of the Common Register","of the Neighbor‚Äôs Seal","of the Local Fold","of the Shared Archive","of the Hearth Crest","of the Local Tier","of the Neighbor‚Äôs Archive","of the Common Authority"] },
    Contributor: { names:[ "Milan","Tessa","Jude","Nina","Arlo","Ravi","Clara","Jonas","Elise","Mateo","Amira","Daniel","Layla","Owen","Iris","Chloe","Lucas","Noah","Zoe","Micah","Anya","Victor","Nora","Julien","Farah"], suffixes:["of the Support Ledger","of the Contributor Line","of the Community Archive","of the Shared Ledger","of the Contribution Crest","of the Support Archive","of the Contributor‚Äôs Bond","of the Community Fold","of the Support Register","of the Contribution Seal","of the Contributor‚Äôs Archive","of the Support Scroll","of the Community Ledger","of the Contribution Tier","of the Support Crest","of the Contributor‚Äôs Fold","of the Community Seal","of the Contribution Archive","of the Support Tier","of the Contributor‚Äôs Authority"] },
    Observer: { names:[ "Theo","Luna","Miles","Ivy","Rowan","Clara","Jonas","Elise","Mateo","Amira","Daniel","Layla","Owen","Iris","Chloe","Lucas","Noah","Zoe","Micah","Anya","Victor","Nora","Julien","Farah","Simone"], suffixes:["of the Quiet Watch","of the Passive Tier","of the Ledger Periphery","of the Silent Archive","of the Watchful Crest","of the Quiet Register","of the Passive Fold","of the Ledger Edge","of the Silent Ledger","of the Watch Chamber","of the Quiet Seal","of the Passive Archive","of the Ledger Scroll","of the Silent Crest","of the Watch Archive","of the Quiet Tier","of the Passive Ledger","of the Ledger Crest","of the Silent Fold","of the Watch Authority"] },
    Supporter: { names:[ "Elena","Caleb","Raya","Finn","Naomi","Jonas","Clara","Mateo","Nora","Amira","Daniel","Layla","Owen","Iris","Chloe","Lucas","Noah","Zoe","Micah","Anya","Victor","Nora","Julien","Farah","Simone"], suffixes:["of the Advocacy Fold","of the Support Tier","of the Donor Registry","of the Patron‚Äôs Archive","of the Support Crest","of the Advocacy Ledger","of the Donor‚Äôs Bond","of the Support Archive","of the Patron‚Äôs Fold","of the Advocacy Scroll","of the Support Register","of the Donor‚Äôs Seal","of the Patron‚Äôs Ledger","of the Advocacy Tier","of the Support Authority","of the Donor‚Äôs Archive","of the Patron‚Äôs Crest","of the Advocacy Archive","of the Support Seal","of the Donor‚Äôs Authority"] },
    Archivist: { names:[ "Solenne","Idris","Helena","Lucan","Amara","Jonas","Clara","Mateo","Nora","Amira","Daniel","Layla","Owen","Iris","Chloe","Lucas","Noah","Zoe","Micah","Anya","Victor","Nora","Julien","Farah","Simone"], suffixes:["of the Memory Vault","of the Archivist Line","of the Tiered Archive","of the Record Chamber","of the Archive Crest","of the Memory Ledger","of the Archivist‚Äôs Bond","of the Tiered Ledger","of the Record Scroll","of the Archive Seal","of the Memory Archive","of the Archivist‚Äôs Fold","of the Tiered Register","of the Record Archive","of the Archive Authority","of the Memory Crest","of the Archivist‚Äôs Archive","of the Tiered Seal","of the Record Ledger","of the Archive Tier"] }
  };
  const pool = pools[tier] || pools.Initiate;
  const name = pool.names[Math.floor(Math.random() * pool.names.length)];
  const suffix = pool.suffixes[Math.floor(Math.random() * pool.suffixes.length)];
  return `${name} ${suffix}`;
}
function generateNameFromTier() {
  const tier = $('role')?.value;
  if (!tier) { alert('Please select a tier first.'); return; }
  const el = $('name');
  if (el) el.value = generateTieredName(tier);
}

/* -------------------------
   Admin specialized name generator
   ------------------------- */
function generateAdminSpecializedName(tier) {
  const pools = {
    Admin: { names:["Xyric","Velonar","Kaelith","Druvenor","Myrosan","Tavricus","Zerath","Olyren","Nerith","Solvion"], suffixes:["of the Gate Sigil","of the Iron Seal","of the Hidden Ledger","of the Crown Archive","of the Watch Spire"] },
    MasterAdmin: { names:["Solvarn","Eryndor","Calethor","Thyrosan","Lumielor","Varrosan","Aurethor","Calyrian","Therion","Vaelor"], suffixes:["of the Eternal Crown","of the Master Seal","of the Oversight Chamber","of the Sovereign Archive","of the Prime Ledger"] },
    Overseer: { names:["Maraven","Oristar","Kyreth","Valmor","Serath","Ilyrion","Drevan","Koriel","Navros","Pelior"], suffixes:["of the Panoptic Tier","of the Vigil Crest","of the Oversight Watch","of the Long View","of the Sentinel Ledger"] },
    Controller: { names:["Branth","Cyris","Tavren","Morix","Elion","Kadroth","Fenlor","Rystan","Ulric","Veldor"], suffixes:["of the Axis Chamber","of the Control Seal","of the Switch Crest","of the Relay Archive","of the Circuit Ledger"] },
    Custodian: { names:["Amaret","Soriel","Bastin","Eldra","Hamon","Lethir","Norian","Pelra","Quenel","Serin"], suffixes:["of the Keep Fold","of the Vault Seal","of the Memory Hold","of the Chamber Keys","of the Archive Lock"] },
    Guardian: { names:["Rhaeth","Galenor","Mireth","Thalen","Corvus","Eryx","Jorrel","Kaeth","Lorik","Serros"], suffixes:["of the Shield Line","of the Gate Ward","of the Crest Watch","of the Hall Guard","of the Bastion Seal"] },
    Sentinel: { names:["Ariste","Caden","Delys","Ferox","Ithar","Kynos","Lyren","Maelor","Nestor","Pyron"], suffixes:["of the Upper Watch","of the Quiet Keep","of the Night Vigil","of the Sight Line","of the Lamp Crest"] },
    Supervisor: { names:["Renvar","Tessan","Orwyn","Marella","Dorian","Helis","Karaen","Leoris","Navor","Selyn"], suffixes:["of the Line Ledger","of the Flow Tier","of the Review Crest","of the Pattern Scroll","of the Rhythm Archive"] },
    Coordinator: { names:["Arion","Belis","Coraen","Demin","Elvar","Faryn","Galius","Heryn","Islor","Jalara"], suffixes:["of the Node Tier","of the Thread Ledger","of the Mesh Crest","of the Lattice Archive","of the Sequence Seal"] },
    Director: { names:["Callion","Drexor","Eamon","Fiora","Helion","Ivara","Jorik","Kaelis","Lyraen","Mavros"], suffixes:["of the Arc Chamber","of the Prime Tier","of the Guiding Seal","of the Lineage Archive","of the Crest Ledger"] },
    Chancellor: { names:["Aurel","Beren","Cyral","Demos","Elara","Fidel","Galen","Helia","Isran","Joriel"], suffixes:["of the Council Seal","of the Civic Crest","of the Scroll Authority","of the Ledger Court","of the Archive Seat"] },
    Prefect: { names:["Ardan","Basile","Cyrion","Delios","Ephra","Feron","Gaius","Helor","Iason","Jaryn"], suffixes:["of the Order Seal","of the Hall Rule","of the Crest Codex","of the Tier Decree","of the Ledger Law"] },
    Warden: { names:["Brenor","Cadal","Dethis","Eryon","Faelis","Gorath","Halden","Ivern","Jareth","Kalen"], suffixes:["of the Gate Hold","of the Lock Tier","of the Bar Crest","of the Guard Archive","of the Seal Chain"] },
    Marshal: { names:["Caldris","Dorian","Eryx","Faelor","Gareth","Harion","Jalen","Korath","Lyris","Mavren"], suffixes:["of the Banner Line","of the Crest March","of the Field Seal","of the Standard Archive","of the Rally Ledger"] },
    Commander: { names:["Corvin","Darex","Eidon","Feran","Galen","Hector","Ilyon","Jaro","Kaelis","Leron"], suffixes:["of the Legion Crest","of the Column Seal","of the Order March","of the Line Archive","of the Command Ledger"] },
    Principal: { names:["Alestor","Bryn","Calyx","Demos","Eland","Fiora","Galen","Helis","Ionar","Jarin"], suffixes:["of the Ledger Seat","of the Crest Chair","of the Prime Scroll","of the Tier Authority","of the Archive Root"] },
    Chief: { names:["Avar","Bastion","Cairn","Dorel","Evanor","Ferran","Garran","Helion","Ithar","Jaro"], suffixes:["of the Crest Line","of the Root Ledger","of the Core Seal","of the Upper Archive","of the Crown Scroll"] },
    SovereignAdmin: { names:["Solvarn","Aurion","Calther","Eryndor","Lumiel","Thyros","Varros","Xerion","Ylath","Zevran"], suffixes:["of the Sovereign Crown","of the Eternal Seal","of the Prime Archive","of the Royal Ledger","of the High Chamber"] },
    LegacyAdmin: { names:["Arion","Belor","Cyris","Drevan","Elion","Faryn","Galen","Helor","Ilyas","Jorren"], suffixes:["of the Legacy Archive","of the Elder Seal","of the Ancestral Ledger","of the Memory Court","of the Root Chamber"] }
  };
  const pool = pools[tier] || pools.Admin;
  const name = pool.names[Math.floor(Math.random() * pool.names.length)];
  const suffix = pool.suffixes[Math.floor(Math.random() * pool.suffixes.length)];
  return `${name} ${suffix}`;
}

/* -------------------------
   Blogger submission / registry (unified)
   ------------------------- */
function generateCardID() { return 'CARD-' + Math.random().toString(36).substr(2, 8).toUpperCase(); }
function generateAccessCode() { return 'ACCESS-' + Math.floor(100000 + Math.random() * 900000); }

function submitToBlogger({ name, phone = '', messageForBlogger = '', plaqueMessage = '', clearanceCode = '', accessCode = '', email = "prestige@triumph.org", redirectURL = '' }) {
  // store registry locally (non-blocking)
  try {
    const cardMatch = (messageForBlogger || '').match(/Account ID:\s*(\S+)/);
    const registry = JSON.parse(localStorage.getItem('userRegistry')) || {};
    registry[name || `anon_${Date.now()}`] = {
      role: (messageForBlogger.match(/Tier:\s*(.+)/) || [])[1] || '',
      phone,
      card: cardMatch ? cardMatch[1] : '',
      clearanceCode: clearanceCode || '',
      accessCode: accessCode || '',
      created: Date.now(),
      activated: false
    };
    localStorage.setItem('userRegistry', JSON.stringify(registry));
  } catch (e) { /* non-blocking */ }

  // Preferred hidden form flow
  const hiddenForm = $('hiddenBloggerForm');
  const hbName = $('hbName');
  const hbPhone = $('hbPhone');
  const hbMessage = $('hbMessage');
  const hbEmail = $('hbEmail');

  if (hiddenForm && hbName && hbMessage && hbEmail) {
    hbName.value = name || '';
    if (hbPhone) hbPhone.value = phone || '';
    hbMessage.value = messageForBlogger || '';
    hbEmail.value = email || '';
    try { hiddenForm.requestSubmit ? hiddenForm.requestSubmit() : hiddenForm.submit(); } catch (err) { hiddenForm.submit(); }
  } else {
    // Legacy fallback
    const legacyName = $('name');
    const legacyPhone = $('phone');
    const legacyMsg = $('message');
    const legacyEmail = $('bloggerEmail');
    if (legacyName) legacyName.value = name || '';
    if (legacyPhone) legacyPhone.value = phone || '';
    if (legacyMsg) legacyMsg.value = messageForBlogger || '';
    if (legacyEmail) legacyEmail.value = email || '';
    const loveForm = $('love-form');
    if (loveForm) {
      try { loveForm.requestSubmit ? loveForm.requestSubmit() : loveForm.submit(); } catch (err) { loveForm.submit(); }
    }
  }

  // show plaque
  const plaque = $('verificationPlaque');
  const vText = $('verificationText');
  if (plaque && vText) {
    vText.value = plaqueMessage || '';
    plaque.style.display = 'block';
  }

  // redirect if provided
  if (redirectURL) {
    setTimeout(() => { window.location.href = redirectURL; }, 1000);
  }
}

/* -------------------------
   Public form submit
   ------------------------- */
function submitCeremonialForm() {
  const name = ($('name')?.value || '').trim();
  const phone = ($('phone')?.value || '').trim();
  const role = ($('role')?.value || '').trim();
  const card = generateCardID();
  const messageForBlogger = `ü´§ Prestige Triumph Verification
üë§ Name: ${name}
üìû Phone: ${phone}
üéñ Tier: ${role}
üÜî Account ID: ${card}`.trim();
  const plaqueMessage = messageForBlogger;
  const redirectURL = `https://mrhim00.blogspot.com/2025/10/issued.html?card=${encodeURIComponent(card)}`;

  submitToBlogger({ name, phone, messageForBlogger, plaqueMessage, clearanceCode: '', accessCode: '', redirectURL });
  return false;
}

/* -------------------------
   Admin flow and bindings
   ------------------------- */
const TIER_CODES = {
  Admin:"A-231-GATE", MasterAdmin:"M-Q8/-CROWN", Overseer:"OVR-442-SIGHT", Controller:"CTRL-993-AXIS",
  Custodian:"CUST-118-KEEP", Guardian:"GUARD-775-SHIELD", Sentinel:"SENT-560-WATCH", Supervisor:"SUP-823-LINE",
  Coordinator:"COORD-237-NODE", Director:"DIR-901-ARC", Chancellor:"CHANC-314-SEAL", Prefect:"PREF-628-ORDER",
  Warden:"WARD-452-GATE", Marshal:"MAR-739-BANNER", Commander:"COMM-888-LEGION", Principal:"PRINC-505-LEDGER",
  Chief:"CHIEF-272-CREST", SovereignAdmin:"SOV-999-CROWN", LegacyAdmin:"LEG-777-ARCHIVE"
};
const HIDDEN_CODE = "X-719-BOX";

let ceremonyName = "";
let superSequence = [];
let tapLog = [];

// admin generator button
onceWire($('adminGenNameBtn'), 'adminGen', () => {
  safeAddEvent($('adminGenNameBtn'), 'click', () => {
    const tier = $('adminTier')?.value || 'Admin';
    const generated = generateAdminSpecializedName(tier);
    ceremonyName = generated;
    if ($('adminName')) $('adminName').value = generated;
    if ($('nameInRitual')) $('nameInRitual').textContent = generated;
  });
});

// admin handler
function handleAdminAccess(isVerifyClick=false) {
  const tier = $('adminTier')?.value;
  const code = ($('adminCode')?.value || '').trim();
  const name = ceremonyName || ($('adminName')?.value || '').trim();
  const phone = ($('adminPhone')?.value || '').trim();
  const status = $('verifyStatus');
  const expectedCode = TIER_CODES[tier];

  if (!expectedCode) { if (status) status.textContent = "‚ùå Unknown tier selected."; return false; }
  if (code !== expectedCode && !(tier === "Admin" || tier === "MasterAdmin")) {
    if (status) status.textContent = `‚ùå Invalid clearance code for ${tier}.`; return false;
  }

  if (tier === "Admin" || tier === "MasterAdmin") {
    if (isVerifyClick) {
      if (status) status.textContent = "‚úÖ Clearance accepted. Unlocking ritual sequence...";
      ['colorPanel','superCodePanel','puzzleBoxPanel','finalClearancePanel','mysteryBoxPanel','finalBranchPanel'].forEach(hidePanel);
      showPanel('colorPanel');
      buildRitualGrid();
    } else {
      if (status) status.textContent = "Use Verify button for Admin/MasterAdmin.";
    }
    return false;
  }

  // Non-Admin tiers -> Blogger route (generate card + access code, store locally, send access code to Blogger)
  const card = generateCardID();
  const accessCode = generateAccessCode();
  const clearanceCode = expectedCode;

  const messageForBlogger = `üîê Admin Access Submission
üë§ Name: ${name}
üìû Phone: ${phone || '‚Äî'}
üéñ Tier: ${tier}
üÜî Account ID: ${card}
üîë Access Code: ${accessCode}`.trim();

  const plaqueMessage = `üîê Admin Access Submission
üë§ Name: ${name}
üéñ Tier: ${tier}
üÜî Account ID: ${card}`.trim();

  const redirectURL = `https://mrhim00.blogspot.com/2025/10/issued.html?card=${encodeURIComponent(card)}`;

  submitToBlogger({
    name, phone,
    messageForBlogger, plaqueMessage,
    clearanceCode, accessCode, redirectURL
  });

  alert("Admin form submitted. Redirecting...");
  return false;
}
onceWire($('adminForm'), 'adminFormBind', () => {
  safeAddEvent($('adminForm'), 'submit', (e) => { e.preventDefault(); handleAdminAccess(false); });
  safeAddEvent(document, 'keydown', (e) => {
    if (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 'a') {
      const f = $('adminForm'); if (f) { f.style.display='block'; alert('Admin access form unlocked.'); }
    }
  });
  safeAddEvent($('verifyTierBtn'), 'click', () => handleAdminAccess(true));
});

// adminCode -> show verify button if correct for Admin/MasterAdmin
onceWire($('adminCode'), 'adminCodeInput', () => {
  safeAddEvent($('adminCode'), 'input', () => {
    const tierSel = $('adminTier')?.value;
    const code = ($('adminCode')?.value || '').trim();
    const verifyBtn = $('verifyTierBtn');
    if (!verifyBtn) return;
    if ((tierSel === 'Admin' && code === TIER_CODES.Admin) || (tierSel === 'MasterAdmin' && code === TIER_CODES.MasterAdmin)) {
      verifyBtn.style.display = 'block';
    } else verifyBtn.style.display = 'none';
  });
});

/* -------------------------
   Ritual Grid (Color Sequence)
   ------------------------- */
let requiredSequence = [];
function buildRitualGrid(){
  const panel = $('panelButtons'); if(!panel) return;
  panel.innerHTML = "";
  const colors  = ["red","blue","green","mustard","violet","cyan","deepred","emerald","deepviolet"];
  const glyphs  = ["‚üü","œû","‚üÅ","‚ßñ","·ö†","Œ∂","‚Ç£","‚üä","‚öö","‚ôõ","‚ß´"];
  const numbers = ["231","85/","V2Œ∂","‚Ç£2","77X","9√ò","31Œî","8.98","27$","719"];

  requiredSequence = shuffleArray(colors).slice(0,4);
  superSequence = []; tapLog = [];
  renderSequence(); updateIndicators();

  colors.forEach(c=>{
    const btn = document.createElement('button');
    btn.type = "button";
    btn.className = "rune-btn " + c;
    const sigil = glyphs[Math.floor(Math.random()*glyphs.length)];
    const num   = numbers[Math.floor(Math.random()*numbers.length)];
    btn.innerHTML = `<span class="sigil">${sigil}</span><small>${num}</small>`;
    btn.addEventListener('click', ()=>handleRitualTap(c, btn));
    panel.appendChild(btn);
  });

  const ritualVerify = document.querySelector('#colorPanel .ritual-controls button:nth-child(1)');
  const ritualClear  = document.querySelector('#colorPanel .ritual-controls button:nth-child(2)');
  if (ritualVerify && !ritualVerify.dataset.wired) {
    ritualVerify.dataset.wired = '1';
    ritualVerify.addEventListener('click', verifySequenceAttempt);
  }
  if (ritualClear && !ritualClear.dataset.wired) {
    ritualClear.dataset.wired = '1';
    ritualClear.addEventListener('click', clearSequence);
  }
}
function handleRitualTap(color, btn){
  superSequence.push(color);
  tapLog.push({ color, btn });
  renderSequence();
  btn.classList.toggle('active');
  updateIndicators();
  btn.classList.add('glow');
  setTimeout(()=>btn.classList.remove('glow'),1200);
}
function renderSequence(){
  const sequenceReadout = $('sequenceReadout'); if(!sequenceReadout) return;
  const text = superSequence.length ? superSequence.join('~') : '----';
  sequenceReadout.textContent = '';
  let i = 0;
  const interval = setInterval(() => {
    sequenceReadout.textContent += text[i] || '';
    i++;
    if (i >= text.length) clearInterval(interval);
  }, 40);
}
function updateIndicators() {
  const indicators = document.querySelectorAll('#indicatorLines span');
  indicators.forEach((bar, i) => {
    if (i < superSequence.length) bar.classList.add('active'); else bar.classList.remove('active');
  });
}
function verifySequenceAttempt(){
  const attemptColors = superSequence.slice(0,4);
  const attemptTaps   = tapLog.slice(0,4);
  const correct = arraysMatch(attemptColors, requiredSequence);

  const sequenceReadout = $('sequenceReadout');
  if (correct) {
    sequenceReadout.textContent = "ACCESS GRANTED >> ACCESS PANEL";
    sequenceReadout.style.color = "#6aff6a";
    hidePanel('colorPanel');
    showPanel('superCodePanel');
    const nameInPuzzle = $('nameInPuzzle');
    const nameInRitual = $('nameInRitual');
    if (nameInPuzzle && nameInRitual) nameInPuzzle.textContent = nameInRitual.textContent;
  } else {
    sequenceReadout.textContent = "ACCESS DENIED";
    sequenceReadout.style.color = "#ff4a4a";
  }

  attemptTaps.forEach(({ color, btn }, i) => {
    btn.classList.remove('after-correct','after-wrong');
    if (color === requiredSequence[i]) {
      btn.classList.add('after-correct');
      setTimeout(() => btn.classList.remove('after-correct'), 4000);
    } else {
      btn.classList.add('after-wrong');
      setTimeout(() => btn.classList.remove('after-wrong'), 1200);
    }
  });

  superSequence = [];
  tapLog = [];
  updateIndicators();
}
function clearSequence(){
  superSequence = [];
  tapLog = [];
  renderSequence();
  document.querySelectorAll('#panelButtons .rune-btn').forEach(btn => {
    btn.classList.remove('active','after-correct','after-wrong','glow');
  });
  updateIndicators();
}

/* -------------------------
   Super Code Panel -> Mystery Box
   ------------------------- */
onceWire($('accessConfirmBtn'), 'accessConfirm', () => {
  safeAddEvent($('accessConfirmBtn'), 'click', () => {
    const v = ($('accessCodeInput')?.value || '').trim().toUpperCase();
    const s = $('accessCodeStatus');
    if (v === HIDDEN_CODE) {
      if (s) s.textContent = '‚úÖ Code accepted. Proceeding to Mystery Box...';
      setTimeout(() => { hidePanel('superCodePanel'); showPanel('mysteryBoxChamber'); }, 600);
    } else {
      if (s) s.textContent = '‚ùå Incorrect code.';
    }
  });
});

/* -------------------------
   Mystery Box -> Puzzle Box entry
   ------------------------- */
onceWire($('attemptPuzzleBtn'), 'attemptPuzzle', () => {
  safeAddEvent($('attemptPuzzleBtn'), 'click', () => {
    hidePanel('mysteryBoxChamber');
    showPanel('puzzleBoxPanel');
    initPuzzleBox();
  });
});

/* -------------------------
   Puzzle Box consolidated
   ------------------------- */
let puzzleInitDone = false;
let cubeUnlocked = false;
let keys = { L:false, D:false, W:false, M:false, S:false, N:false };

/* small helpers for puzzle shell */
function showPuzzleShell(){ const shell=$('imgVoidPuzzle'); if(shell){ shell.classList.add('active'); shell.style.display='block'; shell.setAttribute('aria-hidden','false'); } }
function hidePuzzleShell(){ const shell=$('imgVoidPuzzle'); if(shell){ shell.classList.remove('active'); shell.style.display='none'; shell.setAttribute('aria-hidden','true'); } }
function pulseCube(){ const cube=$('labyrinthCube'); if(!cube) return; cube.style.boxShadow="0 0 40px rgba(0,245,181,0.6)"; setTimeout(()=>{ if(cube) cube.style.boxShadow=''; },900); }

/* puzzle helpers (grids) */
function buildLightsGrid(){ const grid = $('lightsGrid'); if(!grid) return; grid.innerHTML=''; for(let i=0;i<9;i++){ const b=document.createElement('button'); b.className='light-cell'; grid.appendChild(b); } }
function buildLabyrinthGrid(){ const grid = $('labyrinthGrid'); if(!grid) return; grid.innerHTML=''; for(let i=0;i<25;i++){ const d=document.createElement('div'); d.className='cell'; grid.appendChild(d); } }
function buildMemoryButtons(){ const wrap = $('memoryButtons'); if(!wrap) return; wrap.innerHTML=''; const labels=['‚ñ≤','‚óÜ','‚öô']; for(let i=0;i<3;i++){ const b=document.createElement('button'); b.className='mem'; b.dataset.val=i; b.textContent=labels[i]; wrap.appendChild(b); } }
function buildMathButtons(){ const wrap = $('mathGrid'); if(!wrap) return; wrap.innerHTML=''; const nums = [4,7,2,8,5]; nums.forEach(n=>{ const b=document.createElement('button'); b.className='num'; b.textContent = String(n); wrap.appendChild(b); }); }

/* Lights Out logic */
let lightsTarget = [];
function configureLightsOut(){
  const cells = [...document.querySelectorAll('#lightsGrid .light-cell')];
  if(!cells.length) return;
  lightsTarget = shuffleArray(cells.map((_,i)=>i)).slice(0,4);
  cells.forEach(c=>c.classList.remove('on'));
}
function wireLightsOutOnce(){
  const cells = [...document.querySelectorAll('#lightsGrid .light-cell')];
  if(!cells.length) return;
  cells.forEach((cell,idx)=>{
    if(cell.dataset.wired) return;
    cell.dataset.wired='1';
    cell.addEventListener('click',()=>{
      [idx,idx-1,idx+1,idx-3,idx+3].forEach(i=>{ if(cells[i]) cells[i].classList.toggle('on'); });
      const correctNow = cells.filter((c,i)=>c.classList.contains('on') && lightsTarget.includes(i)).length;
      const pct = Math.round(correctNow / Math.max(1, lightsTarget.length) * 100);
      $('dialHint') && ($('dialHint').textContent = `Lights progress: ${pct}%`);
      if(cells.every((c,i)=> c.classList.contains('on') === lightsTarget.includes(i))){
        keys.L=true; $('runeL') && ($('runeL').style.display='block'); pulseCube(); checkCubeUnlock();
      }
    });
  });
}

/* Labyrinth path */
let labPath = [], labProgress = 0;
function generateLabPath(cells, cols, length=9){
  const total = cells.length; if(!total || cols<=0) return [];
  const path=[]; let current=Math.floor(Math.random()*total); path.push(current);
  const maxAttempts=200;
  while(path.length<length){
    const r=Math.floor(current/cols), c=current%cols;
    const neighbors=[];
    if(r>0) neighbors.push(current-cols);
    if(r<Math.floor((total-1)/cols)) neighbors.push(current+cols);
    if(c>0) neighbors.push(current-1);
    if(c<cols-1) neighbors.push(current+1);
    let cand = neighbors.filter(n=>!path.includes(n));
    if(!cand.length) cand = neighbors;
    let next = cand[Math.floor(Math.random()*cand.length)];
    if(next===path[path.length-2] && Math.random()<0.6){
      const alt=cand.filter(x=>x!==next);
      if(alt.length){ next = alt[Math.floor(Math.random()*alt.length)]; }
    }
    current=next; path.push(current);
    if(path.length>length+maxAttempts) break;
  }
  return path.slice(0,length);
}
function configureLabyrinth(){
  const cells=[...document.querySelectorAll('#labyrinthGrid .cell')];
  if(!cells.length) return;
  const cols=5;
  labPath = generateLabPath(cells,cols,9);
  labProgress=0;
  cells.forEach(c=>c.classList.remove('on'));
}
function wireLabyrinthOnce(){
  const cells=[...document.querySelectorAll('#labyrinthGrid .cell')];
  if(!cells.length) return;
  cells.forEach((cell,idx)=>{
    if(cell.dataset.wired) return;
    cell.dataset.wired='1';
    cell.addEventListener('click',()=>{
      if(!labPath.length) return;
      if(idx===labPath[labProgress]){
        cell.classList.add('on'); labProgress++;
        $('dialHint') && ($('dialHint').textContent = `Path ${labProgress}/${labPath.length}`);
        if(labProgress===labPath.length){ keys.M=true; $('runeM') && ($('runeM').style.display='block'); pulseCube(); checkCubeUnlock(); }
      } else {
        cells.forEach(c=>c.classList.remove('on')); labProgress=0;
      }
    });
  });
}

/* Memory (Simon) */
let memSeq=[], playerSeq=[], playingMemory=false;
function configureMemory(){ memSeq=[]; playerSeq=[]; playingMemory=false; document.querySelectorAll('#memoryButtons .mem').forEach(b=>b.classList.remove('flash')); }
function wireMemoryOnce(){
  const memBtns=[...document.querySelectorAll('#memoryButtons .mem')];
  const startBtn=$('startMemory');
  if(!memBtns.length || !startBtn) return;
  function flash(btn){ btn.classList.add('flash'); setTimeout(()=>btn.classList.remove('flash'),220); }
  function playSequence(){ playingMemory=true; let i=0; const iv=setInterval(()=>{ const v=memSeq[i]; const b=document.querySelector(`.mem[data-val="${v}"]`); if(b) flash(b); i++; if(i>=memSeq.length){ clearInterval(iv); playingMemory=false; playerSeq=[]; } },450); }
  function nextRound(){ memSeq.push(Math.floor(Math.random()*memBtns.length)); playSequence(); }
  onceWire(startBtn,'startMem',()=> startBtn.addEventListener('click', ()=>{ memSeq=[]; playerSeq=[]; nextRound(); }) );
  memBtns.forEach(btn=>{
    onceWire(btn,'membtn',()=> btn.addEventListener('click', ()=>{
      if(playingMemory || memSeq.length===0) return;
      const val=parseInt(btn.dataset.val,10);
      playerSeq.push(val); flash(btn);
      for(let i=0;i<playerSeq.length;i++) if(playerSeq[i]!==memSeq[i]){ playerSeq=[]; playSequence(); return; }
      if(playerSeq.length===memSeq.length){
        if(memSeq.length>=4){ keys.S=true; $('runeS') && ($('runeS').style.display='block'); pulseCube(); checkCubeUnlock(); }
        else nextRound();
      }
    }) );
  });
}

/* Math selection */
let mathTarget=15;
function configureMath(){ mathTarget = 12 + Math.floor(Math.random()*9); $('mathHint') && ($('mathHint').textContent = `Find a selection that sums to ${mathTarget}`); document.querySelectorAll('#mathGrid .num').forEach((b,i)=>{ b.classList.remove('sel'); b.textContent = [4,7,2,8,5][i]; }); }
function wireMathOnce(){
  const nums=[...document.querySelectorAll('#mathGrid .num')];
  if(!nums.length) return;
  nums.forEach(btn=>{
    if(btn.dataset.wired) return;
    btn.dataset.wired='1';
    btn.addEventListener('click', ()=>{
      btn.classList.toggle('sel');
      const sel=[...document.querySelectorAll('#mathGrid .num.sel')].map(n=>parseInt(n.textContent.trim(),10));
      const sum = sel.reduce((a,b)=>a+b,0);
      $('dialHint') && ($('dialHint').textContent = `Math sum: ${sum}/${mathTarget}`);
      if(sum===mathTarget){ keys.N=true; $('runeN') && ($('runeN').style.display='block'); pulseCube(); checkCubeUnlock(); }
      else if(sum>mathTarget){ nums.forEach(n=>n.classList.remove('sel')); }
    });
  });
}

/* Word unscramble lock */
let wordAnswer='';
function configureWordLock(){
  const dict=['real','rite','unity','aura','glow','crown','honor','veil','phase','orbit'];
  wordAnswer = dict[Math.floor(Math.random()*dict.length)];
  const scrambled = shuffleArray([...wordAnswer]).join('');
  $('scrambledWord') && ($('scrambledWord').textContent = scrambled);
  $('wordInput') && ($('wordInput').value='');
}
function wireWordLockOnce(){
  const wi=$('wordInput'); if(!wi) return;
  onceWire(wi,'word',()=> wi.addEventListener('change', e=>{ if((e.target.value||'').trim().toLowerCase()===wordAnswer){ keys.W=true; $('runeW') && ($('runeW').style.display='block'); pulseCube(); checkCubeUnlock(); } }) );
}

/* Dial (locker) - randomized labels + interactive pointer; combination logic uses OWNER_COMBO if set */
let dialAngle = 0, dragging=false, startAngle=0, lastAngle=0;
let dialLabels = [];
let dialSlots = [];
const DIAL_SLOTS = 20;
function configureDial(){
  const dialFace = document.querySelector('#lockerDial .dial-face');
  const numbers = $('dialNumbers');
  if(!dialFace || !numbers) return;
  numbers.innerHTML = '';
  dialSlots = Array.from({length:DIAL_SLOTS},(_,i)=> i * (360 / DIAL_SLOTS));
  const pool = []; for(let v=0; v<100; v+=5) pool.push(v);
  dialLabels = shuffleArray(pool).slice(0,DIAL_SLOTS);
  for(let i=0;i<DIAL_SLOTS;i++){
    const angle = dialSlots[i];
    const span = document.createElement('span');
    span.textContent = String(dialLabels[i]);
    span.style.transform = `rotate(${angle}deg) translate(75px) rotate(${-angle}deg)`;
    span.dataset.slot = i;
    numbers.appendChild(span);
  }
  $('dialCenter') && ($('dialCenter').textContent='--');
  dialFace._labels = dialLabels;
}
function valueFromAngle(a){
  const norm = ((a%360)+360)%360;
  const idx = Math.round(norm / (360 / DIAL_SLOTS)) % DIAL_SLOTS;
  return { idx, label: dialLabels[idx] };
}
function wireDialOnce(){
  const dialFace = document.querySelector('#lockerDial .dial-face');
  const pointer = $('dialPointer');
  if(!dialFace || !pointer || dialFace.dataset.wired) return;
  dialFace.dataset.wired='1';
  dialAngle = 0; dragging=false; startAngle=0; lastAngle=0;

  function updatePointer(){ pointer.style.transform = `rotate(${dialAngle}deg)`; const v = valueFromAngle(dialAngle); $('dialCenter') && ($('dialCenter').textContent = String(v.label)); }
  function handleMove(clientX, clientY){
    const rect = dialFace.getBoundingClientRect();
    const cx = rect.left + rect.width/2, cy = rect.top + rect.height/2;
    const ang = Math.atan2(clientY - cy, clientX - cx) * 180 / Math.PI;
    if(isNaN(startAngle)) startAngle = ang;
    const delta = ang - startAngle; startAngle = ang;
    dialAngle += delta; updatePointer();
    proximityHint();
  }

  function proximityHint(){
    const desired = window.OWNER_COMBO || [20,5,75];
    const current = valueFromAngle(dialAngle).label;
    const d = Math.min(...desired.map(x=>Math.abs(x-current)));
    const hint = $('dialHint');
    if(d===0) hint && (hint.textContent = `Exact label ${current}`);
    else if(d<=5) hint && (hint.textContent = `Very close (${current})`);
    else if(d<=15) hint && (hint.textContent = `Close (${current})`);
    else hint && (hint.textContent = `Current: ${current}`);
  }

  // Mouse
  dialFace.addEventListener('mousedown', e=>{ dragging=true; const rect=dialFace.getBoundingClientRect(); startAngle = Math.atan2(e.clientY - (rect.top+rect.height/2), e.clientX - (rect.left+rect.width/2)) * 180 / Math.PI; });
  document.addEventListener('mousemove', e=>{ if(!dragging) return; handleMove(e.clientX,e.clientY); });
  document.addEventListener('mouseup', ()=>{ if(!dragging) return; dragging=false; const v = valueFromAngle(dialAngle); const targetAngle = dialSlots[v.idx]; dialAngle = targetAngle; updatePointer(); proximityHint(); });
  // Touch
  dialFace.addEventListener('touchstart', e=>{ dragging=true; const t=e.touches[0]; const rect=dialFace.getBoundingClientRect(); startAngle = Math.atan2(t.clientY - (rect.top+rect.height/2), t.clientX - (rect.left+rect.width/2)) * 180 / Math.PI; }, {passive:true});
  document.addEventListener('touchmove', e=>{ if(!dragging) return; const t=e.touches[0]; handleMove(t.clientX,t.clientY); }, {passive:true});
  document.addEventListener('touchend', ()=>{ if(!dragging) return; dragging=false; const v=valueFromAngle(dialAngle); dialAngle = dialSlots[v.idx]; updatePointer(); proximityHint(); });
}

/* Owner combo helper */
window.OWNER_COMBO = null;
function setOwnerCombo(arr){ if(Array.isArray(arr)) window.OWNER_COMBO = arr; }

/* Combination attempt via clicking center */
let attemptSequence = [];
function verifyComboTap(label){
  attemptSequence.push(label);
  if(attemptSequence.length > 3) attemptSequence.shift();
  const expected = window.OWNER_COMBO || [20,5,75];
  if(attemptSequence.length === expected.length && attemptSequence.every((v,i)=>v===expected[i])){
    $('dialHint') && ($('dialHint').textContent = 'Combo matched!');
    keys.D = true; $('runeD') && ($('runeD').style.display='block'); pulseCube(); checkCubeUnlock();
    attemptSequence = [];
  } else {
    let closeness = 0;
    for(let i=0;i<attemptSequence.length;i++){
      if(Math.abs(attemptSequence[i]-expected[i]) <= 5) closeness += 1;
    }
    if(closeness === attemptSequence.length) $('dialHint') && ($('dialHint').textContent = 'Partial match (close)');
    else $('dialHint') && ($('dialHint').textContent = `Attempt: ${attemptSequence.join(',')}`);
  }
}

/* Puzzle orchestrator */
function buildAllShells(){
  buildLightsGrid();
  buildLabyrinthGrid();
  buildMemoryButtons();
  buildMathButtons();
}
function wireAllOnce(){
  wireLightsOutOnce();
  wireLabyrinthOnce();
  wireMemoryOnce();
  wireMathOnce();
  wireWordLockOnce();
  wireDialOnce();
}
function initPuzzleBox(){
  if(!puzzleInitDone){
    buildAllShells();
    wireAllOnce();
    puzzleInitDone = true;
  }
  resetPuzzleState();
  configureLightsOut();
  configureLabyrinth();
  configureMemory();
  configureMath();
  configureWordLock();
  configureDial();
  const pn = $('puzzleNotice'); if(pn) pn.style.display='block'; setTimeout(()=>{ if(pn) pn.style.display='none'; },4000);
}

/* Click center to add dial label attempt */
safeAddEvent(document, 'click', (e)=> {
  if(e.target && (e.target.id==='dialCenter' || e.target.id==='dialPointer' || e.target.closest('.dial-face')) ){
    const v = valueFromAngle(dialAngle).label;
    verifyComboTap(v);
  }
});

/* Expose debugging helpers */
window._PT = {
  initPuzzleBox, configureDial, dialLabels: ()=>dialLabels, setOwnerCombo
};

/* -------------------------
   Final branch -> Final clearance -> Superform
   ------------------------- */
onceWire($('toFinalClearanceBtn'), 'toFinal', ()=> safeAddEvent($('toFinalClearanceBtn'), 'click', ()=>{ hidePanel('finalBranchPanel'); showPanel('finalClearancePanel'); }));
onceWire($('finalClearanceBtn'), 'finalClear', ()=> safeAddEvent($('finalClearanceBtn'), 'click', ()=>{
  const code = ($('finalClearanceCode')?.value || '').trim();
  const revealed = ($('revealedPassword')?.textContent || '').trim();
  const status = $('finalClearanceStatus');
  if (code === revealed) {
    status && (status.textContent = "‚úÖ Clearance accepted. Superform unlocked.");
    setTimeout(()=>{ hidePanel('finalClearancePanel'); showPanel('mysteryBoxPanel'); $('superName') && ($('superName').value = ceremonyName || ''); }, 800);
  } else status && (status.textContent = "‚ùå Incorrect code.");
}));

/* Superform submit */
function submitSuperForm() {
  const code = ($('superCode')?.value || '').trim();
  if (code !== "TRIUMPH-777") { alert("Invalid super-level clearance code."); return false; }
  const name = ($('superName')?.value || '').trim();
  const tier = ($('superTier')?.value || '').trim();
  const card = generateCardID();
  const accessCode = generateAccessCode();
  const clearanceCode = code;

  const messageForBlogger = `üëë Super-Level Access Submission
üë§ Name: ${name}
üéñ Tier: ${tier}
üÜî Account ID: ${card}
üîë Access Code: ${accessCode}`.trim();

  const plaqueMessage = `üëë Super-Level Access Submission
üë§ Name: ${name}
üéñ Tier: ${tier}
üÜî Account ID: ${card}`.trim();

  const redirectURL = `https://mrhim00.blogspot.com/2025/10/issued.html?card=${encodeURIComponent(card)}`;

  submitToBlogger({ name, phone:'', messageForBlogger, plaqueMessage, clearanceCode, accessCode, redirectURL });
  alert("Super-level form submitted. Redirecting...");
  return false;
}
onceWire($('superLevelForm'), 'superForm', ()=> safeAddEvent($('superLevelForm'), 'submit', (e)=>{ e.preventDefault(); submitSuperForm(); }));

/* -------------------------
   Cube rotation binding
   ------------------------- */
(function bindCubeRotation(){
  const cubeEl = $('labyrinthCube');
  if (!cubeEl) return;
  let dragging=false, startX=0, startY=0, rotX=-15, rotY=20;
  function updateRotation(){ cubeEl.style.transform = `rotateX(${rotX}deg) rotateY(${rotY}deg)`; }
  safeAddEvent(cubeEl, 'mousedown', e => { dragging = true; startX = e.clientX; startY = e.clientY; });
  safeAddEvent(window, 'mousemove', e => {
    if (!dragging) return;
    const dx = e.clientX - startX, dy = e.clientY - startY;
    startX = e.clientX; startY = e.clientY;
    rotY += dx * 0.4; rotX -= dy * 0.4; updateRotation();
  });
  safeAddEvent(window, 'mouseup', () => dragging = false);
  safeAddEvent(cubeEl, 'touchstart', e => { dragging = true; startX = e.touches[0].clientX; startY = e.touches[0].clientY; }, { passive:true });
  safeAddEvent(cubeEl, 'touchmove', e => {
    if (!dragging) return;
    const dx = e.touches[0].clientX - startX, dy = e.touches[0].clientY - startY;
    startX = e.touches[0].clientX; startY = e.touches[0].clientY;
    rotY += dx * 0.4; rotX -= dy * 0.4; updateRotation();
  }, { passive:true });
  safeAddEvent(cubeEl, 'touchend', () => dragging = false);
  updateRotation();
})();

/* -------------------------
   Shortcuts + UI niceties
   ------------------------- */
// keyboard shortcuts
safeAddEvent(document, 'keydown', function (e) {
  if (e.ctrlKey && e.altKey && e.key.toLowerCase() === "q") {
    const superPanel = $('mysteryBoxPanel');
    if (superPanel) { superPanel.style.display = "block"; alert("Super-level access form unlocked."); }
  }
  if (e.ctrlKey && e.shiftKey && e.key.toLowerCase() === 'a') {
    const f = $('adminForm'); if (f){ f.style.display='block'; alert("Admin access form unlocked."); }
  }
});

// admin mobile tap zones
onceWire($('tapTopLeft'), 'tapLeft', ()=> safeAddEvent($('tapTopLeft'), 'click', ()=>{ adminTapSequence.push('tapTopLeft'); shimmerPulse(); checkAdminMobileUnlock(); }));
onceWire($('tapTopRight'), 'tapRight', ()=> safeAddEvent($('tapTopRight'), 'click', ()=>{ adminTapSequence.push('tapTopRight'); shimmerPulse(); checkAdminMobileUnlock(); }));

// shimmer pulse helper
let shimmerTimer;
function shimmerPulse(){ const s=$('tapShimmer'); if(!s) return; s.classList.add('active'); clearTimeout(shimmerTimer); shimmerTimer=setTimeout(()=>s.classList.remove('active'),260); }

// ensure ritual controls remain wired after bfcache
safeAddEvent(window, 'pageshow', ()=>{
  const colorPanel = $('colorPanel'); if (!colorPanel) return;
  const verifyBtn = colorPanel.querySelector('.ritual-controls button:nth-child(1)');
  const clearBtn  = colorPanel.querySelector('.ritual-controls button:nth-child(2)');
  if (verifyBtn && !verifyBtn.dataset.wired) { verifyBtn.dataset.wired = '1'; verifyBtn.addEventListener('click', verifySequenceAttempt); }
  if (clearBtn && !clearBtn.dataset.wired) { clearBtn.dataset.wired = '1'; clearBtn.addEventListener('click', clearSequence); }
});

/* -------------------------
   Page-level bindings for generator and public widget
   ------------------------- */
onceWire($('love-form'), 'loveForm', ()=> safeAddEvent($('love-form'), 'click', (e)=>{ if (e.target && e.target.id === 'genNameBtn') generateNameFromTier(); }));

/* -------------------------
   Minimal boot: wire ritual controls when DOM ready
   ------------------------- */
document.addEventListener('DOMContentLoaded', ()=>{
  // Ensure admin tap zone reveals
  const adminForm = $('adminForm');
  const zoneRight = $('tapTopRight');
  if (zoneRight && adminForm) zoneRight.addEventListener('click', ()=> { adminForm.style.display = 'block'; });

  // Bind attempt puzzle if present
  if ($('attemptPuzzleBtn') && !$('attemptPuzzleBtn').dataset.initialized) {
    $('attemptPuzzleBtn').dataset.initialized = '1';
    $('attemptPuzzleBtn').addEventListener('click', ()=> { hidePanel('mysteryBoxChamber'); showPanel('puzzleBoxPanel'); initPuzzleBox(); });
  }

  // If puzzle panel present and visible on load, init
  const pb = $('puzzleBoxPanel');
  if(pb && pb.style.display !== 'none') { showPuzzleShell(); initPuzzleBox(); }
});
</script>

</body>
</html>
